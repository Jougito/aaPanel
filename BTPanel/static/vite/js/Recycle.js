import{_ as e}from"./index.js?v=1760428868419";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1760428868419";import{f as a,a as t,am as i,h as c}from"./public.js?v=1760428868419";import{_ as s}from"./index245.js?v=1760428868419";import{n,a8 as o,t as r,d as m,w as f,p as d}from"./page_layout.js?v=1760428868419";import{F as u,g as p}from"./index39.js?v=1760428868419";import{dc as y,dj as v,aC as b,dQ as _}from"./naive.js?v=1760428868419";import{k as g,P as k,i as w,r as h,W as x,c as j,a2 as R,V as C,a3 as $,S as z,a4 as D,ak as U,U as P,j as T}from"./vue.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./soft2.js?v=1760428868419";import"./soft.js?v=1760428868419";import"./site.js?v=1760428868419";import"./file2.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";const B={class:"recycle-wrapper"},F={class:"recycle-top"},q={class:"flex gap-20px"},M={class:"config-item"},O={class:"config-item"},N={class:"config-item"},G={class:"recycle-main"},K={class:"tabs"},S={class:"tab-content"},H={class:"mt-10px"},I=d(g({__name:"Recycle",setup(d,{expose:g}){const{t:I}=k(),J=w("fileStore"),Q=h(!1);g({open(){Q.value=!0,le()},close(){Q.value=!1}});const V=h("all"),W=h(!1),A=h([]),E=h([]),L=h([]),X=h(!1),Y=h(!1),Z=h([{type:"selection",width:40},{key:"name",title:()=>I("file.fileName"),render:e=>x("div",{class:"flex items-center gap-4px"},[x(u,{ext:e.ext},null),x("div",{class:"flex-1 w-0"},[x(y,null,{default:()=>[e.name]})])])},{key:"dname",title:()=>I("file.recycle.originalDirectory"),ellipsis:{tooltip:!0}},{key:"size",title:()=>I("file.size"),width:180,render:e=>n(e.size)},{title:()=>I("file.recycle.removalTime"),key:"time",width:200,render:e=>o(e.time)},a({width:200,options:e=>[{label:I("file.recycle.recover"),onClick:()=>{me(e)}},{label:I("file.recycle.deletePermanently"),onClick:()=>{fe(e)}}]})]),ee=[{key:"restore",label:I("file.recycle.batchRestore"),type:"confirm",confirm:{title:I("file.recycle.batchRestore"),desc:I("file.recycle.batchRestoreConfirm"),api:e=>r.post("/files?action=Re_Recycle_bin",{path:e.rname}),done:()=>{le(),p(J)},columns:[{key:"name",title:()=>I("file.fileName")}]}},{key:"delete",label:I("file.recycle.batchDeletePermanently"),type:"confirm",confirm:{title:I("file.recycle.batchDeletePermanently"),desc:I("file.recycle.batchDeleteConfirm"),api:e=>r.post("/files?action=Del_Recycle_bin",{path:e.rname}),done:()=>{le()},columns:[{key:"name",title:()=>I("file.fileName")}]}}];async function le(){try{A.value=[],W.value=!0;const{message:e}=await r.post("/files?action=Get_Recycle_bin");m(e)&&(L.value=f(e.dirs)?e.dirs.map(e=>({...e,type:"dir",ext:"folder"})):[],E.value=f(e.files)?e.files.map(e=>({...e,type:"file",ext:e.name.split(".").pop()||""})):[],X.value=e.status,Y.value=e.status_db)}finally{W.value=!1}}const ae=["jpg","jpeg","png","bmp","gif","tiff","ico","JPG","webp"],te=["zip","rar","gz","war","tgz"],ie=["mp4","mp3","mpeg","mpg","mov","avi","webm","mkv","mkv","mp3","rmvb","wma","wmv"],ce=["iso","xlsx","xls","doc","docx","tiff","exe","so","7z","bz","dmg","apk","pptx","ppt","xlsb","pdf"],se=j(()=>{let e=[];switch(V.value){case"all":e=[...L.value,...E.value];break;case"folder":e=[...L.value];break;case"file":e=[...E.value];break;case"image":e=E.value.filter(e=>ae.some(l=>e.name.includes(".".concat(l))));break;case"document":e=E.value.filter(e=>{const l=ae.some(l=>e.name.includes(".".concat(l))),a=te.some(l=>e.name.includes(".".concat(l))),t=ie.some(l=>e.name.includes(".".concat(l))),i=ce.some(l=>e.name.includes(".".concat(l)));return l||a||t||i});break;case"database":e=[...L.value,...E.value].filter(e=>e.name.includes("BTDB_"));break;default:e=[]}return e.sort((e,l)=>l.time-e.time),e}),ne=()=>{le()},oe=async e=>{const l={};"file"!==e&&(l[e]=1),await r.post("/files?action=Recycle_bin",l,{requestOptions:{loading:I("file.recycle.switching"),successMessage:!0}}),le()},re=()=>{i({text:I("file.recycle.emptyTitle"),title:I("file.recycle.emptyTitle"),content:I("file.recycle.emptyConfirm"),onConfirm:async()=>{await r.post("/files?action=Close_Recycle_bin","",{requestOptions:{loading:I("file.recycle.emptying"),successMessage:!0}}),le()}})},me=e=>{t({title:I("file.recycle.restoreFileTitle",{name:e.name}),content:I("file.recycle.restoreFileConfirm"),onConfirm:async()=>{await r.post("/files?action=Re_Recycle_bin",{path:e.rname},{requestOptions:{loading:I("file.recycle.restoring"),successMessage:!0}}),le(),p(J)}})},fe=e=>{i({text:I("file.delete"),title:I("file.recycle.deleteFileTitle",{name:e.name}),content:I("file.recycle.deleteFileConfirm"),onConfirm:async()=>{await r.post("/files?action=Del_Recycle_bin",{path:e.rname},{requestOptions:{loading:I("file.recycle.deleting"),successMessage:!0}}),le()}})};return(a,t)=>{const i=v,n=b,o=_,r=s,m=c,f=l,d=e;return C(),R(d,{show:P(Q),"onUpdate:show":t[7]||(t[7]=e=>U(Q)?Q.value=e:null),title:a.$t("file.recycle.title"),width:"80%"},{default:$(()=>[z("div",B,[z("div",F,[z("div",q,[z("div",M,[z("div",null,D(a.$t("file.recycle.fileRecycleBin")),1),x(i,{value:P(X),"onUpdate:value":[t[0]||(t[0]=e=>U(X)?X.value=e:null),t[1]||(t[1]=()=>oe("file"))]},null,8,["value"])]),z("div",O,[z("div",null,D(a.$t("file.recycle.databaseRecycleBin")),1),x(i,{value:P(Y),"onUpdate:value":[t[2]||(t[2]=e=>U(Y)?Y.value=e:null),t[3]||(t[3]=()=>oe("db"))]},null,8,["value"])]),z("div",N,D(a.$t("file.recycle.warning")),1)]),x(n,{onClick:re},{default:$(()=>[T(D(a.$t("file.recycle.emptyRecycleBin")),1)]),_:1})]),z("div",G,[z("div",K,[x(r,{value:P(V),"onUpdate:value":[t[4]||(t[4]=e=>U(V)?V.value=e:null),ne],panePadding:"0"},{default:$(()=>[x(o,{name:"all",tab:a.$t("file.recycle.all")},null,8,["tab"]),x(o,{name:"folder",tab:a.$t("file.recycle.folder")},null,8,["tab"]),x(o,{name:"file",tab:a.$t("file.recycle.file")},null,8,["tab"]),x(o,{name:"image",tab:a.$t("file.recycle.image")},null,8,["tab"]),x(o,{name:"document",tab:a.$t("file.recycle.document")},null,8,["tab"]),x(o,{name:"database",tab:a.$t("file.recycle.database")},null,8,["tab"])]),_:1},8,["value"])]),z("div",S,[x(m,{"checked-row-keys":P(A),"onUpdate:checkedRowKeys":t[5]||(t[5]=e=>U(A)?A.value=e:null),loading:P(W),"max-height":450,"row-key":"rname",columns:P(Z),data:P(se)},null,8,["checked-row-keys","loading","columns","data"]),z("div",H,[x(f,{"checked-row-keys":P(A),"onUpdate:checkedRowKeys":t[6]||(t[6]=e=>U(A)?A.value=e:null),"row-key":"rname","select-width":240,data:P(se),options:ee},null,8,["checked-row-keys","data"])])])])])]),_:1},8,["show","title"])}}}),[["__scopeId","data-v-2e0c3f71"]]);export{I as default};
