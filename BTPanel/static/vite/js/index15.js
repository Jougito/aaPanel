const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/form2.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang.js?v=1760428868419","js/vue.js?v=1760428868419","js/__commonjsHelpers__.js?v=1760428868419","js/naive.js?v=1760428868419","js/common.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang20.js?v=1760428868419","js/page_layout.js?v=1760428868419","js/public.js?v=1760428868419","css/public.css?v=1760428868419","css/page_layout.css?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang11.js?v=1760428868419","js/alarm.js?v=1760428868419","js/index211.js?v=1760428868419","css/index39.css?v=1760428868419"])))=>i.map(i=>d[i]);
import{_ as e}from"./index108.js?v=1760428868419";import{w as t,i as a,p as n,a8 as i,bf as l,h as s,d as o,a as r,o as d,x as m}from"./page_layout.js?v=1760428868419";import{_ as c}from"./index.js?v=1760428868419";import{_ as u}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419";import{c as p,f as _,a as g,h as f,u as x,e as C,o as h}from"./public.js?v=1760428868419";import{c as w,d as A,e as k,f as b,h as y,b as v,s as j,o as L,i as P}from"./alarm.js?v=1760428868419";import{r as z,k as W,t as E,P as M,c as R,W as T,R as U,V as $,S as H,a2 as B,a4 as S,U as V,e as D,N as I,a3 as O,j as F,F as N,b as q,_ as G,H as J,n as K,o as Q,ak as X}from"./vue.js?v=1760428868419";import{_ as Y}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";import{dg as Z,d8 as ee,aC as te,dS as ae}from"./naive.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419";const ne=z([]),ie=new Map([["mail",a.global.t("Config.Alarm.index_3")],["feishu",a.global.t("Config.Alarm.index_4")],["dingding",a.global.t("Config.Alarm.index_5")],["weixin",a.global.t("Config.Alarm.index_6")],["tg","Telegram"]]);function le(e){const t=ne.value.find(t=>t.id===e);return t?"".concat(t.data.title," (").concat(ie.get(t.sender_type),")"):""}const se={class:"p-20px"},oe={class:"alarm-info"},re={class:"alarm-title"},de={key:1,class:"alarm-box"},me={class:"alarm-info"},ce={class:"alarm-title"},ue=["innerHTML"],pe=n(W({__name:"record-details",props:{row:{}},setup(e){const t=E(e,"row"),{t:a}=M(),n=R(()=>Object.entries(t.value.result.send_data).map(e=>{const t=le(e[0]);return{result:1===e[1],resultMsg:1===e[1]?a("Config.Alarm.index_108"):e[1],account:t}})),i=z([{key:"account",title:a("Config.Alarm.index_106"),render:e=>e.account||"--"},{key:"resultMsg",title:a("Config.Alarm.index_107"),render:e=>T("span",{class:e.result?"text-primary":"text-error"},[e.resultMsg])}]);return(e,a)=>{const l=Z;return $(),U("div",se,[H("div",oe,[H("div",re,S(e.$t("Config.Alarm.index_104")),1),V(n).length>0?($(),B(l,{key:0,data:V(n),columns:V(i)},null,8,["data","columns"])):($(),U("div",de,S(V(t).result.stop_msg),1))]),H("div",me,[H("div",ce,S(e.$t("Config.Alarm.index_105")),1),H("div",{class:"alarm-box",innerHTML:e.row.send_data.msg_list.join("<br />")},null,8,ue)])])}}}),[["__scopeId","data-v-6fb141e0"]]),_e={class:"p-20px"},ge=W({__name:"record",props:{row:{}},setup(e){const a=E(e,"row"),{t:n}=M(),r=()=>{g({title:n("Config.Alarm.index_95",[a.value.title]),content:n("Config.Alarm.index_96",[a.value.title]),onConfirm:async()=>{await b({task_id:a.value.id,record_ids:[]}),y()}})},{table:d,columns:m,setLoading:c}=p([{key:"create_time",title:n("Config.Alarm.index_97"),render:e=>i(e.create_time)},{key:"do_send",title:n("Config.Alarm.index_98"),render:e=>{let t=e.result.stop_msg;if(e.do_send){const a=Object.values(e.result.send_data).reduce((e,t)=>(l(t)&&1===t?e.success++:s(t)&&e.fail++,e),{success:0,fail:0});t=n("Config.Alarm.index_99",[a.success,a.fail])}return T(ee,null,{trigger:()=>T("span",{class:e.do_send?"text-primary":"text-error"},[e.do_send?n("Config.Alarm.index_110"):n("Config.Alarm.index_100")]),default:()=>T(N,null,[t])})}},{key:"details",title:n("Config.Alarm.index_101"),render:e=>T("a",{class:"bt-link",href:"javascript:;",onClick:()=>{C(e)}},[n("Config.Alarm.index_109")])},_({width:100,options:e=>[{label:n("Public.Btn.Del"),onClick:()=>{h(e)}}]})]),C=e=>{x({title:n("Config.Alarm.index_101"),width:480,data:{row:e},component:pe})},h=e=>{g({title:n("Config.Alarm.index_102"),content:n("Config.Alarm.index_103"),onConfirm:async()=>{await A({task_id:a.value.id,record_ids:[e.id]}),y()}})},w=D({task_id:a.value.id,page:1,size:10}),y=async()=>{try{c(!0);const{message:e}=await k(I(w));o(e)&&(d.data=t(e.list)?e.list:[],d.total=e.count)}finally{c(!1)}};return y(),(e,t)=>{const a=te,n=f,i=Y,l=u;return $(),U("div",_e,[T(l,null,{toolsLeft:O(()=>[T(a,{onClick:r},{default:O(()=>[F(S(e.$t("Config.Alarm.index_94")),1)]),_:1})]),table:O(()=>[T(n,{"max-height":382,loading:V(d).loading,data:V(d).data,columns:V(m)},null,8,["loading","data","columns"])]),pageRight:O(()=>[T(i,{page:V(w).page,"onUpdate:page":t[0]||(t[0]=e=>V(w).page=e),"page-size":V(w).size,"onUpdate:pageSize":t[1]||(t[1]=e=>V(w).size=e),"item-count":V(d).total,onRefresh:y},null,8,["page","page-size","item-count"])]),_:1})])}}}),fe=W({__name:"index",setup(e,{expose:a}){const n=G(()=>r(()=>import("./form2.js?v=1760428868419"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),{t:l}=M(),s=C("",{isEdit:!1,onRefresh:()=>{P()}}),o=()=>{s.data.isEdit=!1,s.title=l("Config.Alarm.index_1"),s.show=!0},{table:d,columns:m,setLoading:A}=p([{key:"title",title:l("Config.Alarm.index_7"),minWidth:140,ellipsis:{tooltip:!0}},h({minWidth:100,status:e=>({checkedValue:!0,checkedLabel:l("Config.Alarm.index_8"),uncheckedValue:!1,uncheckedLabel:l("Config.Alarm.index_9"),onClick:t=>{b(t,e)}})}),{key:"sender",title:l("Config.Alarm.index_92"),width:"14%",minWidth:140,ellipsis:{tooltip:!0},render:e=>{const{sender:t}=e,a=[];return t.forEach(e=>{const t=le(e);t&&a.push(t)}),a.join(l("Public.Punctuation.Comma"))}},{key:"view_msg",title:l("Config.Alarm.index_10"),width:"34%",minWidth:180,ellipsis:{tooltip:!0},render:e=>T("span",{innerHTML:e.view_msg},null)},{key:"last_check",title:l("Config.Alarm.index_11"),width:"14%",minWidth:140,render:e=>e.last_check?i(e.last_check):"--"},_({width:"12%",minWidth:150,options:e=>[{label:l("Config.Alarm.index_12"),onClick:()=>{k(e)}},{label:l("Public.Btn.Edit"),onClick:()=>{(e=>{s.data.row=e,s.data.isEdit=!0,s.title=l("Config.Alarm.index_2"),s.show=!0})(e)}},{label:l("Public.Btn.Del"),onClick:()=>{L(e)}}]})]),k=e=>{x({title:l("Config.Alarm.index_93",[e.title]),width:800,data:{row:e},component:ge})},b=(e,t)=>{const a=l(e?"Config.Alarm.index_18":"Config.Alarm.index_13");g({title:l("Config.Alarm.index_14",[a,t.title]),content:l("Config.Alarm.index_15",[a.toLocaleLowerCase(),t.title]),onConfirm:async()=>{await j({task_id:t.id,status:e?1:0}),t.status=e}})},L=e=>{g({title:l("Config.Alarm.index_16"),content:l("Config.Alarm.index_17"),onConfirm:async()=>{await y({task_id:e.id}),P()}})},P=async(e=!1)=>{try{A(!0),e&&await async function(){const{message:e}=await w({refresh:0});ne.value=t(e)?e:[]}();const{message:a}=await v();d.data=t(a)?a:[]}finally{A(!1)}};return P(!0),q(()=>{ne.value=[]}),a({init:P}),(e,t)=>{const a=te,i=f,l=u,r=c;return $(),U("div",null,[T(l,null,{toolsLeft:O(()=>[T(a,{type:"primary",onClick:o},{default:O(()=>[F(S(e.$t("Config.Alarm.index_91")),1)]),_:1})]),table:O(()=>[T(i,{loading:V(d).loading,data:V(d).data,columns:V(m)},null,8,["loading","data","columns"])]),_:1}),T(r,{show:V(s).show,"onUpdate:show":t[0]||(t[0]=e=>V(s).show=e),title:V(s).title,data:V(s).data,width:860,"min-height":340,footer:!0,component:V(n)},null,8,["show","title","data","component"])])}}}),xe={class:"flex items-center"},Ce={class:"flex-1 leading-[1.5]"},he={class:"flex"},we=["href"],Ae=n(W({__name:"table-module",props:{row:{}},emits:["click"],setup(e,{emit:t}){const a=t,n=()=>{a("click")};return(e,t)=>($(),U("div",xe,[H("div",{class:J(["icon",e.row.name])},null,2),H("div",Ce,[H("span",{class:"text-14px font-bold cursor-pointer",onClick:n},S(e.row.title),1),H("div",he,[H("span",null,S(e.row.ps),1),H("a",{class:"bt-link",href:e.row.help,target:"_blank"},">>"+S(e.$t("Config.Alarm.index_42")),9,we)])])]))}}),[["__scopeId","data-v-e621c47b"]]),ke=W({__name:"table-config",props:{row:{}},emits:["click"],setup(e,{emit:t}){const a=t,n=E(e,"row"),{t:i}=M(),l=R(()=>n.value.list.map(e=>e.data.title).join(i("Public.Punctuation.Comma"))),s=()=>{a("click")};return(e,t)=>{const a=d;return $(),U("div",null,[V(n).list.length<=0?($(),B(a,{key:0,type:"error",onClick:s},{default:O(()=>[F(S(e.$t("Config.Alarm.index_40")),1)]),_:1})):($(),U("span",{key:1,class:"cursor-pointer",onClick:s},S(e.$t("Config.Alarm.index_41",[V(l)])),1))])}}}),be=W({__name:"index",setup(e,{expose:a}){const{t:n}=M(),{table:i,columns:l,setLoading:s}=p([{key:"module",title:n("Config.Alarm.index_34"),width:"42%",minWidth:400,render:e=>T(Ae,{row:e,onClick:()=>{o(e)}},null)},{key:"config",title:n("Config.Alarm.index_35"),minWidth:320,render:e=>T(ke,{row:e,onClick:()=>{o(e)}},null)},_({width:100,options:e=>[{label:n("Public.Btn.Conf"),onClick:()=>{o(e)}}]})]),o=e=>{L({row:e,onRefresh:d})},r=[{name:"mail",title:n("Config.Alarm.index_3"),ps:n("Config.Alarm.index_36"),help:"https://www.bt.cn/bbs/thread-66183-1-1.html"},{name:"dingding",title:n("Config.Alarm.index_5"),ps:n("Config.Alarm.index_37"),help:"https://www.bt.cn/bbs/thread-108081-1-1.html"},{name:"weixin",title:n("Config.Alarm.index_6"),ps:n("Config.Alarm.index_38"),help:"https://www.bt.cn/bbs/thread-108116-1-1.html"},{name:"feishu",title:n("Config.Alarm.index_4"),ps:n("Config.Alarm.index_39"),help:"https://www.aapanel.com/forum/d/16942-aapanel-how-does-set-lark-or-feishu-notification"},{name:"tg",title:"Telegram",ps:"Use Telegram to send and receive panel notifications",help:"https://www.aapanel.com/forum/d/5115-how-to-add-telegram-to-panel-notifications"}],d=async()=>{try{s(!0);const{message:e}=await w({refresh:1});t(e)&&i.data.forEach(t=>{t.list=e.filter(e=>e.sender_type===t.name)})}finally{s(!1)}};return i.data=r.map(e=>({...e,list:[]})),K(()=>{d()}),a({init:d}),(e,t)=>{const a=f;return $(),U("div",null,[T(a,{loading:V(i).loading,data:V(i).data,columns:V(l)},null,8,["loading","data","columns"])])}}}),ye=W({__name:"index",setup(e,{expose:a}){const{t:n}=M(),{table:i,columns:l,setLoading:s}=p([{key:"log",title:n("Config.Alarm.index_7"),ellipsis:{tooltip:!0},render:e=>T("span",{innerHTML:e.log},null)},{key:"addtime",title:n("Config.Alarm.index_87"),width:150}]),r=D({p:1,limit:20}),d=async()=>{try{s(!0);const{message:e}=await P(I(r));o(e)&&(i.data=t(e.data)?e.data:[],i.total=m(e.page))}finally{s(!1)}};return Q(()=>{d()}),a({init:d}),(e,t)=>{const a=f,n=Y,s=u;return $(),U("div",null,[T(s,null,{table:O(()=>[T(a,{loading:V(i).loading,data:V(i).data,columns:V(l)},null,8,["loading","data","columns"])]),pageRight:O(()=>[T(n,{page:V(r).p,"onUpdate:page":t[0]||(t[0]=e=>V(r).p=e),"page-size":V(r).limit,"onUpdate:pageSize":t[1]||(t[1]=e=>V(r).limit=e),"item-count":V(i).total,"store-key":"alarm-logs",onRefresh:d},null,8,["page","page-size","item-count"])]),_:1})])}}}),ve=W({__name:"index",setup(t){const{t:a}=M(),n=z("list"),i=[{key:"list",label:a("Config.Alarm.index_88"),component:fe},{key:"settings",label:a("Config.Alarm.index_89"),component:be},{key:"logs",label:a("Config.Alarm.index_90"),component:ye}];return(t,a)=>{const l=e,s=ae;return $(),B(s,{class:"p-16px"},{default:O(()=>[T(l,{value:V(n),"onUpdate:value":a[0]||(a[0]=e=>X(n)?n.value=e:null),options:i},null,8,["value"])]),_:1})}}});export{ve as default};
