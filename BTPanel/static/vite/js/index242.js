const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index213.js?v=1760428868419","js/index.js?v=1760428868419","js/vue.js?v=1760428868419","js/__commonjsHelpers__.js?v=1760428868419","js/common.js?v=1760428868419","js/public.js?v=1760428868419","js/page_layout.js?v=1760428868419","js/naive.js?v=1760428868419","css/page_layout.css?v=1760428868419","css/public.css?v=1760428868419","css/index109.css?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang8.js?v=1760428868419","css/index92.css?v=1760428868419","js/index214.js?v=1760428868419","js/index245.js?v=1760428868419","css/index59.css?v=1760428868419","css/index93.css?v=1760428868419","js/domain-verification.js?v=1760428868419"])))=>i.map(i=>d[i]);
import{_ as e}from"./index108.js?v=1760428868419";import{ds as t,ct as a,o as s,S as n,m as i,d as l,p as d,_ as o,u as r,a as u,aV as c,w as _}from"./page_layout.js?v=1760428868419";import{c as p,s as m,a as S,g as f,b as h}from"./ssl.js?v=1760428868419";import{C as v}from"./cert.js?v=1760428868419";import{u as x}from"./index85.js?v=1760428868419";import{_ as y,a as w,ac as C,ad as L,ae as g,u as b,e as k,c as $,f as j,a0 as P,a1 as E,a2 as B,h as R,n as D,d as N,af as O,ag as U,ah as A,ai as I,aj as T,j as M,q as z,a5 as F}from"./public.js?v=1760428868419";import{_ as J}from"./index99.js?v=1760428868419";import{a as H}from"./ssl-lets-progress.js?v=1760428868419";import{dk as V,e2 as q,dc as G,dj as W,da as X,aC as K,dR as Q,dT as Y,dU as Z,_ as ee,eg as te,G as ae,d5 as se}from"./naive.js?v=1760428868419";import{k as ne,P as ie,r as le,c as de,y as oe,a2 as re,V as ue,a3 as ce,an as _e,W as pe,U as me,S as Se,a4 as fe,j as he,R as ve,ak as xe,F as ye,O as we,H as Ce,a0 as Le,e as ge,_ as be,am as ke,w as $e,o as je,l as Pe,v as Ee,m as Be,x as Re}from"./vue.js?v=1760428868419";import{_ as De}from"./index133.js?v=1760428868419";import{_ as Ne}from"./index.js?v=1760428868419";import{_ as Oe}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419";import{u as Ue}from"./utils3.js?v=1760428868419";import{A as Ae}from"./index218.js?v=1760428868419";import{_ as Ie}from"./index.vue_vue_type_script_setup_true_lang.js?v=1760428868419";import{a3 as Te}from"./site.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1760428868419";import"./site4.js?v=1760428868419";import"./index245.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1760428868419";import"./index98.js?v=1760428868419";import"./index100.js?v=1760428868419";import"./index101.js?v=1760428868419";import"./file.js?v=1760428868419";import"./theme-monokai.js?v=1760428868419";import"./index105.js?v=1760428868419";import"./soft.js?v=1760428868419";import"./useOperate.js?v=1760428868419";import"./useModal2.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419";import"./paypal-js.js?v=1760428868419";const Me={class:"cert-info"},ze={class:"cert-label"},Fe={class:"cert-value"},Je={class:"cert-info"},He={class:"cert-label"},Ve={class:"cert-value"},qe={class:"cert-info"},Ge={class:"cert-label"},We={class:"cert-value"},Xe={class:"cert-info"},Ke={class:"cert-label"},Qe={class:"cert-value"},Ye={key:0,class:"text-primary"},Ze={key:1,class:"text-error"},et={class:"cert-info"},tt={class:"cert-label"},at={class:"cert-value"},st={class:"w-48%"},nt={class:"mb-8px"},it={class:"w-48%"},lt={class:"mb-8px"},dt=d(ne({__name:"index",props:{info:{default:null},isRenew:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["refresh"],setup(e,{expose:d,emit:o}){const r=e,u=o,{t:c}=ie(),{data:_}=x(),f=t(),h=le(-1),k=le(!1),$=le(!1),j=le(""),P=le("");let E="";const B=le("");let R="";const D=le({issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),N=de(()=>h.value===v.LetsEncryptDeploy?c("Site.Cert.index_65"):h.value===v.BusinessDeploy?c("Site.Cert.index_64"):h.value===v.TestDeploy?c("Site.Cert.index_38"):c("Site.Cert.index_37")),O=de(()=>!!B.value),U=de(()=>r.isRenew||h.value===v.LetsEncryptDeploy),A=de(()=>!1),I=de(()=>k.value),T=async e=>{e?(await m({siteName:_.name}),u("refresh")):w({title:c("Site.Cert.index_12"),content:c("Site.Cert.index_13"),onConfirm:async()=>{await p({siteName:_.name}),u("refresh")},onPublicClose:()=>{$.value=!0}})},M=()=>{""!==P.value.trim()&&""!==B.value.trim()?P.value!==E&&E||B.value!==R&&R?w({title:c("Site.Cert.index_10"),content:c("Site.Cert.index_11"),onConfirm:async()=>{await z()}}):z():i.error(c("Site.Cert.index_9"))},z=async()=>{const{message:e}=await C({key:P.value,cert:B.value});l(e)&&e.hash&&(await L({hash:e.hash,domains:JSON.stringify([_.name]),append:1}),i.success(c("SSL.index_32"))),Y()},F=async()=>{var e;const{message:t}=await g({hash:(null==(e=r.info)?void 0:e.hash)||""});l(t)&&b({hideClose:!0,data:{isJump:!1,task_id:t.task_id,onFinish:()=>{u("refresh")}},component:H})},Q=async()=>{await S({updateOf:1,siteName:_.name}),Y()},Y=()=>{u("refresh"),f.setRefresh(!0)};return oe(()=>{const{info:e}=r;e&&(h.value=e.type,k.value=e.status,$.value=e.httpTohttps,P.value=e.key||"",E=e.key||"",B.value=e.csr||"",R=e.csr||"",D.value=e.cert_data,j.value=e.index)}),d({init:u("refresh")}),(e,t)=>{const i=s,l=q,d=G,o=W,r=a,u=V,c=J,_=X,p=K,m=y,S=n;return ue(),re(S,{show:e.loading},{default:ce(()=>[me(O)?(ue(),re(u,{key:0,class:"mb-16px",type:"success","show-icon":!1},{default:ce(()=>[pe(r,{"x-gap":12,cols:"15"},{default:ce(()=>[pe(l,{span:"8"},{default:ce(()=>[Se("div",Me,[Se("div",ze,fe(e.$t("Site.Cert.index_44"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",Fe,[pe(i,null,{default:ce(()=>[he(fe(me(N)),1)]),_:1})])])]),_:1}),pe(l,{span:"7"},{default:ce(()=>[Se("div",Je,[Se("div",He,fe(e.$t("Site.Cert.index_45"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",Ve,[pe(d,null,{default:ce(()=>[he(fe(me(D).issuer||"other"),1)]),_:1})])])]),_:1}),pe(l,{span:"8"},{default:ce(()=>[Se("div",qe,[Se("div",Ge,fe(e.$t("Site.Cert.index_46"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",We,[pe(d,null,{default:ce(()=>[he(fe(me(D).dns.join(e.$t("Public.Punctuation.Comma"))),1)]),_:1})])])]),_:1}),pe(l,{span:"7"},{default:ce(()=>[Se("div",Xe,[Se("div",Ke,fe(e.$t("Site.Cert.index_47"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",Qe,[me(D).endtime>0?(ue(),ve("span",Ye,fe(e.$t("Site.Cert.index_48",{date:me(D).notAfter,days:me(D).endtime})),1)):(ue(),ve("span",Ze,fe(e.$t("Site.Cert.index_47")),1))])])]),_:1}),pe(l,{span:"8"},{default:ce(()=>[Se("div",et,[Se("div",tt,fe(e.$t("Site.Cert.index_49"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",at,[pe(o,{value:me($),"onUpdate:value":[t[0]||(t[0]=e=>xe($)?$.value=e:null),T],size:"small"},null,8,["value"])])])]),_:1})]),_:1})]),_:1})):_e("",!0),pe(_,{class:"mb-16px",size:10,justify:"space-between"},{default:ce(()=>[Se("div",st,[Se("div",nt,fe(e.$t("Site.Cert.index_50")),1),pe(c,{value:me(P),"onUpdate:value":t[1]||(t[1]=e=>xe(P)?P.value=e:null),rows:10},null,8,["value"])]),Se("div",it,[Se("div",lt,fe(e.$t("Site.Cert.index_51")),1),pe(c,{value:me(B),"onUpdate:value":t[2]||(t[2]=e=>xe(B)?B.value=e:null),rows:10},null,8,["value"])])]),_:1}),pe(_,{class:"mb-12px"},{default:ce(()=>[pe(p,{type:"primary",onClick:M},{default:ce(()=>[he(fe(me(k)?e.$t("Public.Btn.Save"):e.$t("Site.Cert.index_52")),1)]),_:1}),me(U)?(ue(),re(p,{key:0,type:"primary",onClick:F},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_53")),1)]),_:1})):_e("",!0),me(A)?(ue(),re(p,{key:1},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_54")),1)]),_:1})):_e("",!0),me(I)?(ue(),re(p,{key:2,onClick:Q},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_55")),1)]),_:1})):_e("",!0)]),_:1}),pe(m,null,{default:ce(()=>[Se("li",null,fe(e.$t("Site.Cert.index_33")),1),Se("li",null,fe(e.$t("Site.Cert.index_34")),1),Se("li",null,fe(e.$t("Site.Cert.index_35")),1),Se("li",null,fe(e.$t("Site.Cert.index_36")),1)]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-d003ad66"]]),ot={class:"business-top-tips flex flex-wrap border-#d6e9c6 border-1px rounded-5px p-12px"},rt={class:"text-#3c763d w-100%"},ut=d(ne({__name:"top-tips",setup(e){const{t:t}=ie(),a=[t("SSL.SiteSSL.index_5"),t("SSL.SiteSSL.index_6"),t("SSL.SiteSSL.index_7"),t("SSL.SiteSSL.index_8"),t("SSL.SiteSSL.index_9"),t("SSL.SiteSSL.index_10"),t("SSL.SiteSSL.index_11")];return(e,t)=>{const s=o,n=X;return ue(),ve("div",ot,[(ue(),ve(ye,null,we(a,(e,t)=>pe(n,{size:5,key:e,class:Ce(["flex-nowrap! leading-20px",{"w-33%":t!==a.length-1}])},{default:ce(()=>[pe(s,{name:"base-tick",size:16,color:"#ff8d00"}),Se("span",rt,fe(e),1)]),_:2},1032,["class"])),64))])}}}),[["__scopeId","data-v-da25cdef"]]),ct={class:"my-10px"},_t=ne({__name:"table",setup(e){const a=be(()=>u(()=>import("./index213.js?v=1760428868419"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),s=be(()=>u(()=>import("./index214.js?v=1760428868419"),__vite__mapDeps([14,15,2,3,7,4,6,5,9,8,16,17]))),n=be(()=>u(()=>import("./domain-verification.js?v=1760428868419"),__vite__mapDeps([18,6,2,3,7,4,5,9,8,11]))),i=r(),{userInfo:d}=Le(i),o=t(),{t:c}=ie(),_=ge({p:1,limit:9999}),p=k(c("SSL.Business.index_41"),{onRefresh:(e,t)=>{f.data.request=!0,f.data.uc_id=t,f.data.verify=e,f.show=!0,y()}}),m=k(c("SSL.index_44")),S=k(c("SSL.index_49"),{onRefresh:()=>{y(),o.setRefresh(!0)}}),f=k(c("SSL.Business.index_42"),{onRefresh:()=>{y()}}),{table:h,columns:v}=$([{key:"verify_domains",title:c("Layout.Sider.mail_3"),render:e=>pe("span",{innerHTML:e.verify_domains&&e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},{key:"title",title:c("Site.Cert.index_44"),render:e=>e.order_info.title,ellipsis:{tooltip:!0}},Ue({title:c("SSL.index_54")}),{key:"order_status",title:c("SSL.Business.index_43"),render:e=>{const t=e.order_info;return t.certId||t.domains.length?!t.certId&&t.domains.length?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_45"),he(" ")]):"PENDING"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_46"),he(" ")]):"COMPLETE"===t.order_status&&1===t.status?pe("span",{class:"color-#20a53a"},[he(" "),c("SSL.Business.index_47"),he(" ")]):"CANCELLED"===t.order_status&&1===t.status||-1===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_48"),he(" ")]):"FAILED"===t.order_status&&1===t.status?pe("span",{class:"color-error"},[he(" "),c("SSL.Business.index_49"),he(" ")]):"EXPIRED"===t.order_status&&1===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_50"),he(" ")]):1!==t.status||["PENDING","COMPLETE","CANCELLED","FAILED","EXPIRED"].includes(t.order_status)?0===t.status?pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_52"),he(" ")]):void 0:pe("span",{class:"color-warning"},[he(" "),c("SSL.Business.index_51"),he(" ")]):pe("span",{class:"color-warning cursor-pointer",onClick:()=>x(e)},[" ",c("SSL.Business.index_44")," "])}},j({width:140,options:e=>[{show:!e.order_info.certId&&!e.order_info.domains.length,label:c("SSL.Business.index_53"),onClick:()=>{x(e)}},{show:"PENDING"===e.order_info.order_status&&1===e.order_info.status,label:c("SSL.Business.index_54"),onClick:async()=>{const{message:t}=await P({uc_id:e.order_info.uc_id});l(t)&&(f.data.uc_id=e.order_info.uc_id,f.data.verify=t.data,f.data.paths=t.paths,f.show=!0)}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:c("SSL.index_58"),onClick:async()=>{S.data.row=e,S.show=!0}},{show:"COMPLETE"===e.order_info.order_status&&1===e.order_info.status,label:c("Ftp.Label.index_11"),onClick:async()=>{const t=window.location.origin+"/v2/business_ssl?action=download_cert&uc_id="+e.order_info.uc_id;window.open(t)}},{show:!1,label:c("Public.Btn.Del"),onClick:()=>{w({title:c("SSL.index_59"),content:c("SSL.index_60"),onConfirm:async()=>{await E({hash:e.hash}),y()}})}}]})]),x=e=>{p.data.row=e,p.show=!0},y=async()=>{try{h.loading=!0;const{message:e}=await B(_);l(e)&&(h.data=e.data,h.total=e.total)}finally{h.loading=!1}};return d.value.status&&y(),(e,t)=>{const i=K,l=R,o=Oe,r=Ne,u=De;return ue(),ve("div",ct,[pe(u,{install:me(d).status},{desc:ce(()=>[t[5]||(t[5]=Se("span",{class:"mr-10px"},"Business certificates require login panel to start using them",-1)),pe(i,{type:"primary",onClick:me(D)},{default:ce(()=>[he(fe(e.$t("Login.index_3")),1)]),_:1},8,["onClick"])]),default:ce(()=>[pe(o,null,{toolsLeft:ce(()=>[pe(i,{type:"primary",onClick:t[0]||(t[0]=e=>me(m).show=!0)},{default:ce(()=>[he(fe(me(c)("SSL.index_44")),1)]),_:1})]),table:ce(()=>[pe(l,{loading:me(h).loading,data:me(h).data,columns:me(v),"max-height":220},null,8,["loading","data","columns"])]),_:1}),pe(r,{show:me(m).show,"onUpdate:show":t[1]||(t[1]=e=>me(m).show=e),title:me(m).title,data:me(m).data,"min-height":250,component:Ae},null,8,["show","title","data"]),pe(r,{show:me(p).show,"onUpdate:show":t[2]||(t[2]=e=>me(p).show=e),title:me(p).title,data:me(p).data,width:650,"min-height":450,component:me(a)},null,8,["show","title","data","component"]),pe(r,{show:me(S).show,"onUpdate:show":t[3]||(t[3]=e=>me(S).show=e),title:me(S).title,data:me(S).data,width:720,height:530,component:me(s)},null,8,["show","title","data","component"]),pe(r,{show:me(f).show,"onUpdate:show":t[4]||(t[4]=e=>me(f).show=e),title:me(f).title,data:me(f).data,width:650,"min-height":450,component:me(n)},null,8,["show","title","data","component"])]),_:1},8,["install"])])}}}),pt={class:"text-error"};const mt=d({},[["render",function(e,t){const a=s,n=y;return ue(),re(n,null,{default:ce(()=>[Se("li",pt,fe(e.$t("SSL.SiteSSL.index_1")),1),Se("li",null,fe(e.$t("SSL.SiteSSL.index_2")),1),Se("li",null,fe(e.$t("SSL.SiteSSL.index_3")),1),Se("li",null,[he(fe(e.$t("SSL.SiteSSL.index_4"))+" ",1),pe(a,{href:"https://www.aapanel.com/docs/Function/BusinessCertificate.html",target:"_blank"},{default:ce(()=>[he(fe(e.$t("SSL.Business.index_20")),1)]),_:1})])]),_:1})}]]),St=ne({__name:"index",setup:e=>(e,t)=>(ue(),ve("div",null,[pe(ut),pe(_t),pe(mt)]))}),ft={class:"cert-info"},ht={class:"cert-label"},vt={class:"cert-value"},xt={class:"cert-info"},yt={class:"cert-label"},wt={class:"cert-value"},Ct={class:"cert-info"},Lt={class:"cert-label"},gt={class:"cert-value"},bt={class:"cert-info"},kt={class:"cert-label"},$t={class:"cert-value"},jt={key:0,class:"text-primary"},Pt={key:1,class:"text-error"},Et={class:"w-48%"},Bt={class:"mb-8px"},Rt={class:"w-48%"},Dt={class:"mb-8px"},Nt=d(ne({__name:"cert",emits:["update"],setup(e,{emit:s}){const i=s,{t:d}=ie(),{data:o}=x(),r=t(),u=le(!1),c=le(1),_=le(""),p=le(""),m=ge({hash:"",issuer:"",notAfter:"",notBefore:"",dns:[],subject:"",endtime:0}),h=async()=>{const{message:e}=await g({hash:m.hash});l(e)&&b({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{L()}},component:H})},v=async()=>{await S({updateOf:1,siteName:o.name}),i("update"),r.setRefresh(!0)},{loading:w,setLoading:C}=N(),L=async()=>{try{C(!0);const{message:e}=await f({siteName:o.name});l(e)&&(u.value=e.status,m.hash=e.hash,m.issuer=e.cert_data.issuer,m.notAfter=e.cert_data.notAfter,m.notBefore=e.cert_data.notBefore,m.dns=e.cert_data.dns,m.subject=e.cert_data.subject,m.endtime=e.cert_data.endtime,_.value=e.key,p.value=e.csr,c.value=e.auto_renew)}finally{C(!1)}};return L(),(e,t)=>{const s=q,i=G,l=a,d=V,o=J,r=X,u=K,S=y,f=n;return ue(),re(f,{show:me(w)},{default:ce(()=>[pe(d,{class:"mb-16px",type:"success","show-icon":!1},{default:ce(()=>[pe(l,{"x-gap":12,cols:"15"},{default:ce(()=>[me(c)?(ue(),re(s,{key:0,span:"16"},{default:ce(()=>[Se("div",ft,[Se("div",ht,fe(e.$t("SSL.SiteSSL.index_22"))+"：",1),Se("div",vt,fe(e.$t("SSL.SiteSSL.index_23")),1)])]),_:1})):_e("",!0),pe(s,{span:"7"},{default:ce(()=>[Se("div",xt,[Se("div",yt,fe(e.$t("Site.Cert.index_45"))+"：",1),Se("div",wt,[pe(i,null,{default:ce(()=>[he(fe(me(m).issuer),1)]),_:1})])])]),_:1}),pe(s,{span:"8"},{default:ce(()=>[Se("div",Ct,[Se("div",Lt,fe(e.$t("Site.Cert.index_46"))+"：",1),Se("div",gt,[pe(i,null,{default:ce(()=>[he(fe(me(m).dns.join(e.$t("Public.Punctuation.Comma"))),1)]),_:1})])])]),_:1}),pe(s,{span:"7"},{default:ce(()=>[Se("div",bt,[Se("div",kt,fe(e.$t("Site.Cert.index_47"))+fe(e.$t("Public.Punctuation.Colon")),1),Se("div",$t,[me(m).endtime>0?(ue(),ve("span",jt,fe(e.$t("Site.Cert.index_48",{date:me(m).notAfter,days:me(m).endtime})),1)):(ue(),ve("span",Pt,fe(e.$t("Site.Cert.index_47")),1))])])]),_:1})]),_:1})]),_:1}),pe(r,{class:"mb-16px",size:10,justify:"space-between"},{default:ce(()=>[Se("div",Et,[Se("div",Bt,fe(e.$t("Site.Cert.index_50")),1),pe(o,{readonly:"",value:me(_),"onUpdate:value":t[0]||(t[0]=e=>xe(_)?_.value=e:null),rows:14},null,8,["value"])]),Se("div",Rt,[Se("div",Dt,fe(e.$t("Site.Cert.index_51")),1),pe(o,{readonly:"",value:me(p),"onUpdate:value":t[1]||(t[1]=e=>xe(p)?p.value=e:null),rows:14},null,8,["value"])])]),_:1}),pe(r,{class:"mb-12px"},{default:ce(()=>[pe(u,{type:"primary",onClick:h},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_53")),1)]),_:1}),pe(u,{onClick:v},{default:ce(()=>[he(fe(e.$t("Site.Cert.index_55")),1)]),_:1})]),_:1}),pe(S,null,{default:ce(()=>[Se("li",null,fe(e.$t("SSL.SiteSSL.index_24")),1),Se("li",null,fe(e.$t("SSL.SiteSSL.index_25")),1)]),_:1})]),_:1},8,["show"])}}}),[["__scopeId","data-v-bc2b39ec"]]),Ot={class:"flex items-center"},Ut={class:"leading-17px"},At={class:"w-full"},It={class:"w-full"},Tt={class:"text-error"},Mt=ne({__name:"apply",emits:["update"],setup(e,{emit:a}){const s=ke(),{t:d}=ie(),{data:r}=x(),u=t(),p=a,m=ge({auth_type:"http",dns_manual:0,auto_wildcard:0,domains:[],all:!1}),S={domains:{required:!0,trigger:"change",type:"array",message:d("SSL.SiteSSL.index_16")}},f=le(null),h=le([]),v=e=>{var t;return null==(t=h.value.find(t=>t.name===e))?void 0:t.auto},w=()=>{s.push("/ssl_domain/domain")},C=de(()=>m.domains.length>0&&m.domains.length<h.value.length);$e(()=>m.domains,e=>{e.length===h.value.length?m.all=!0:e.length||(m.all=!1)}),$e(()=>m.all,e=>{var t;e?(m.domains=h.value.map(e=>e.name),null==(t=f.value)||t.validate()):m.domains=[]}),$e(()=>m.auth_type,e=>{var t;"dns"===e?(m.domains=h.value.filter(e=>e.auto).map(e=>e.name),null==(t=f.value)||t.validate()):m.domains=[]});const L=de(()=>m.domains.filter(e=>!v(e))),g=async()=>{var e;if(await(null==(e=f.value)?void 0:e.validate()),"dns"===m.auth_type&&L.value.length&&!m.dns_manual)return void i.error({content:()=>Be("span",{innerHTML:"".concat(L.value.join("<br/>")).concat(d("SSL.SiteSSL.index_14"))})});let t={auth_type:m.dns_manual?"dns_manual":m.auth_type,auto_wildcard:m.auto_wildcard,domains:JSON.stringify(m.domains),site_id:m.dns_manual?r.id:void 0,deploy:m.dns_manual?0:1};if(m.dns_manual&&"dns"===m.auth_type){const{message:e}=await O({site_id:r.id,domains:JSON.stringify(m.domains)});if(l(e)&&Object.keys(e).length)return void U(e.auths,r.id,m.domains,()=>{p("update"),u.setRefresh(!0)},!0);const a=b({width:500,height:300,hideClose:!0,component:A});try{const{message:e}=await I(t,!1);l(e)&&(e.deploy?(i.success(e.result||d("SSL.index_32")),p("update"),u.setRefresh(!0)):Array.isArray(e.auths)&&e.auths.length&&U(e.auths,r.id,m.domains,()=>{p("update"),u.setRefresh(!0)}))}catch(s){T(se(s,"message",""))}finally{a.hide()}return}const{message:a}=await I(t);l(a)&&b({hideClose:!0,data:{isJump:!1,task_id:a.task_id,onFinish:()=>{p("update"),u.setRefresh(!0)}},component:H})},{loading:k,setLoading:$}=N();return je(()=>{(async()=>{try{$(!0);const{message:e}=await Te({id:r.id});if(_(e)){const t=e.map(async e=>{const{message:t}=await M({domain:e.name});l(t)&&h.value.push({name:e.name,auto:!!t.hash})});await Promise.all(t)}}finally{$(!1)}})()}),(e,t)=>{const a=o,s=V,i=Z,l=c,d=Y,r=Q,u=ee,_=X,p=te,x=ae,b=n,$=K,j=Ie,P=y;return ue(),ve("div",null,[Pe(pe(s,{"show-icon":!1,class:"mb-10px"},{default:ce(()=>[Se("div",Ot,[pe(a,{name:"base-info",size:"17",class:"mr-8px"}),Se("span",Ut,fe(e.$t("SSL.SiteSSL.index_12")),1)])]),_:1},512),[[Ee,"dns"===me(m).auth_type]]),pe(j,{ref_key:"formRef",ref:f,model:me(m),rules:S,"label-width":"140"},{default:ce(()=>[pe(r,{label:e.$t("Config.Safe.Ssl.index_2")},{default:ce(()=>[pe(d,{value:me(m).auth_type,"onUpdate:value":t[0]||(t[0]=e=>me(m).auth_type=e)},{default:ce(()=>[pe(l,null,{default:ce(()=>[pe(i,{value:"http"},{default:ce(()=>[he(fe(e.$t("SSL.SiteSSL.index_17")),1)]),_:1}),pe(i,{value:"dns"},{default:ce(()=>[he(fe(e.$t("SSL.index_12"))+" (Wildcard support) ",1)]),_:1})]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),Pe(pe(r,{label:" ","show-feedback":!1},{default:ce(()=>[pe(u,{checked:me(m).dns_manual,"onUpdate:checked":t[1]||(t[1]=e=>me(m).dns_manual=e),"checked-value":1,"unchecked-value":0},{default:ce(()=>[he(fe(e.$t("SSL.index_2")),1)]),_:1},8,["checked"])]),_:1},512),[[Ee,"dns"===me(m).auth_type]]),Pe(pe(r,{label:" "},{default:ce(()=>[pe(u,{checked:me(m).auto_wildcard,"onUpdate:checked":t[2]||(t[2]=e=>me(m).auto_wildcard=e),"checked-value":1,"unchecked-value":0},{default:ce(()=>[he(fe(e.$t("SSL.SiteSSL.index_20")),1)]),_:1},8,["checked"])]),_:1},512),[[Ee,"dns"===me(m).auth_type]]),pe(r,{label:e.$t("Mail.Domain.index_3"),path:"domains"},{default:ce(()=>[pe(b,{show:me(k),class:"p-12px w-300px max-h-300px min-h-100px overflow-auto border border-solid border-#ccc"},{default:ce(()=>[pe(u,{class:"mb-12px",checked:me(m).all,"onUpdate:checked":t[3]||(t[3]=e=>me(m).all=e),label:e.$t("Public.SelectAll"),indeterminate:me(C)},null,8,["checked","label","indeterminate"]),me(h).length?(ue(),re(p,{key:0,value:me(m).domains,"onUpdate:value":t[4]||(t[4]=e=>me(m).domains=e)},{default:ce(()=>[pe(_,{class:"flex-col!",size:12},{default:ce(()=>[(ue(!0),ve(ye,null,we(me(h),e=>(ue(),re(u,{key:e.name,value:e.name,label:e.name},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])):(ue(),re(x,{key:1,description:"No domain name"}))]),_:1},8,["show"])]),_:1},8,["label"]),Pe(pe(r,{label:" "},{default:ce(()=>[pe(s,{"show-icon":!1,type:me(L).length?"warning":"success"},{default:ce(()=>[(ue(!0),ve(ye,null,we(me(m).domains,t=>(ue(),re(_,{key:t},{default:ce(()=>[v(t)?(ue(),re(_,{key:0,class:"flex-nowrap! py-3px"},{default:ce(()=>[pe(a,{name:"base-success",size:"17",color:"#20a53a"}),Se("span",At,"["+fe(t)+"] "+fe(e.$t("SSL.SiteSSL.index_13")),1)]),_:2},1024)):(ue(),re(_,{key:1,class:"flex-nowrap! py-3px items-center!"},{default:ce(()=>[pe(a,{name:"base-error",size:"17",color:"#E85445"}),Se("span",It,"["+fe(t)+"] "+fe(e.$t("SSL.SiteSSL.index_14")),1),pe($,{type:"primary",size:"tiny",onClick:w},{default:ce(()=>[he(fe(e.$t("SSL.SiteSSL.index_21")),1)]),_:1})]),_:2},1024))]),_:2},1024))),128))]),_:1},8,["type"])]),_:1},512),[[Ee,"dns"===me(m).auth_type&&me(m).domains.length&&!me(m).dns_manual]]),pe(r,{label:" "},{default:ce(()=>[pe($,{type:"primary",onClick:g},{default:ce(()=>[he(fe(e.$t("Public.Btn.Apply")),1)]),_:1})]),_:1})]),_:1},8,["model"]),Pe(pe(P,{class:"mt-16px"},{default:ce(()=>[Se("li",Tt,fe(e.$t("SSL.SiteSSL.index_15")),1),Se("li",null,fe(e.$t("Site.Cert.index_21")),1),Se("li",null,fe(e.$t("Site.Cert.index_23")),1),Se("li",null,fe(e.$t("Site.Cert.index_24")),1)]),_:1},512),[[Ee,"http"===me(m).auth_type]]),Pe(pe(P,{class:"mt-24px"},{default:ce(()=>[t[5]||(t[5]=Se("li",null,"Manually resolved certificates do not support auto-renewal",-1)),Se("li",null,fe(e.$t("Site.Cert.index_25")),1),Se("li",null,fe(e.$t("Site.Cert.index_26")),1),Se("li",null,fe(e.$t("Site.Cert.index_27")),1),Se("li",null,fe(e.$t("Site.Cert.index_28")),1)]),_:1,__:[5]},512),[[Ee,"dns"===me(m).auth_type]])])}}}),zt=ne({__name:"index",props:{isOpen:{type:Boolean},type:{},onRefresh:{type:Function}},setup(e){const t=e,a=()=>{t.onRefresh()};return(e,s)=>(ue(),ve("div",null,[t.isOpen&&"Let's Encrypt"===t.type?(ue(),re(Nt,{key:0,onUpdate:a})):(ue(),re(Mt,{key:1,onUpdate:a}))]))}}),Ft=ne({__name:"index",props:{onMenuChange:{type:Function}},setup(e,{expose:t}){const{data:a}=x(),{t:s}=ie(),n=ge({p:1,limit:99999}),{columns:d,table:o}=$([{key:"domain",title:s("Site.Cert.index_29"),render:e=>pe("span",{innerHTML:e.verify_domains.length>0?e.verify_domains.join("<br/>"):"--"},null)},Ue({title:s("SSL.index_54"),width:140}),{key:"issuer",title:s("Site.Cert.index_30"),ellipsis:{tooltip:!0}},j({width:150,options:t=>[{label:s("Public.Btn.Deploy"),onClick:async()=>{try{await L({hash:t.hash,domains:JSON.stringify([a.name]),append:1}),i.success(s("SSL.index_32")),setTimeout(()=>{e.onMenuChange()},500)}catch(n){console.log(n)}}},{show:"Let's Encrypt"===t.provider,label:s("Public.Btn.Del"),onClick:()=>{(e=>{z({title:s("Site.Cert.index_31"),content:s("Site.Cert.index_32"),onConfirm:async()=>{await E({hash:e.hash}),c()}})})(t)}}]})]),{loading:r,setLoading:u}=N(!0),c=async()=>{try{u(!0);const{message:e}=await F(n);l(e)&&(o.data=e.data)}finally{u(!1)}};return c(),t({init:c}),(e,t)=>{const a=R;return ue(),ve("div",null,[pe(a,{loading:me(r),columns:me(d),data:me(o).data,"max-height":510},null,8,["loading","columns","data"])])}}}),Jt={class:"mr-12px"},Ht={key:0,class:"mr-12px"},Vt={key:1,class:"mr-12px"},qt=ne({__name:"index",setup(a,{expose:s}){const n=t(),{data:i}=x(),{t:d}=ie(),o=le("current"),r=le(""),u=le(v.NotDeploy),c=le(""),_=le(!1),p=le(0),m=le(!1),S=le(""),f=async()=>{const{message:e}=await g({hash:r.value});l(e)&&b({hideClose:!0,data:{isJump:!1,task_id:e.task_id,onFinish:()=>{w()}},component:H})},y=e=>{C.value[0].data&&(C.value[0].data.loading=e)},w=async()=>{try{y(!0);const{message:a}=await h({siteName:i.name});l(a)&&(u.value=a.type,_.value=a.status,p.value=se(a,"cert_data.endtime",0),S.value=a.cert_data.issuer_O||"",m.value=(()=>{let e=!1;return p.value<=30&&(e=!0),u.value===v.TestDeploy&&p.value<0&&(e=!0),u.value!==v.SaveOrHolderDeploy&&u.value!==v.NotDeploy||(e=!1),e})(),c.value=a.cert_data.dns.join(","),r.value=a.hash,t=a,C.value[0].data&&(C.value[0].data.info=t),e=m.value,C.value[0].data&&(C.value[0].data.isRenew=e))}catch(a){_.value=!1,m.value=!1}finally{y(!1)}var e,t},C=le([{key:"current",label:()=>pe("div",null,[pe("span",null,[he("Current Certs - ")]),pe("span",{class:_.value?"text-#1d9534":"text-red-500"},[he("["),_.value?"Deployed":"Not Deployed",he("]")])]),data:{info:null,isRenew:!1,loading:!0,onRefresh:w},component:Re(dt)},{key:"business",label:d("Site.Cert.index_64"),component:Re(St)},{key:"let",label:d("Site.Cert.index_65"),data:{isOpen:de(()=>_.value),type:de(()=>S.value),onRefresh:w},component:Re(zt)},{key:"holder",label:d("Site.Cert.index_66"),component:Re(Ft),data:{onMenuChange:()=>{o.value="current",w(),n.setRefresh(!0)}}}]);return s({init:()=>{w()}}),(t,a)=>{const s=K,n=V,i=e;return ue(),ve("div",null,[me(_)?_e("",!0):(ue(),re(n,{key:0,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce(()=>[Se("span",Jt,fe(t.$t("Site.Cert.index_41")),1),pe(s,{size:"tiny",type:"primary",onClick:a[0]||(a[0]=e=>o.value="business")},{default:ce(()=>[he(fe(t.$t("Site.Cert.index_43")),1)]),_:1})]),_:1})),me(_)&&me(m)?(ue(),re(n,{key:1,class:"mb-12px",type:"error","show-icon":!1,style:{"--n-padding":"9px 16px"}},{default:ce(()=>[me(p)>0?(ue(),ve("span",Ht,fe(t.$t("SSL.SiteSSL.index_26",[me(c),me(p)])),1)):(ue(),ve("span",Vt,fe(t.$t("SSL.SiteSSL.index_19",[me(c)])),1)),pe(s,{size:"tiny",type:"primary",onClick:f},{default:ce(()=>[he(fe(t.$t("Site.Cert.index_53")),1)]),_:1})]),_:1})):_e("",!0),pe(i,{value:me(o),"onUpdate:value":a[1]||(a[1]=e=>xe(o)?o.value=e:null),options:me(C)},null,8,["value","options"])])}}});export{qt as default};
