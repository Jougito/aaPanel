const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/index271.js?v=1760428868419","js/index108.js?v=1760428868419","js/vue.js?v=1760428868419","js/__commonjsHelpers__.js?v=1760428868419","js/naive.js?v=1760428868419","js/common.js?v=1760428868419","js/page_layout.js?v=1760428868419","js/public.js?v=1760428868419","css/public.css?v=1760428868419","css/page_layout.css?v=1760428868419","css/index21.css?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419","css/index15.css?v=1760428868419","js/index87.js?v=1760428868419","js/index133.js?v=1760428868419","css/index23.css?v=1760428868419","js/index.js?v=1760428868419","css/index109.css?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang12.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang8.js?v=1760428868419","js/index131.js?v=1760428868419","js/php.js?v=1760428868419","js/soft.js?v=1760428868419","js/site.js?v=1760428868419","css/index22.css?v=1760428868419","js/site4.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang15.js?v=1760428868419","js/index245.js?v=1760428868419","css/index59.css?v=1760428868419","js/index99.js?v=1760428868419","css/index14.css?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang10.js?v=1760428868419","js/index98.js?v=1760428868419","css/index13.css?v=1760428868419","js/index100.js?v=1760428868419","js/index101.js?v=1760428868419","js/file.js?v=1760428868419","js/theme-monokai.js?v=1760428868419","css/index16.css?v=1760428868419","js/refersh.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang17.js?v=1760428868419","js/index105.js?v=1760428868419","css/index19.css?v=1760428868419","js/ssl.js?v=1760428868419","js/cert.js?v=1760428868419","js/ssl-lets-progress.js?v=1760428868419","css/ssl-lets-progress.css?v=1760428868419","js/utils3.js?v=1760428868419","js/index218.js?v=1760428868419","js/paypal-js.js?v=1760428868419","css/index48.css?v=1760428868419","js/upload.js?v=1760428868419","css/index60.css?v=1760428868419","js/index272.js?v=1760428868419"])))=>i.map(i=>d[i]);
import{t as e,i as t,d as a,bf as l,p as s,m as i,w as n,bT as o,_ as u,a as r}from"./page_layout.js?v=1760428868419";import{_ as d}from"./index.js?v=1760428868419";import{u as p}from"./useModal2.js?v=1760428868419";import{d as c,c as _,h as m,f as h,a as f,_ as v,w,e as x,G as g,r as y}from"./public.js?v=1760428868419";import{Y as b,aG as j}from"./site.js?v=1760428868419";import{i as k,j as P,k as C,u as O,l as R,s as W,n as D,p as z}from"./index87.js?v=1760428868419";import{_ as M}from"./index108.js?v=1760428868419";import{i as U,p as q,k as $,W as A,R as B,V as F,S as L,U as T,a2 as E,a3 as H,q as S,P as V,r as I,aj as K,ak as N,j as G,a4 as J,t as Y,an as Q,e as X,_ as Z}from"./vue.js?v=1760428868419";import{dj as ee,dm as te,dd as ae,au as le,aC as se,dk as ie,bJ as ne}from"./naive.js?v=1760428868419";import{_ as oe}from"./form.vue_vue_type_script_setup_true_lang2.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index133.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1760428868419";import"./index131.js?v=1760428868419";import"./php.js?v=1760428868419";import"./soft.js?v=1760428868419";import"./site4.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1760428868419";import"./index245.js?v=1760428868419";import"./index99.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang10.js?v=1760428868419";import"./index98.js?v=1760428868419";import"./index100.js?v=1760428868419";import"./index101.js?v=1760428868419";import"./file.js?v=1760428868419";import"./theme-monokai.js?v=1760428868419";import"./refersh.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang17.js?v=1760428868419";import"./index105.js?v=1760428868419";import"./ssl.js?v=1760428868419";import"./cert.js?v=1760428868419";import"./ssl-lets-progress.js?v=1760428868419";import"./utils3.js?v=1760428868419";import"./index218.js?v=1760428868419";import"./paypal-js.js?v=1760428868419";import"./upload.js?v=1760428868419";const ue=Symbol("server-list");function re(){return U(ue)}const de=a=>e.post("/tamper_core/add_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_2"),isOriginalResult:!0,prefix:""}}),pe=a=>e.post("/tamper_core/remove_black_exts.json",a,{requestOptions:{loading:t.global.t("WP.api.tamper_3"),isOriginalResult:!0,prefix:""}}),ce=$({__name:"index",setup(s,{expose:i}){const{site:n,setPid:o}=re(),{loading:u,setLoading:r}=c(),{table:d,columns:p}=_([{key:"name",title:"Name"},{key:"status",title:"Status",align:"right",render:l=>A(ee,{value:l.status,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async s=>{const{message:i}=await(n={key:l.key,value:s,path_id:l.id},e.post("/tamper_core/modify_path_config.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_1"),isOriginalResult:!0,prefix:""}}));var n;a(i)&&i.status&&(l.status=s)}},null)}]),h=[{title:"Create file",name:"create"},{title:"Modify file",name:"modify"},{title:"Delete file",name:"unlink"},{title:"Create directory",name:"mkdir"},{title:"Delete directory",name:"rmdir"},{title:"Rename file",name:"rename"},{title:"Create soft link",name:"link"},{title:"Modify permissions",name:"chmod"},{title:"Modify owner",name:"chown"}],f=async()=>{try{r(!0);const{message:t}=await k({path:n.path});a(t)&&!te(t)?(o(t.pid),e=t,d.data=h.map(t=>{const a="is_".concat(t.name),s=e[a];return{key:a,id:e.pid,name:"Disabled ".concat(t.title),status:l(s)?s:0}})):d.data=[]}finally{r(!1)}var e};return f(),i({init:f}),(e,t)=>{const a=m;return F(),B("div",null,[A(a,{loading:T(u),"loading-num":9,"max-height":340,data:T(d).data,columns:T(p)},null,8,["loading","data","columns"]),t[0]||(t[0]=L("div",{class:"mt-16px text-#777"}," Tip: Current config intercepts the above rules by default, please set and config the rules according the current project requirements. ",-1))])}}});const _e=s({},[["render",function(e,t){const a=ae;return F(),E(a,{size:"small",bordered:!1},{default:H(()=>[S(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-c6193199"]]),me={class:"flex mb-12px"},he={class:"w-240px mr-12px"},fe=$({__name:"index",setup(e,{expose:t}){const{t:l}=V(),{site:s,setPid:o}=re(),u=I("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter suffix");const{message:e}=await de({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",j()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Suffix"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected file suffix [".concat(e.exts,"]"),content:"Delete protected file suffix, the file whose file name ends with this suffix will lose protection. want to continue?",onConfirm:async()=>{const{message:t}=await pe({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),j()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),j=async()=>{try{b(!0);const{message:t}=await k({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter(e=>"/"!=e[0]&&-1==e.indexOf("./")).map(t=>({id:e.pid,exts:t})):w.data=[])}finally{b(!1)}var e};return j(),t({init:j}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return F(),B("div",null,[L("div",me,[L("div",he,[A(a,{value:T(u),"onUpdate:value":t[0]||(t[0]=e=>N(u)?u.value=e:null),placeholder:"Suffix",onKeyup:K(p,["enter"])},null,8,["value"])]),A(l,{type:"primary",onClick:p},{default:H(()=>[G(J(e.$t("Public.Btn.Add")),1)]),_:1})]),A(s,{loading:T(y),"loading-num":6,"max-height":230,data:T(w).data,columns:T(x)},null,8,["loading","data","columns"]),A(n,{class:"mt-16px"},{default:H(()=>[t[25]||(t[25]=L("li",null," The so-called file suffix refers the string at the end of the file name, not necessarily the extension ",-1)),L("li",null,[t[5]||(t[5]=G(" As: ",-1)),A(i,null,{default:H(()=>t[1]||(t[1]=[G(".php",-1)])),_:1,__:[1]}),t[6]||(t[6]=G(", ",-1)),A(i,null,{default:H(()=>t[2]||(t[2]=[G(".html",-1)])),_:1,__:[2]}),t[7]||(t[7]=G(", ",-1)),A(i,null,{default:H(()=>t[3]||(t[3]=[G(".js?v=1760428868419",-1)])),_:1,__:[3]}),t[8]||(t[8]=G(", ",-1)),A(i,null,{default:H(()=>t[4]||(t[4]=[G("index.php",-1)])),_:1,__:[4]}),t[9]||(t[9]=G(" etc. ",-1))]),t[26]||(t[26]=L("div",null,"Example:",-1)),L("li",null,[A(i,null,{default:H(()=>t[10]||(t[10]=[G(".php",-1)])),_:1,__:[10]}),t[14]||(t[14]=G(" Match: ",-1)),A(i,null,{default:H(()=>t[11]||(t[11]=[G("./1.php",-1)])),_:1,__:[11]}),t[15]||(t[15]=G()),A(i,null,{default:H(()=>t[12]||(t[12]=[G("./test/2.php",-1)])),_:1,__:[12]}),t[16]||(t[16]=G(" Mismatch: ",-1)),A(i,null,{default:H(()=>t[13]||(t[13]=[G("./1.php/1.txt",-1)])),_:1,__:[13]})]),L("li",null,[A(i,null,{default:H(()=>t[17]||(t[17]=[G("index.php",-1)])),_:1,__:[17]}),t[22]||(t[22]=G(" Match: ",-1)),A(i,null,{default:H(()=>t[18]||(t[18]=[G("./index.php",-1)])),_:1,__:[18]}),t[23]||(t[23]=G()),A(i,null,{default:H(()=>t[19]||(t[19]=[G("./test/index.php",-1)])),_:1,__:[19]}),A(i,{class:"ml-0.5em"},{default:H(()=>t[20]||(t[20]=[G("./abc_index.php",-1)])),_:1,__:[20]}),t[24]||(t[24]=G(" Mismatch: ",-1)),A(i,null,{default:H(()=>t[21]||(t[21]=[G("./index.php.tar.gz",-1)])),_:1,__:[21]})])]),_:1,__:[25,26]})])}}}),ve={class:"flex mb-12px"},we={class:"w-240px mr-12px"},xe=$({__name:"index",setup(e,{expose:t}){const{t:l}=V(),{site:s,setPid:o}=re(),u=I("");let r=-1,d="";const p=async()=>{if(""===u.value.trim())return void i.error("Please enter the full path or relative path of the file");const{message:e}=await de({path_id:r,path:d,exts:u.value});a(e)&&(e.status?(i.success(e.msg),u.value="",j()):i.error(e.msg))},{table:w,columns:x}=_([{key:"exts",title:"Full file path"},h({width:100,options:e=>[{label:l("Public.Btn.Del"),onClick:()=>{g(e)}}]})]),g=async e=>{f({title:"Delete protected files [".concat(e.exts,"]"),content:"After deleting a protected file, the file will be unprotected, should I continue the operation?",onConfirm:async()=>{const{message:t}=await pe({path_id:e.id,path:d,exts:e.exts});a(t)&&(t.status?(i.success(t.msg),j()):i.error(t.msg))}})},{loading:y,setLoading:b}=c(),j=async()=>{try{b(!0);const{message:t}=await k({path:s.path});a(t)&&(o(t.pid),r=(e=t).pid,d=e.path,n(e.black_exts)?w.data=e.black_exts.filter(e=>"/"==e[0]||"."==e[0]&&"/"==e[1]).map(t=>({id:e.pid,exts:t})):w.data=[])}finally{b(!1)}var e};return j(),t({init:j}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return F(),B("div",null,[L("div",ve,[L("div",we,[A(a,{value:T(u),"onUpdate:value":t[0]||(t[0]=e=>N(u)?u.value=e:null),placeholder:"Full path Or Relative path",onKeyup:K(p,["enter"])},null,8,["value"])]),A(l,{type:"primary",onClick:p},{default:H(()=>[G(J(e.$t("Public.Btn.Add")),1)]),_:1})]),A(s,{loading:T(y),"loading-num":5,"max-height":200,data:T(w).data,columns:T(x)},null,8,["loading","data","columns"]),A(n,{class:"mt-16px"},{default:H(()=>[t[15]||(t[15]=L("li",{class:"font-bold text-#333"},"The following 4 methods are supported",-1)),L("li",null,[t[2]||(t[2]=G("1. Complete file path, such as: ",-1)),A(i,null,{default:H(()=>t[1]||(t[1]=[G("/www/wwwroot/test/123.log",-1)])),_:1,__:[1]})]),L("li",null,[t[5]||(t[5]=G(" 2. Relative path to the site, such as: Full path ",-1)),A(i,null,{default:H(()=>t[3]||(t[3]=[G("/www/wwwroot/test/app/123.log",-1)])),_:1,__:[3]}),t[6]||(t[6]=G(" Relative path ",-1)),A(i,null,{default:H(()=>t[4]||(t[4]=[G("./app/123.log",-1)])),_:1,__:[4]})]),L("li",null,[t[9]||(t[9]=G(" 3. All files in the specified directory, such as: ",-1)),A(i,null,{default:H(()=>t[7]||(t[7]=[G("/www/wwwroot/test/app/*",-1)])),_:1,__:[7]}),t[10]||(t[10]=G(" Relative path ",-1)),A(i,null,{default:H(()=>t[8]||(t[8]=[G("./app/*",-1)])),_:1,__:[8]})]),L("li",null,[t[13]||(t[13]=G(" 4. the specified directory under the specified file type, such as: ",-1)),A(i,null,{default:H(()=>t[11]||(t[11]=[G("/www/wwwroot/test/app/*.log",-1)])),_:1,__:[11]}),t[14]||(t[14]=G(" Relative path ",-1)),A(i,null,{default:H(()=>t[12]||(t[12]=[G("./app/*.log",-1)])),_:1,__:[12]})]),t[16]||(t[16]=L("li",{class:"text-error"}," Note: files already included in the protected file suffix do not need to be set. ",-1))]),_:1,__:[15,16]})])}}}),ge={class:"flex mb-12px"},ye={class:"w-240px mr-12px"},be=$({__name:"index",setup(l,{expose:s}){const{t:o}=V(),{site:u,setPid:r}=re(),d=I("");let p=-1,x="";const g=async()=>{if(""===d.value.trim())return void i.error("Please enter directory name");const{message:l}=await(s={path_id:p,path:x,dirnames:d.value},e.post("/tamper_core/add_white_dirs.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",O()):i.error(l.msg))},{table:y,columns:b}=_([{key:"dir",title:"Directory",ellipsis:{tooltip:!0}},w({title:"Remark",onBlur:async(l,s)=>{const{message:n}=await(o={path_id:s.id,dir_name:s.dir,ps:l},e.post("/tamper_core/set_white_dir_with_ps.json",o,{requestOptions:{loading:t.global.t("WP.api.tamper_5"),isOriginalResult:!0,prefix:""}}));var o;a(n)&&(n.status?s.ps=l:i.error(n.msg))}}),h({width:80,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{j(e)}}]})]),j=async l=>{f({title:"Delete directory whitelist",content:l.tip_msg?l.tip_msg:"Delete [".concat(l.dir,"] later, All files in the directory will be protected, continue?"),onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:x,dirname:l.dir},e.post("/tamper_core/remove_white_dirs.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),O()):i.error(s.msg))}})},{loading:P,setLoading:C}=c(),O=async()=>{try{C(!0);const{message:t}=await k({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,x=e.path,n(e.white_dirs)?y.data=e.white_dirs.map(t=>({id:e.pid,ps:t.ps||"",tip_msg:t.tip_msg||"",...t})):y.data=[])}finally{C(!1)}var e};return O(),s({init:O}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return F(),B("div",null,[L("div",ge,[L("div",ye,[A(a,{value:T(d),"onUpdate:value":t[0]||(t[0]=e=>N(d)?d.value=e:null),placeholder:"Directory name",onKeyup:K(g,["enter"])},null,8,["value"])]),A(l,{type:"primary",onClick:g},{default:H(()=>[G(J(e.$t("Public.Btn.Add")),1)]),_:1})]),A(s,{loading:T(P),"loading-num":5,"max-height":188,data:T(y).data,columns:T(b)},null,8,["loading","data","columns"]),A(n,{class:"mt-16px"},{default:H(()=>[L("li",null,[t[4]||(t[4]=G(" Full path or directory name or parts path are allowed such as: ",-1)),A(i,null,{default:H(()=>t[1]||(t[1]=[G("/www/abc/cache/test/",-1)])),_:1,__:[1]}),t[5]||(t[5]=G(", ",-1)),A(i,null,{default:H(()=>t[2]||(t[2]=[G("test",-1)])),_:1,__:[2]}),t[6]||(t[6]=G(", ",-1)),A(i,null,{default:H(()=>t[3]||(t[3]=[G("cache/test/",-1)])),_:1,__:[3]})]),L("li",null,[t[10]||(t[10]=G(" The first character of the Full path must be ",-1)),A(i,null,{default:H(()=>t[7]||(t[7]=[G("/",-1)])),_:1,__:[7]}),t[11]||(t[11]=G(", as: ",-1)),A(i,null,{default:H(()=>t[8]||(t[8]=[G("cache/test/",-1)])),_:1,__:[8]}),t[12]||(t[12]=G(" or ",-1)),A(i,null,{default:H(()=>t[9]||(t[9]=[G("test",-1)])),_:1,__:[9]})]),L("li",null,[t[15]||(t[15]=G(" art of directory name or path cannot begin with ",-1)),A(i,null,{default:H(()=>t[13]||(t[13]=[G("/",-1)])),_:1,__:[13]}),t[16]||(t[16]=G(", as: ",-1)),A(i,null,{default:H(()=>t[14]||(t[14]=[G("/www/abc/cache/test/",-1)])),_:1,__:[14]})]),t[39]||(t[39]=L("div",null,"Example:",-1)),L("li",null,[A(i,null,{default:H(()=>t[17]||(t[17]=[G("/www/abc/",-1)])),_:1,__:[17]}),t[21]||(t[21]=G(" Match: ",-1)),A(i,null,{default:H(()=>t[18]||(t[18]=[G("/www/abc/*",-1)])),_:1,__:[18]}),t[22]||(t[22]=G(" Mismatch: ",-1)),A(i,null,{default:H(()=>t[19]||(t[19]=[G("/www/abc",-1)])),_:1,__:[19]}),A(i,{class:"ml-0.5em"},{default:H(()=>t[20]||(t[20]=[G("/www/abc123",-1)])),_:1,__:[20]})]),L("li",null,[A(i,null,{default:H(()=>t[23]||(t[23]=[G("test",-1)])),_:1,__:[23]}),t[27]||(t[27]=G(" Match: ",-1)),A(i,null,{default:H(()=>t[24]||(t[24]=[G("/www/test/1.txt",-1)])),_:1,__:[24]}),t[28]||(t[28]=G()),A(i,null,{default:H(()=>t[25]||(t[25]=[G("/www/test_abc",-1)])),_:1,__:[25]}),t[29]||(t[29]=G(" Mismatch: ",-1)),A(i,null,{default:H(()=>t[26]||(t[26]=[G("/www/1.php",-1)])),_:1,__:[26]})]),L("li",null,[A(i,null,{default:H(()=>t[30]||(t[30]=[G("cache/test/",-1)])),_:1,__:[30]}),t[35]||(t[35]=G(" Match: ",-1)),A(i,null,{default:H(()=>t[31]||(t[31]=[G("/www/cache/test/1.txt",-1)])),_:1,__:[31]}),t[36]||(t[36]=G()),A(i,null,{default:H(()=>t[32]||(t[32]=[G("/cache/test/",-1)])),_:1,__:[32]}),t[37]||(t[37]=G(" Mismatch: ",-1)),A(i,null,{default:H(()=>t[33]||(t[33]=[G("/www/cache/test",-1)])),_:1,__:[33]}),t[38]||(t[38]=G()),A(i,null,{default:H(()=>t[34]||(t[34]=[G("/cache/",-1)])),_:1,__:[34]})])]),_:1,__:[39]})])}}}),je={class:"flex mb-12px"},ke={class:"w-240px mr-12px"},Pe=$({__name:"index",setup(l,{expose:s}){const{t:o}=V(),{site:u,setPid:r}=re(),d=I("");let p=-1,w="";const x=async()=>{if(""===d.value.trim())return void i.error("Please enter file name");const{message:l}=await(s={path_id:p,path:w,filename:d.value},e.post("/tamper_core/add_white_files.json",s,{requestOptions:{loading:t.global.t("WP.api.tamper_4"),isOriginalResult:!0,prefix:""}}));var s;a(l)&&(l.status?(i.success(l.msg),d.value="",C()):i.error(l.msg))},{table:g,columns:y}=_([{key:"filename",title:"File name"},h({width:100,options:e=>[{label:o("Public.Btn.Del"),onClick:()=>{b(e)}}]})]),b=async l=>{f({title:"Delete file whitelist [".concat(l.filename,"]"),content:"After Delete whitelist, the file will be protected. want to continue?",onConfirm:async()=>{const{message:s}=await(n={path_id:l.id,path:w,filename:l.filename},e.post("/tamper_core/remove_white_files.json",n,{requestOptions:{loading:t.global.t("WP.api.tamper_6"),isOriginalResult:!0,prefix:""}}));var n;a(s)&&(s.status?(i.success(s.msg),C()):i.error(s.msg))}})},{loading:j,setLoading:P}=c(),C=async()=>{try{P(!0);const{message:t}=await k({path:u.path});a(t)&&(r(t.pid),p=(e=t).pid,w=e.path,n(e.white_files)?g.data=e.white_files.map(t=>({id:e.pid,filename:t})):g.data=[])}finally{P(!1)}var e};return C(),s({init:C}),(e,t)=>{const a=le,l=se,s=m,i=_e,n=v;return F(),B("div",null,[L("div",je,[L("div",ke,[A(a,{value:T(d),"onUpdate:value":t[0]||(t[0]=e=>N(d)?d.value=e:null),placeholder:"File name",onKeyup:K(x,["enter"])},null,8,["value"])]),A(l,{type:"primary",onClick:x},{default:H(()=>[G(J(e.$t("Public.Btn.Add")),1)]),_:1})]),A(s,{loading:T(j),"loading-num":6,"max-height":230,data:T(g).data,columns:T(y)},null,8,["loading","data","columns"]),A(n,{class:"mt-16px"},{default:H(()=>[L("li",null,[t[3]||(t[3]=G(" Full path or single filename are allowed such as: ",-1)),A(i,null,{default:H(()=>t[1]||(t[1]=[G("/test/index.php",-1)])),_:1,__:[1]}),t[4]||(t[4]=G(", ",-1)),A(i,null,{default:H(()=>t[2]||(t[2]=[G("index.php",-1)])),_:1,__:[2]})]),t[17]||(t[17]=L("li",null,"Note: Only be an absolute path or file name, relative paths are not supported",-1)),t[18]||(t[18]=L("div",null,"Example:",-1)),L("li",null,[A(i,null,{default:H(()=>t[5]||(t[5]=[G("index.php",-1)])),_:1,__:[5]}),t[10]||(t[10]=G(" Match: ",-1)),A(i,null,{default:H(()=>t[6]||(t[6]=[G("./index.php",-1)])),_:1,__:[6]}),t[11]||(t[11]=G()),A(i,null,{default:H(()=>t[7]||(t[7]=[G("./test/index.php",-1)])),_:1,__:[7]}),t[12]||(t[12]=G(" Mismatch: ",-1)),A(i,null,{default:H(()=>t[8]||(t[8]=[G("./abc_index.php",-1)])),_:1,__:[8]}),t[13]||(t[13]=G()),A(i,null,{default:H(()=>t[9]||(t[9]=[G("./index.php/1.txt",-1)])),_:1,__:[9]})]),L("li",null,[A(i,null,{default:H(()=>t[14]||(t[14]=[G("/test/index.php",-1)])),_:1,__:[14]}),t[16]||(t[16]=G(" match only: ",-1)),A(i,null,{default:H(()=>t[15]||(t[15]=[G("/test/index.php",-1)])),_:1,__:[15]})])]),_:1,__:[17,18]})])}}}),Ce={class:"p-20px"},Oe={class:"flex items-center text-12px text-#666"},Re={key:0,class:"ml-12px"},We={class:"h-500px"},De=$({__name:"index",props:{open:{type:Boolean,default:!1},site:{}},emits:["changeOpen"],setup(e,{emit:t}){const a=e,l=t,s=Y(a,"site");let i=-1;const n=I(a.open),o=I(),u=async e=>{e?await P({paths:[{path:s.value.path,ps:s.value.ps}]}):await C({path_id:i}),n.value=e,l("changeOpen",e),o.value.init()},r=I("basic"),d=[{key:"basic",label:"Basic Setting",component:ce},{key:"suffix",label:"Protected file suffix",component:fe},{key:"protected file",label:"Protected File",component:xe},{key:"directory whitelist",label:"Directory whitelist",component:be},{key:"file whitelist",label:"File whitelist",component:Pe}];var p;return p={site:s.value,setPid:e=>{i=e}},q(ue,p),(e,t)=>{const a=ee,l=ie,s=M;return F(),B("div",Ce,[A(l,{class:"mb-16px",type:T(n)?"success":"error","show-icon":!1,bordered:!1},{default:H(()=>[L("div",Oe,[t[1]||(t[1]=L("span",{class:"mr-12px"},"Protection switch",-1)),A(a,{value:T(n),"onUpdate:value":u},null,8,["value"]),T(n)?Q("",!0):(F(),B("span",Re," Protection directory closed, be security risks, Recommended open protection immediately "))])]),_:1},8,["type"]),L("div",We,[A(s,{ref_key:"tabsRef",ref:o,value:T(r),"onUpdate:value":t[0]||(t[0]=e=>N(r)?r.value=e:null),options:d},null,8,["value"])])])}}}),ze=$({__name:"index",props:{site:{}},emits:["changeHotlink"],setup(e,{emit:t}){const a=t,l=Y(e,"site"),s=e=>{a("changeHotlink",e)};return(e,t)=>(F(),B("div",null,[A(oe,{class:"p-20px",site:T(l),onChangeHotlink:s},null,8,["site"])]))}}),Me={class:"p-20px"},Ue={class:"tools-card"},qe={class:"tools-img"},$e={class:"tools-name"},Ae={class:"tools-desc"},Be={class:"ml-0.5em"},Fe={class:"tools-card"},Le={class:"tools-img"},Te={class:"tools-name"},Ee={class:"tools-desc"},He={class:"ml-0.5em"},Se={class:"tools-card"},Ve={class:"tools-img"},Ie={class:"tools-name"},Ke={class:"tools-card flex-col!"},Ne={class:"flex items-center! w-full pb-10px"},Ge={class:"tools-name"},Je={class:"tools-card flex-col!"},Ye={class:"flex items-center! w-full pb-10px"},Qe={class:"tools-name min-w-auto!"},Xe=s($({__name:"index",props:{site:{}},setup(e){const t=Z(()=>r(()=>import("./index271.js?v=1760428868419"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55]))),l=Z(()=>r(()=>import("./index272.js?v=1760428868419"),__vite__mapDeps([56,7,6,2,3,4,5,9,8,14,15,16,17,18,11,12,13,19,20,21,22,23,24,25,26,27,28,29,30,31,32,1,10,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55]))),{t:s}=V(),i=Y(e,"site"),n=O(),c=X({status:!1,number:0,pid:-1}),_=I(!1),m=I(!1),h=async e=>{try{_.value=!0;const t=s(e?"WP.index_46":"WP.index_47");f({title:s("WP.index_48"),content:t,onConfirm:async()=>{await W({path:i.value.path}),m.value=e}})}finally{_.value=!1}},v=x(s("WP.index_43")),w=async()=>{v.data.row=i.value,v.show=!0},M=x(),U=async()=>{M.title="".concat(s("WP.index_32")," [").concat(i.value.name,"]"),M.data.site=i.value,M.show=!0},q=I(!1),$=async e=>{try{q.value=!0,await g({source:200}),await y("tamper_core"),e?await P({paths:[{path:i.value.path,ps:i.value.ps}]}):await C({path_id:c.pid}),pe()}finally{q.value=!1}},E=x("File Protection [".concat(i.value.name,"]"),{site:i.value,open:!1,onChangeOpen:e=>{c.status=e}}),S=async()=>{await g({source:200}),await y("tamper_core"),E.data.open=c.status,E.show=!0},K=X({status:!1,number:0}),N=I(!1),Q=async e=>{try{N.value=!0,await g({source:201}),await y("btwaf"),e?await D({site_name:i.value.name}):await z({site_name:i.value.name}),pe()}finally{n.setRefresh(!0),N.value=!1}},te=async()=>{await g({source:201}),await y("btwaf"),p({row:{siteName:i.value.name},onRefresh:()=>{pe(),n.setRefresh(!0)}})},le=I(!1),ie=I(!1),oe=async e=>{try{ie.value=!0;const{message:t}=await b({id:i.value.id,name:i.value.name},!1);if(a(t)){const a={id:i.value.id,name:i.value.name,fix:t.fix,domains:t.domains,return_rule:t.return_rule,status:e,http_status:"true"===t.http_status};await j(a,!1),le.value=e}}finally{ie.value=!1}},ue=x("Hotlink Protection [".concat(i.value.name,"]"),{site:i.value,onChangeHotlink:e=>{le.value=e}}),re=()=>{ue.show=!0},de=e=>{q.value=e,N.value=e,ie.value=e,_.value=e},pe=async()=>{try{de(!0);const{message:e}=await R({id:i.value.id,path:i.value.path,site_name:i.value.name});if(a(e)&&(c.status=1===e.file_status,c.number=e.file_count,K.status=1===e.firewall_status,K.number=e.firewall_count,le.value=1===e.hotlink_status,m.value=1===e.virus_scanning,1===e.file_status)){const{message:e}=await k({path:i.value.path});a(e)&&(c.pid=e.pid)}}finally{de(!1)}};return pe(),(e,a)=>{const s=ne,i=ee,n=u,r=se,p=ae,f=d;return F(),B("div",Me,[L("div",Ue,[L("div",qe,[A(s,{lazy:!0,"preview-disabled":!0,width:"24",src:"".concat(T(o),"images/soft-ico/ico-tamper_core.png")},null,8,["src"])]),L("div",$e,J(e.$t("WP.Label.index_5")),1),A(i,{value:T(c).status,loading:T(q),"onUpdate:value":$},null,8,["value","loading"]),A(r,{quaternary:"",size:"small",onClick:S},{default:H(()=>[A(n,{name:"setting",size:"18"})]),_:1}),L("div",Ae,[A(p,{type:"error",size:"small",bordered:!1},{default:H(()=>[G(J(T(c).number),1)]),_:1}),L("span",Be,J(e.$t("WP.Config.index_6")),1)])]),L("div",Fe,[L("div",Le,[A(s,{lazy:!0,"preview-disabled":!0,width:"26",src:"".concat(T(o),"images/soft-ico/ico-btwaf.png")},null,8,["src"])]),L("div",Te,J(e.$t("WP.Label.index_6")),1),A(i,{value:T(K).status,loading:T(N),"onUpdate:value":Q},null,8,["value","loading"]),A(r,{quaternary:"",size:"small",onClick:te},{default:H(()=>[A(n,{name:"setting",size:"18"})]),_:1}),L("div",Ee,[A(p,{type:"error",size:"small",bordered:!1},{default:H(()=>[G(J(T(K).number),1)]),_:1}),L("span",He,J(e.$t("WP.Config.index_7")),1)])]),L("div",Se,[L("div",Ve,[A(n,{name:"soft-hotlink",size:"24"})]),L("div",Ie,J(e.$t("WP.Label.index_7")),1),A(i,{value:T(le),loading:T(ie),"onUpdate:value":oe},null,8,["value","loading"]),A(r,{quaternary:"",size:"small",onClick:re},{default:H(()=>[A(n,{name:"setting",size:"18"})]),_:1})]),L("div",Ke,[L("div",Ne,[a[4]||(a[4]=L("div",{class:"tools-img"},[L("i",{class:"i-healthicons:health-vulnerability-through-social-determinants-outline-24px text-26px text-primary!"})],-1)),L("div",Ge,J(e.$t("WP.index_43")),1),A(i,{value:T(m),loading:T(_),"onUpdate:value":h},null,8,["value","loading"]),A(r,{quaternary:"",size:"small",onClick:w},{default:H(()=>[A(n,{name:"setting",size:"18"})]),_:1})]),a[5]||(a[5]=L("div",{class:"w-full color-#999"},"Check plugins and themes for security risks",-1))]),L("div",Je,[L("div",Ye,[a[6]||(a[6]=L("div",{class:"tools-img"},[L("i",{class:"i-material-symbols:library-add-check-outline text-26px text-#20a53a!"})],-1)),L("div",Qe,J(e.$t("WP.TableRow.index_4")),1),A(r,{quaternary:"",size:"small",onClick:U},{default:H(()=>[A(n,{name:"setting",size:"18"})]),_:1})]),a[7]||(a[7]=L("div",{class:"w-full color-#999"}," Check the integrity of the core files of this WP version to ensure they are not infected with malicious viruses! ",-1))]),A(f,{show:T(E).show,"onUpdate:show":a[0]||(a[0]=e=>T(E).show=e),title:T(E).title,data:T(E).data,width:800,component:De},null,8,["show","title","data"]),A(f,{show:T(ue).show,"onUpdate:show":a[1]||(a[1]=e=>T(ue).show=e),title:T(ue).title,data:T(ue).data,component:ze},null,8,["show","title","data"]),A(f,{show:T(v).show,"onUpdate:show":a[2]||(a[2]=e=>T(v).show=e),title:T(v).title,data:T(v).data,width:800,"min-height":500,component:T(t)},null,8,["show","title","data","component"]),A(f,{show:T(M).show,"onUpdate:show":a[3]||(a[3]=e=>T(M).show=e),title:T(M).title,data:T(M).data,width:600,"min-height":190,component:T(l)},null,8,["show","title","data","component"])])}}}),[["__scopeId","data-v-c7bf07c5"]]);export{Xe as default};
