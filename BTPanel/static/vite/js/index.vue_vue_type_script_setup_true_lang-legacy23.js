System.register(["./index.vue_vue_type_script_setup_true_lang-legacy6.js?v=1760428868419","./page_layout-legacy.js?v=1760428868419","./index-legacy245.js?v=1760428868419","./vue-legacy.js?v=1760428868419","./index-legacy42.js?v=1760428868419","./index-legacy.js?v=1760428868419","./public-legacy.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy5.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy7.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy12.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy10.js?v=1760428868419","./index-legacy108.js?v=1760428868419","./naive-legacy.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy11.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1760428868419","./soft-legacy.js?v=1760428868419","./echarts-legacy.js?v=1760428868419"],function(e,t){"use strict";var a,i,l,s,r,n,o,c,u,d,m,p,g,v,y,x,f,M,h,b,w,k,_,I,N,D,j,S,A,z,C,T,L,O,U,Q,H,Y,P,W,E,R,Z,G,B,J,V,F,$,X,K,q,ee,te,ae,ie,le,se,re,ne,oe,ce,ue,de,me,pe,ge,ve,ye,xe,fe,Me,he,be,we,ke,_e,Ie,Ne,De,je,Se,Ae,ze,Ce,Te,Le,Oe,Ue,Qe,He,Ye,Pe,We,Ee,Re,Ze,Ge,Be,Je,Ve,Fe,$e,Xe,Ke,qe,et,tt,at,it,lt,st,rt;return{setters:[e=>{a=e.a},e=>{i=e.d,l=e._,s=e.p,r=e.w,n=e.u,o=e.m,c=e.a,u=e.S,d=e.q,m=e.a8,p=e.bL,g=e.bK,v=e.o,y=e.bU,x=e.cz},e=>{f=e._},e=>{M=e.Z,h=e.r,b=e.a0,w=e.k,k=e.W,_=e.F,I=e.R,N=e.V,D=e.S,j=e.a4,S=e.U,A=e.O,z=e.I,C=e.P,T=e.c,L=e.ak,O=e.ay,U=e.a3,Q=e.j,H=e.an,Y=e.n,P=e.e,W=e._,E=e.a2,R=e.aG,Z=e.H,G=e.X,B=e.o,J=e.b,V=e.w,F=e.l,$=e.v,X=e.d},e=>{K=e.a,q=e.b,ee=e.c,te=e.s,ae=e.e,ie=e.f,le=e.h,se=e.i,re=e.j,ne=e.k,oe=e.l,ce=e.g,ue=e.m,de=e.n,me=e.o,pe=e.p,ge=e.q,ve=e.r,ye=e.t,xe=e.u,fe=e.v,Me=e.w,he=e.x,be=e.y,we=e.z,ke=e.A},e=>{_e=e._},e=>{Ie=e.c,Ne=e.f,De=e.a,je=e.d,Se=e.h,Ae=e._,ze=e.e,Ce=e.b,Te=e.u,Le=e.r,Oe=e.$,Ue=e.D},e=>{Qe=e._},e=>{He=e._},e=>{Ye=e._},e=>{Pe=e._},e=>{We=e._},e=>{Ee=e.dj,Re=e.aC,Ze=e.dd,Ge=e.dV,Be=e.dR,Je=e.eg,Ve=e._,Fe=e.da,$e=e.bJ,Xe=e.dh,Ke=e.G,qe=e.dP,et=e.dQ,tt=e.bH},e=>{at=e._},e=>{it=e._},e=>{lt=e._},e=>{st=e.a},e=>{rt=e.ar}],execute:function(){var nt=document.createElement("style");nt.textContent='.home-security-file .lastScan-time[data-v-3b66d740],.home-security-file .info-title[data-v-3b66d740]{color:var(--home-risk-file-info-title-color)}.infoList[data-v-3b66d740]{margin-bottom:1.6rem;display:flex;border-radius:.4rem;padding:1.6rem;border:1px solid #efefef}.item-list[data-v-3b66d740]{border-right:1px solid #efefef}.item-list[data-v-3b66d740]:last-child{border-right:none}.loading-icon[data-v-a91fb030]{position:absolute;width:80px;height:80px;animation:spin 1s linear infinite;--un-bg-opacity:0;background-color:rgb(204 204 204 / var(--un-bg-opacity));border-radius:50%;border:2px solid #20a53a;clip-path:inset(0 20%)}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}[data-v-0e08d546] .n-collapse .n-collapse-item .n-collapse-item__header .n-collapse-item__header-main{justify-content:space-between!important}.scrollable[data-v-0e08d546]::-webkit-scrollbar{width:10px}.scrollable[data-v-0e08d546]::-webkit-scrollbar-track{background:#efefef}.scrollable[data-v-0e08d546]::-webkit-scrollbar-thumb{background:#bfbfbf;border-radius:10px}.scrollable[data-v-0e08d546]::-webkit-scrollbar-thumb:hover{background:#555}.risk-chart[data-v-56656608]{padding:2px}.risk-chart .circle-box[data-v-56656608]{position:relative;display:flex;width:110px;height:110px;justify-content:center;align-items:center}.risk-chart .circle-box[data-v-56656608]:before,.risk-chart .circle-box[data-v-56656608]:after,.risk-chart .circle-box .circle-box-bg[data-v-56656608]{position:absolute;top:0;left:0;display:block;width:100%;height:100%;content:""}.risk-chart .circle-box[data-v-56656608]:before{border-radius:56% 56% 52% 54%;opacity:.8;animation:wave-56656608 12s infinite linear}.risk-chart .circle-box[data-v-56656608]:after{border-radius:44% 44% 42% 46%;opacity:.6;animation:wave-56656608 10s infinite linear}.risk-chart .circle-box .circle-box-bg[data-v-56656608]{border-radius:46% 46% 42% 44%;opacity:.4;animation:wave-56656608 8s infinite linear}.risk-chart .circle-box .circle-box-inner[data-v-56656608]{z-index:1;display:flex;width:101px;height:101px;border-radius:70% 60% 60%;flex-direction:column;justify-content:center;align-items:center;background:var(--home-risk-overview-circle-bg)}.risk-chart .circle-box .circle-box-value[data-v-56656608]{display:inline-flex;font-size:32px;line-height:1;align-items:flex-end}.risk-chart .circle-box .circle-box-value .unit[data-v-56656608]{margin-left:4px;font-size:12px;color:#999;transform:translateY(-6px)}.risk-chart .circle-box .circle-box-desc[data-v-56656608]{margin-top:4px}.circle-danger .risk-chart .circle-box[data-v-56656608]:before,.circle-danger .risk-chart .circle-box[data-v-56656608]:after,.circle-danger .risk-chart .circle-box .circle-box-bg[data-v-56656608]{background-color:#ef0808}.circle-danger .risk-chart .circle-box .circle-box-inner[data-v-56656608]{color:#e01616}.circle-warn .risk-chart .circle-box[data-v-56656608]:before,.circle-warn .risk-chart .circle-box[data-v-56656608]:after,.circle-warn .risk-chart .circle-box .circle-box-bg[data-v-56656608]{background-color:#f0ad4e}.circle-warn .risk-chart .circle-box .circle-box-inner[data-v-56656608]{color:#f0ad4e}.circle-alert .risk-chart .circle-box[data-v-56656608]:before,.circle-alert .risk-chart .circle-box[data-v-56656608]:after,.circle-alert .risk-chart .circle-box .circle-box-bg[data-v-56656608]{background-color:#e8d544}.circle-alert .risk-chart .circle-box .circle-box-inner[data-v-56656608]{color:#e8d544}.circle-safe .risk-chart .circle-box[data-v-56656608]:before,.circle-safe .risk-chart .circle-box[data-v-56656608]:after,.circle-safe .risk-chart .circle-box .circle-box-bg[data-v-56656608]{background-color:#20a53a}.circle-safe .risk-chart .circle-box .circle-box-inner[data-v-56656608]{color:#20a53a}@keyframes wave-56656608{0%{transform:rotate(0)}50%{transform:rotate(180deg)}to{transform:rotate(360deg)}}@keyframes rotate-f660504b{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.absolute-center[data-v-f660504b]{position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.scan-icon-img[data-v-f660504b]{position:absolute;left:0;right:0;top:0;bottom:0;z-index:99;margin:auto;width:58px;height:67px;background-position:100%}.icon-img-safe[data-v-f660504b]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl8zN182NDhfMCIgeDE9IjI5LjAwMDAwMCIgeTE9IjAuMDAwMDAwIiB4Mj0iMjkuMDAwMDAwIiB5Mj0iNjcuMDAwMDAwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJCTxzdG9wIHN0b3AtY29sb3I9IiNCMkVFQkQiLz4KCQkJPHN0b3Agb2Zmc2V0PSIwLjk5MDU5MCIgc3RvcC1jb2xvcj0iIzYyREI3QSIgc3RvcC1vcGFjaXR5PSIwLjE3NjQ3MSIvPgoJCTwvbGluZWFyR3JhZGllbnQ+CgkJPGxpbmVhckdyYWRpZW50IGlkPSJwYWludF9saW5lYXJfMzdfNjQ5XzAiIHgxPSIyOS4wMDQxOTgiIHkxPSI3LjczMDcxMyIgeDI9IjI5LjAwNDE5OCIgeTI9IjYwLjEyODE0NyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCQk8c3RvcCBzdG9wLWNvbG9yPSIjOThFM0E3IiBzdG9wLW9wYWNpdHk9IjAuMjIzNTI5Ii8+CgkJCTxzdG9wIG9mZnNldD0iMS4wMDAwMDAiIHN0b3AtY29sb3I9IiM4N0UxOTgiIHN0b3Atb3BhY2l0eT0iMC45MTc2NDciLz4KCQk8L2xpbmVhckdyYWRpZW50PgoJPC9kZWZzPgoJPHBhdGggaWQ9InBhdGgiIGQ9Ik0yOS4xOTcgMEMyMi4zNjc3IDUuMzcyNDQgMTIuNTkyNyAxMC42MzQ5IDAgMTAuNjM0OUwwIDM1Ljg5ODFDMCA0Ny4xNDU4IDE2LjYwNDQgNjcgMjkuMjA0MyA2N0M0MS44MDQ0IDY3IDU4IDQ3LjEzODMgNTggMzUuODk4MUw1OCAxMC42MzQ5QzQ1LjM4NTMgMTAuNjM0OSAzNi4wMjY0IDUuMzcyNDQgMjkuMTk3IDBaTTUyLjAyOTQgMzUuNjQ3NUM1Mi4wMjk0IDQ1LjI4OTQgMzkuNjI1NCA2MC4yOTIyIDI4LjgyNjMgNjAuMjkyMkMxOC4wMiA2MC4yOTIyIDYuMjUzNzggNDUuNDEyNSA2LjI1Mzc4IDM1Ljc3MDVMNi4yNTM3OCAxNS41NTYyQzE3LjA1MjcgMTUuNTU2MiAyMy4zNDU1IDEyLjM1MjIgMjkuMjA0MyA3LjczNzU1QzM1LjA0ODYgMTIuMzM3MiA0MS4yMzA1IDE1LjQ2MTUgNTIuMDI5NCAxNS40NjE1TDUyLjAyOTQgMzUuNjQ3NVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfMzdfNjQ4XzApIiBmaWxsLW9wYWNpdHk9IjAuMzUwMDAwIi8+Cgk8cGF0aCBpZD0icGF0aCIgZD0iTTI5LjEzNDUgNy43MzA3MUMyMy40NTU5IDEyLjg4NDUgMTUuNjYzIDE1LjQ2MTQgNS45NzkgMTUuNDYxNEw2LjM5NzA5IDM2LjUwNjNDNi44MjM0OSA0My44MDc2IDE2LjA4NDQgNjAuMTI4MiAyOC44NDM5IDYwLjEyODJDMzguODA4OCA2MC4xMjgyIDUyLjQ1NTggNDYuMzg0NSA1MS45NzU4IDM0Ljk5MDFMNTIuMDI5NCAxNS40NjE0QzQwLjE0MTggMTUuNDYxNCAzNC4zODY1IDExLjY5NTggMjkuMTM0NSA3LjczMDcxWk00Ni43NzI2IDM0Ljk5QzQ2Ljc3MjYgNDIuMTA2MiAzNy4xNDg0IDUzLjA4ODEgMjguODQzOSA1My4wODgxQzIwLjUzMzcgNTMuMDg4MSAxMS40ODUyIDQyLjEwNjIgMTEuNDg1MiAzNC45OUwxMS40ODUyIDIwLjA3MDlDMTkuNzg5OCAyMC4wNzA5IDI0LjYyODkgMTcuNzA2MiAyOS4xMzQ1IDE0LjMwMDRDMzMuNjI4OSAxNy42OTUxIDM4LjQ3MzYgMjAuMDcwOSA0Ni43NzgzIDIwLjA3MDlMNDYuNzcyNiAzNC45OVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfMzdfNjQ5XzApIiBmaWxsLW9wYWNpdHk9IjAuNDAwMDAwIi8+Cjwvc3ZnPgo=)}.icon-img-danger[data-v-f660504b]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl82NF85M18wIiB4MT0iMjkuMDAwMDAwIiB5MT0iMC4wMDAwMDAiIHgyPSIyOS4wMDAwMDAiIHkyPSI2Ny4wMDAwMDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0ZGQjNCMyIgc3RvcC1vcGFjaXR5PSIwLjkxNzY0NyIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRjc5Njk2IiBzdG9wLW9wYWNpdHk9IjAuMjMxMzczIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl82NF85NF8wIiB4MT0iMjkuMDA0MTk4IiB5MT0iNy43MzA3MTMiIHgyPSIyOS4wMDQxOTgiIHkyPSI2MC4xMjgxNDciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0UzOTg5OCIgc3RvcC1vcGFjaXR5PSIwLjIyMzUyOSIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRkZCM0IzIiBzdG9wLW9wYWNpdHk9IjAuOTE3NjQ3Ii8+CgkJPC9saW5lYXJHcmFkaWVudD4KCTwvZGVmcz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTk3IDBDMjIuMzY3NyA1LjM3MjQ0IDEyLjU5MjcgMTAuNjM0OSAwIDEwLjYzNDlMMCAzNS44OTgxQzAgNDcuMTQ1OCAxNi42MDQ0IDY3IDI5LjIwNDMgNjdDNDEuODA0NCA2NyA1OCA0Ny4xMzgzIDU4IDM1Ljg5ODFMNTggMTAuNjM0OUM0NS4zODUzIDEwLjYzNDkgMzYuMDI2NCA1LjM3MjQ0IDI5LjE5NyAwWk01Mi4wMjk0IDM1LjY0NzVDNTIuMDI5NCA0NS4yODk0IDM5LjYyNTQgNjAuMjkyMiAyOC44MjYzIDYwLjI5MjJDMTguMDIgNjAuMjkyMiA2IDQ1LjY0MiA2IDM2TDYgMTUuNUMxNi43OTkgMTUuNSAyMy4zNDU1IDEyLjM1MjIgMjkuMjA0MyA3LjczNzU1QzM1LjA0ODYgMTIuMzM3MiA0MS4yMzA1IDE1LjQ2MTUgNTIuMDI5NCAxNS40NjE1TDUyLjAyOTQgMzUuNjQ3NVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfNjRfOTNfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNTAwMDAiLz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTM0NSA3LjczMDcxQzIzLjQ1NTkgMTIuODg0NSAxNS42NjMgMTUuNDYxNCA1Ljk3OSAxNS40NjE0TDUuOTc5IDM2LjVDNi40MDU1MiA0My44MDEzIDE2LjA4NDQgNjAuMTI4MiAyOC44NDM5IDYwLjEyODJDMzguODA4OCA2MC4xMjgyIDUyLjQ1NTggNDYuMzg0NSA1MS45NzU4IDM0Ljk5MDFMNTIuMDI5NCAxNS40NjE0QzQwLjE0MTggMTUuNDYxNCAzNC4zODY1IDExLjY5NTggMjkuMTM0NSA3LjczMDcxWk00Ni43NzI2IDM0Ljk5QzQ2Ljc3MjYgNDIuMTA2MiAzNy4xNDg0IDUzLjA4ODEgMjguODQzOSA1My4wODgxQzIwLjUzMzcgNTMuMDg4MSAxMS40ODUyIDQyLjEwNjIgMTEuNDg1MiAzNC45OUwxMS40ODUyIDIwLjA3MDlDMTkuNzg5OCAyMC4wNzA5IDI0LjYyODkgMTcuNzA2MiAyOS4xMzQ1IDE0LjMwMDRDMzMuNjI4OSAxNy42OTUxIDM4LjQ3MzYgMjAuMDcwOSA0Ni43NzgzIDIwLjA3MDlMNDYuNzcyNiAzNC45OVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfNjRfOTRfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNDAwMDAiLz4KPC9zdmc+Cg==)}.icon-img-warn[data-v-f660504b]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl83Nl81Nl8wIiB4MT0iMjkuMDAwMDAwIiB5MT0iMC4wMDAwMDAiIHgyPSIyOS4wMDAwMDAiIHkyPSI2Ny4wMDAwMDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0YwQUQ0RSIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRkNGMERGIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl83Nl81N18wIiB4MT0iMjkuMDA0NTcyIiB5MT0iNy41MDAwMDAiIHgyPSIyOS4wMDQ1NzIiIHkyPSI2MC4zOTc0MzQiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KCQkJPHN0b3Agc3RvcC1jb2xvcj0iI0ZDRjBERiIvPgoJCQk8c3RvcCBvZmZzZXQ9IjEuMDAwMDAwIiBzdG9wLWNvbG9yPSIjRjBBRDRFIi8+CgkJPC9saW5lYXJHcmFkaWVudD4KCTwvZGVmcz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTk3IDBDMjIuMzY3NyA1LjM3MjQ0IDEyLjU5MjcgMTAuNjM0OSAwIDEwLjYzNDlMMCAzNS44OTgxQzAgNDcuMTQ1OCAxNi42MDQ0IDY3IDI5LjIwNDMgNjdDNDEuODA0NCA2NyA1OCA0Ny4xMzgzIDU4IDM1Ljg5ODFMNTggMTAuNjM0OUM0NS4zODUzIDEwLjYzNDkgMzYuMDI2NCA1LjM3MjQ0IDI5LjE5NyAwWk01Mi4wMjk0IDM1LjY0NzVDNTIuMDI5NCA0NS4yODk0IDM5LjYyNTQgNjAuMjkyMiAyOC44MjYzIDYwLjI5MjJDMTguMDIgNjAuMjkyMiA2IDQ1LjY0MiA2IDM2TDYgMTUuNUMxNi43OTkgMTUuNSAyMy4zNDU1IDEyLjM1MjIgMjkuMjA0MyA3LjczNzU1QzM1LjA0ODYgMTIuMzM3MiA0MS4yMzA1IDE1LjQ2MTUgNTIuMDI5NCAxNS40NjE1TDUyLjAyOTQgMzUuNjQ3NVoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0idXJsKCNwYWludF9saW5lYXJfNzZfNTZfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNTAwMDAiLz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTU1NSA3LjVDMjMuNDc2OSAxMi42NTM4IDE1LjY4NCAxNS41IDYgMTUuNUw2IDM2Ljc2OTNDNi40MjY1MSA0NC4wNzA2IDE2LjEwNTMgNjAuMzk3NSAyOC44NjQ5IDYwLjM5NzVDMzguODI5OCA2MC4zOTc1IDUyLjQ3NjggNDYuNjUzOCA1MS45OTY4IDM1LjI1OTRMNTEuOTk2OCAxNS41QzQwLjEwOTMgMTUuNSAzNC40MDc1IDExLjQ2NTEgMjkuMTU1NSA3LjVaTTQ2Ljc5MzYgMzUuMjU5M0M0Ni43OTM2IDQyLjM3NTUgMzcuMTY5NCA1My4zNTc0IDI4Ljg2NDkgNTMuMzU3NEMyMC41NTQ3IDUzLjM1NzQgMTEuNTA2MiA0Mi4zNzU1IDExLjUwNjIgMzUuMjU5M0wxMS41MDYyIDIwLjM0MDJDMTkuODEwOCAyMC4zNDAyIDI0LjY0OTkgMTcuOTc1NSAyOS4xNTU1IDE0LjU2OTdDMzMuNjQ5OSAxNy45NjQ0IDM4LjQ5NDYgMjAuMzQwMiA0Ni43OTkzIDIwLjM0MDJMNDYuNzkzNiAzNS4yNTkzWiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSJ1cmwoI3BhaW50X2xpbmVhcl83Nl81N18wKSIgZmlsbC1vcGFjaXR5PSIwLjM0MDAwMCIvPgo8L3N2Zz4K)}.icon-img-low-risk[data-v-f660504b]{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTguMDAwMDAwIiBoZWlnaHQ9IjY3LjAwMDAwMCIgdmlld0JveD0iMCAwIDU4IDY3IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KCTxkZXNjPgoJCQlDcmVhdGVkIHdpdGggUGl4c28uCgk8L2Rlc2M+Cgk8ZGVmcz4KCQk8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50X2xpbmVhcl82NF8yNDNfMCIgeDE9IjI5LjAwMDAwMCIgeTE9IjAuMDAwMDAwIiB4Mj0iMjkuMDAwMDAwIiB5Mj0iNjcuMDAwMDAwIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CgkJCTxzdG9wIHN0b3AtY29sb3I9IiNFOEQ1NDQiLz4KCQkJPHN0b3Agb2Zmc2V0PSIxLjAwMDAwMCIgc3RvcC1jb2xvcj0iI0ZGRUY3OSIgc3RvcC1vcGFjaXR5PSIwLjI3MDU4OCIvPgoJCTwvbGluZWFyR3JhZGllbnQ+CgkJPGxpbmVhckdyYWRpZW50IGlkPSJwYWludF9saW5lYXJfNjRfMjQ0XzAiIHgxPSIyOS4wMDQ1NzIiIHkxPSI3LjUwMDAwMCIgeDI9IjI5LjAwNDU3MiIgeTI9IjYwLjM5NzQzNCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgoJCQk8c3RvcCBzdG9wLWNvbG9yPSIjRkZFRjc5IiBzdG9wLW9wYWNpdHk9IjAuMTA5ODA0Ii8+CgkJCTxzdG9wIG9mZnNldD0iMS4wMDAwMDAiIHN0b3AtY29sb3I9IiNFOEQ1NDQiLz4KCQk8L2xpbmVhckdyYWRpZW50PgoJPC9kZWZzPgoJPHBhdGggaWQ9InBhdGgiIGQ9Ik0yOS4xOTcgMEMyMi4zNjc3IDUuMzcyNDQgMTIuNTkyNyAxMC42MzQ5IDAgMTAuNjM0OUwwIDM1Ljg5ODFDMCA0Ny4xNDU4IDE2LjYwNDQgNjcgMjkuMjA0MyA2N0M0MS44MDQ0IDY3IDU4IDQ3LjEzODMgNTggMzUuODk4MUw1OCAxMC42MzQ5QzQ1LjM4NTMgMTAuNjM0OSAzNi4wMjY0IDUuMzcyNDQgMjkuMTk3IDBaTTUyLjAyOTQgMzUuNjQ3NUM1Mi4wMjk0IDQ1LjI4OTQgMzkuNjI1NCA2MC4yOTIyIDI4LjgyNjMgNjAuMjkyMkMxOC4wMiA2MC4yOTIyIDYgNDUuNjQyIDYgMzZMNiAxNS41QzE2Ljc5OSAxNS41IDIzLjM0NTUgMTIuMzUyMiAyOS4yMDQzIDcuNzM3NTVDMzUuMDQ4NiAxMi4zMzcyIDQxLjIzMDUgMTUuNDYxNSA1Mi4wMjk0IDE1LjQ2MTVMNTIuMDI5NCAzNS42NDc1WiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSJ1cmwoI3BhaW50X2xpbmVhcl82NF8yNDNfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNTAwMDAiLz4KCTxwYXRoIGlkPSJwYXRoIiBkPSJNMjkuMTU1NSA3LjVDMjMuNDc2OSAxMi42NTM4IDE1LjY4NCAxNS41IDYgMTUuNUw2IDM2Ljc2OTNDNi40MjY1MSA0NC4wNzA2IDE2LjEwNTMgNjAuMzk3NSAyOC44NjQ5IDYwLjM5NzVDMzguODI5OCA2MC4zOTc1IDUyLjQ3NjggNDYuNjUzOCA1MS45OTY4IDM1LjI1OTRMNTEuOTk2OCAxNS41QzQwLjEwOTMgMTUuNSAzNC40MDc1IDExLjQ2NTEgMjkuMTU1NSA3LjVaTTQ2Ljc5MzYgMzUuMjU5M0M0Ni43OTM2IDQyLjM3NTUgMzcuMTY5NCA1My4zNTc0IDI4Ljg2NDkgNTMuMzU3NEMyMC41NTQ3IDUzLjM1NzQgMTEuNTA2MiA0Mi4zNzU1IDExLjUwNjIgMzUuMjU5M0wxMS41MDYyIDIwLjM0MDJDMTkuODEwOCAyMC4zNDAyIDI0LjY0OTkgMTcuOTc1NSAyOS4xNTU1IDE0LjU2OTdDMzMuNjQ5OSAxNy45NjQ0IDM4LjQ5NDYgMjAuMzQwMiA0Ni43OTkzIDIwLjM0MDJMNDYuNzkzNiAzNS4yNTkzWiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSJ1cmwoI3BhaW50X2xpbmVhcl82NF8yNDRfMCkiIGZpbGwtb3BhY2l0eT0iMC4zNDAwMDAiLz4KPC9zdmc+Cg==)}.scan-icon-img-bg[data-v-f660504b]{position:absolute;left:0;right:0;top:0;bottom:0;z-index:50;margin:auto;display:inline-block;width:100px;height:100px;border-radius:100%;background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(122,227,142,.2))}.animate-box[data-v-f660504b]{position:relative;width:100px;height:100px;animation:rotate-f660504b 3s linear infinite}.animate-box-left[data-v-f660504b]{z-index:55;width:50px;height:100px;border-radius:50px 0 0 50px}.animate-box-right[data-v-f660504b]{position:absolute;left:50%;z-index:55;height:100px;--un-bg-opacity:1;background-color:rgb(255 255 255 / var(--un-bg-opacity));border-radius:0 50px 50px 0}.animate-box-bottom[data-v-f660504b]{position:absolute;top:.4rem;left:.4rem;z-index:2;width:92px;height:92px;border-radius:50%;background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(122,227,142,.2))}.circle-inner[data-v-f660504b]{background:var(--color-bg-2);position:absolute;left:0;top:0;bottom:0;right:0;z-index:55;margin:auto;display:inline-block;width:96px;height:96px;border-radius:100%}.circle-outer[data-v-f660504b]{position:absolute;left:0;top:0;bottom:0;right:0;z-index:55;margin:auto;width:100px;height:100px;border-radius:100%}.linear-safe[data-v-f660504b]{background:linear-gradient(#20a53a,#fff)}.linear-danger[data-v-f660504b]{background:linear-gradient(#ef0808,#fff)}.linear-warn[data-v-f660504b]{background:linear-gradient(#f0ad4e,#fff)}.linear-risk[data-v-f660504b]{background:linear-gradient(#e8d544,#fff)}.safe[data-v-f660504b]{background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(122,227,142,.2))}.danger[data-v-f660504b]{background:radial-gradient(50% 50% at 50% 50%,rgba(255,255,255,.2) 54.962%,rgba(255,0,0,.2))}.risk[data-v-f660504b]{background:radial-gradient(50% 50% at 50% 50%,rgba(240,173,78,0) 58.015%,rgba(232,213,68,.2))}.warn[data-v-f660504b]{background:radial-gradient(50% 50% at 50% 50%,rgba(240,173,78,0) 58.015%,rgba(240,173,78,.2))}.box-text[data-v-f660504b]{position:absolute;left:0;right:0;top:0;bottom:0;z-index:99;margin:auto;width:78px;height:50px;display:flex;align-items:center;justify-content:center;font-size:3.2rem;font-weight:700;line-height:4.5rem}.box-text span[data-v-f660504b]{margin-top:16px;font-size:1.8rem}.risk-spin[data-v-a3822d9f]{background:var(--home-risk-security-list-spin-bg)}.module-list[data-v-a3822d9f]::-webkit-scrollbar{width:10px;height:5px}.module-list[data-v-a3822d9f]::-webkit-scrollbar-thumb{box-shadow:inset 0 0 .5rem rgba(0,0,0,.2);background-color:#999}.module-item[data-v-a3822d9f]{font-size:1.25rem}.module-head[data-v-a3822d9f]{border-bottom:1px solid #ececec;color:#555;transition:background .3s}.module-head[data-v-a3822d9f]:nth-child(1){border-top:1px solid #ececec}.module-head[data-v-a3822d9f]:hover{background-color:var(--home-risk-security-list-hover-bg)}.module-body[data-v-a3822d9f]{border-bottom-width:1px;--un-border-opacity:1;border-color:rgb(236 236 236 / var(--un-border-opacity));padding:1rem 1.5rem 1rem 2.5rem;color:var(--color-text-2)}.collapse-item[data-v-a3822d9f]{color:var(--home-risk-security-list-collapse-item-color);background:var(--color-bg-2);width:48rem;border-radius:2px;font-size:1.2rem;margin-left:1rem;border-width:1px;--un-border-opacity:1;border-color:rgb(235 238 245 / var(--un-border-opacity));padding:.6rem 1.6rem;display:flex;align-items:center;line-height:1.8rem}.n-progress.n-progress--circle[data-v-0a5f55f9],.n-progress.n-progress--dashboard[data-v-0a5f55f9]{width:100px!important}.progress-header[data-v-0a5f55f9]{display:flex;align-items:center;height:140px;padding:20px;text-align:center}.progresscircle[data-v-0a5f55f9]{position:absolute;top:8px;left:25px}.progresscircle p[data-v-0a5f55f9]{padding:5px 0;font-size:13px;font-weight:700}.progresscirclebar[data-v-0a5f55f9]{position:relative;width:100px;height:100px;line-height:100px;font-size:18px}.progresscirclebar span[data-v-0a5f55f9]:nth-child(1){font-size:24px}.progresscirclebar.active svg[data-v-0a5f55f9]{-webkit-animation:load8 1.1s infinite linear;animation:load8 1.1s infinite linear}.progress-header-cot[data-v-0a5f55f9]:nth-child(1),.progress-header-cot[data-v-0a5f55f9]:nth-child(3){min-width:100px;position:relative}.progress-header-cot[data-v-0a5f55f9]:nth-child(3){display:flex}.progress-header-cot[data-v-0a5f55f9]:nth-child(2){width:100%;padding:0 40px}.progress-header-cot button.cancel_detect[data-v-0a5f55f9]{border-color:#999;color:#666;background-color:#fff;font-size:15px}.progress-header-cot button.cancel_detect[data-v-0a5f55f9]:hover{color:#fc6d26;background:rgba(252,109,38,.1);border-color:rgba(252,109,38,.2)}.scanning-progress-title[data-v-0a5f55f9]{text-align:left;font-weight:700;margin:15px 0;font-size:20px}.scanning-progress-title img[data-v-0a5f55f9]{margin-right:10px;vertical-align:sub;width:24px}.scanning-progress-title span[data-v-0a5f55f9]{color:#fc6d26}.scanning-progress-cont[data-v-0a5f55f9]{text-align:left;margin:15px 0;font-size:14px}.progress_item[data-v-9466c95d]{margin:0 20px 6px;padding:0 20px;background-color:var(--home-risk-server-list-bg);border-radius:4px;border:1px solid transparent}.progress_item_header[data-v-9466c95d]{height:30px;line-height:30px;display:flex;justify-content:space-between;border-radius:4px;cursor:pointer;font-size:12px;color:var(--home-risk-server-list-text)}.progress_item_header .progress_type[data-v-9466c95d]{display:flex;align-items:center;width:59.5%;font-weight:700;line-height:22px}.progress_item_header .progress_type .title-icon[data-v-9466c95d]{width:14px;margin-right:6px}.progress_item_header .progress_status[data-v-9466c95d]{flex:1}.progress-cont-list[data-v-9466c95d]{overflow:auto;max-height:390px}.progress_item_body[data-v-9466c95d]{line-height:30px;display:none;font-size:12px}.progress_item.active .progress_item_body[data-v-9466c95d]{display:block}.progress_item_info[data-v-9466c95d]{margin-bottom:6px}.progress_item_info .info_cont[data-v-9466c95d]{display:flex;color:#666;padding:0 30px}.progress_item_info .info_cont div[data-v-9466c95d]:nth-child(1){width:60%}.progress_item_info .info_cont div[data-v-9466c95d]:nth-child(2){width:40%}.progress_item_info .info_cont div:nth-child(2) span[data-v-9466c95d]{font-weight:600}.progress_item_info.active[data-v-9466c95d]{background-color:rgba(252,109,38,.1);padding:0}.progress_item_info.active .info_cont[data-v-9466c95d]{margin:0 20px;padding:0 10px;border-bottom:1px dashed #d9d9d9}.progress_item_info.active .info_cont_desc[data-v-9466c95d]{color:#888;border-radius:4px;padding:0 30px}.progress_item_info.active[data-v-9466c95d]:hover{background-color:rgba(252,109,38,.2)}.progress_item_info[data-v-9466c95d]:hover{background-color:var(--home-risk-server-list-hover)}.btn_red[data-v-9466c95d]{font-weight:700;margin-left:5px;padding:1px 5px;text-align:center;border-radius:3px;color:#fff;background:red}[data-v-9466c95d] .n-progress__text{font-size:16px!important;font-weight:700}.scrollable[data-v-9466c95d]::-webkit-scrollbar{width:10px}.scrollable[data-v-9466c95d]::-webkit-scrollbar-track{background:#efefef}.scrollable[data-v-9466c95d]::-webkit-scrollbar-thumb{background:#bfbfbf;border-radius:10px}.scrollable[data-v-9466c95d]::-webkit-scrollbar-thumb:hover{background:#555}\n/*$vite$:1*/',document.head.appendChild(nt);const ot=e("a",M("home-security",()=>{const e=h("overview"),t=h({score:85,scoreLevel:"Good",riskNum:3,subtitle:"The overall security status of the system is good. It is recommended to check the security configuration regularly."}),a=h({day:1,time:"--",virus:"--"}),l=h({risk_scan:{status:!1,icon:"home-risk",name:"Risk Scan"},safe_detect:{status:!1,icon:"home-safeDetect",name:"Safety Testing"},file_detection:{status:!1,icon:"home-ware",name:"Malicious file detection"},vul_scan:{status:!1,icon:"home-web",name:"Vulnerability Scanning"},tamper:{status:!1,icon:"home-tamper",name:"Tamper-proof"}}),s=h([{title:"Bug",type:"loophole",tips:"Timely discovery of vulnerabilities in the website and timely upgrade of the version can prevent hackers from taking advantage of the situation.",value:0},{title:"Malicious files",type:"file",tips:"Detection of malicious files (such as viruses, Trojans) that may steal information or damage the system",value:0},{title:"Risk",type:"risk",tips:"Conduct comprehensive inspections on websites/panel/systems to eliminate hidden risks",value:0},{title:"Baseline issues",type:"server",tips:"Check whether the server configuration meets security standards",value:0},{title:"Tamper-proof",type:"tamper",tips:"Tamper-proof for Enterprise：Real-time protection to see if web page content is illegally modified",value:0}]);return{menu:e,scoreData:t,safe:a,capabilitySwitch:l,risk_details:s,getSafeOverviewData:async()=>{const{message:e}=await K();if(i(e)){const{security_status:i,risk_details:r}=e;t.value.score=e.score,t.value.scoreLevel=e.level,t.value.riskNum=e.risk_count,t.value.subtitle=e.level_description,a.value.day=e.protect_days,a.value.time=e.risk_scan_time.slice(0,10)||"-",a.value.virus=e.virus_update_time.slice(0,10)||"-",l.value.risk_scan.status=i.risk_scan,l.value.safe_detect.status=i.safe_detect,l.value.file_detection.status=i.file_detection,l.value.vul_scan.status=i.vul_scan,l.value.tamper.status=i.tamper,s.value[0].value=r.vul_scan.total||0,s.value[1].value=r.file_detection.total||0,s.value[2].value=r.homepage_risk.total||0,s.value[3].value=r.safe_detect.total||0,s.value[4].value=r.tamper.total||0}}}})),ct=ot(),{risk_details:ut}=b(ct),dt=w({props:{value:{type:Number,required:!0},iconName:{type:String,required:!0}},setup:e=>()=>k(_,null,[k(l,{size:32,name:e.iconName},null),e.value>0?k("div",{class:"absolute top-15px right-20px bg-red-500 text-white rounded-full px-2 py-1 text-xs"},[e.value]):""])}),mt=e=>ut.value.find(t=>t.type===e)?.value||0,pt=e("r",e=>{switch(e){case 1:return{text:"Medium",style:"color: #FF9900"};case 2:return{text:"High",style:"color: #FF0000"};case 3:return{text:"Urgent",style:"color: #ba281e"};default:return{text:"--",style:"color: #000000"}}}),gt=M("home-security-file",()=>{const e=h({status:!1,isHasMounts:!1}),t=h(!1),a=h(!1),l=h("--"),s=h([{title:"Total Scanned",value:0,style:"color: var(--home-risk-file-info-item-color)"},{title:"High risk",value:0,style:"color: #F50606;",id:2},{title:"Moderate",value:0,style:"color: #FF9900",id:1},{title:"Low risk",value:0,style:"color: #DDC400",id:0}]),r=h([]),n=h([]);return{lastScanTime:l,riskLevelsOverview:s,dynamicKill:t,autoIntercept:a,ossConfig:e,monitorPath:r,excludePath:n,getConfig:async()=>{const{message:l}=await q();if(i(l)){const i=l.data;a.value=i.quarantine,t.value=i.dynamic_detection,e.value={status:i.scan_oss,isHasMounts:i.has_oss_mounts},r.value=i.monitor_dirs.map(e=>({path:e})),n.value=i.exclude_dirs.map(e=>({path:e}))}}}}),vt={class:"home-security-file"},yt={class:"text-right lastScan-time mb-2"},xt={class:"infoList"},ft={class:"text-[1.2rem] info-title mb-[1.6rem]"},Mt=w({__name:"file-info",setup(e){const t=gt(),{lastScanTime:a,riskLevelsOverview:i}=b(t);return(e,t)=>(N(),I("div",vt,[D("div",yt,j(e.$t("Home.Security.index_9"))+"："+j(S(a)),1),D("div",xt,[(N(!0),I(_,null,A(S(i),e=>(N(),I("div",{class:"flex-1 text-center item-list",key:e.title},[D("div",ft,j(e.title),1),D("div",{class:"text-[2.4rem]",style:z(e.style)},j(e.value),5)]))),128))])]))}}),ht=s(Mt,[["__scopeId","data-v-3b66d740"]]),bt={class:"p-20px h-full"},wt={class:"relative"},kt={class:"flex items-center absolute right-0 top-0"},_t={class:"mr-[.8rem]"},It={key:0},Nt={key:1},Dt=w({__name:"file-advanced",setup(e){const{t:t}=C(),a=gt(),{autoIntercept:i,dynamicKill:l,monitorPath:s,excludePath:n}=b(a),o=h("monitor"),c=[{key:"monitor",label:"Monitor Directory"},{key:"exclude",label:"Exclude Directory"},{key:"ignore",label:"Ignore File"}],u=h(""),{keys:d,table:m,columns:p}=Ie([{title:t("Site.DelSite.index_2"),key:"path",width:200},Ne({width:100,options:e=>[{label:t("Public.Btn.Del"),onClick:async()=>{if("ignore"===o.value)return await ee({md5:e.md5}),void w();De({title:"ignore"===o.value?t("Public.Btn.Cancel"):t("Public.Btn.Del"),content:`Are you sure you want to delete this path? [${e.path}]`,onConfirm:async()=>{const t="monitor"===o.value;await te({[t?"delete_monitor_path":"delete_exclude_path"]:e.path}),await a.getConfig(),m.data=t?s.value:n.value}})}}]})]),g=T(()=>{const e=p.value;if("ignore"===o.value){const[a,...i]=e;return[a,{title:"MD5",key:"md5"},{title:t("Config.Safe.index_152"),key:"time",width:150},...i]}return e}),v=async e=>{const a=e?"Whether to enable automatic isolation (not recommended), this feature will have a probability of isolating normal files.":"Whether dynamic detection is turned off, this feature will make it possible to isolate normal files.";De({title:t("Home.Security.index_25"),content:a,onConfirm:async()=>{await te({quarantine:e,dynamic_detection:l.value}),i.value=e}})},y=async()=>{const e="monitor"===o.value;await te({[e?"add_monitor_path":"add_exclude_path"]:u.value}),await a.getConfig(),u.value="",m.data=e?s.value:n.value},x=async e=>{o.value=e,"monitor"===e?m.data=s.value:"exclude"===e?m.data=n.value:await w()},{loading:f,setLoading:M}=je(),w=async()=>{try{M(!0);const{message:e}=await ae();r(e)&&(m.data=e.map(e=>({path:e.filepath,md5:e.md5_to_add,time:e.timestamp})))}finally{M(!1)}};return(async()=>{m.data=s.value})(),(e,t)=>{const a=We,l=Ee,s=Pe,r=Re,n=Se,p=Qe,M=Ae;return N(),I("div",bt,[D("div",wt,[k(a,{value:S(o),"onUpdate:value":[t[0]||(t[0]=e=>L(o)?o.value=e:null),x],options:c},null,8,["value"]),D("div",kt,[D("span",_t,j(e.$t("Home.Security.index_25")),1),k(l,{value:S(i),size:"small","onUpdate:value":v},null,8,["value"])])]),k(p,null,O({table:U(()=>[k(n,{keys:S(d),"onUpdate:keys":t[2]||(t[2]=e=>L(d)?d.value=e:null),"row-key":"path",data:S(m).data,columns:S(g),"max-height":300,loading:S(f)},null,8,["keys","data","columns","loading"])]),_:2},["ignore"!==S(o)?{name:"toolsLeft",fn:U(()=>[k(s,{class:"w-[350px]",value:S(u),"onUpdate:value":t[1]||(t[1]=e=>L(u)?u.value=e:null),placeholder:e.$t("Site.Placeholder.Index_5")},null,8,["value","placeholder"]),k(r,{type:"primary",onClick:y},{default:U(()=>[Q(j(e.$t("Public.Btn.Add")),1)]),_:1})]),key:"0"}:void 0]),1024),k(M,{class:"mt-16px"},{default:U(()=>["ignore"!==S(o)?(N(),I("li",It,"Avoid adding full disk path monitoring, such as /")):H("",!0),"ignore"===S(o)?(N(),I("li",Nt,"Ignore items will be matched based on the md5 value of the file, and identical files will be ignored")):H("",!0)]),_:1})])}}}),jt={class:"flex items-center"},St={class:"flex items-center"},At={class:"mr-[.8rem]"},zt=w({__name:"file-switch",setup(e){const{t:t}=C(),a=gt(),{dynamicKill:i,autoIntercept:l,ossConfig:s}=b(a),r=ze(t("Config.Alarm.index_21")),n=async e=>{const a=t(e?"Home.Security.index_28":"Home.Security.index_29"),s=t(e?"Home.Security.index_30":"Home.Security.index_31");De({title:a,content:s,onConfirm:async()=>{await te({quarantine:l.value,dynamic_detection:e}),i.value=e}})};return(async()=>{await a.getConfig()})(),(e,t)=>{const a=Ee,l=Re,s=_e;return N(),I("div",jt,[H("",!0),H("",!0),k(l,{size:"small",onClick:t[0]||(t[0]=e=>S(r).show=!0)},{default:U(()=>t[3]||(t[3]=[Q("Advanced Settings",-1)])),_:1,__:[3]}),t[4]||(t[4]=D("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),D("div",St,[D("span",At,j(e.$t("Home.Security.index_26")),1),k(a,{value:S(i),size:"small","onUpdate:value":n},null,8,["value"])]),k(s,{show:S(r).show,"onUpdate:show":t[1]||(t[1]=e=>S(r).show=e),title:S(r).title,data:S(r).data,width:800,"min-height":500,footer:!1,component:Dt},null,8,["show","title","data"])])}}}),Ct={class:"p-16px"},Tt=w({__name:"file-ignore-result",props:{data:{}},setup(e){const{t:t}=C(),a=e,{table:i,columns:l}=Ie([{key:"filepath",title:t("Site.TableRow.index_2"),width:"70%"},{key:"success",title:t("Public.Table.Status"),render:e=>k("span",{class:e.success?"text-primary":"text-error"},[Q(" "),e.success?t("Site.PHP.index_35"):t("Mail.Mass.index_7"),Q(" ")])}]);return Y(()=>{i.data=a.data.message}),(e,t)=>{const a=Se;return N(),I("div",Ct,[k(a,{data:S(i).data,columns:S(l),"max-height":200},null,8,["data","columns"])])}}}),Lt=w({__name:"file-list",setup(e){const a=W(()=>c(()=>t.import("./file-detail-legacy.js?v=1760428868419"),void 0)),{t:l}=C(),s=gt(),u=n(),d=ot(),{risk_details:m}=b(d),{riskLevelsOverview:p,lastScanTime:g}=b(s),v=ze(),y=P({p:1,limit:30,day:""}),x=[{label:l("Home.Security.index_12"),value:""},{label:l("Home.Security.index_13"),value:1},{label:l("Home.Security.index_14"),value:7},{label:l("Home.Security.index_15"),value:30}],{keys:f,table:M,columns:h}=Ie([{type:"selection"},{title:l("Component.SelectPath.index_3"),key:"filename",ellipsis:{tooltip:{width:"trigger"}}},{title:l("Home.Security.index_1"),key:"threat_type",width:86,render:e=>k(Ze,{type:"info"},{default:()=>[e.threat_type]})},{title:"MD5",key:"md5",ellipsis:{tooltip:{width:"trigger"}}},{title:l("Account.Logs.logsState-131428-1"),key:"risk_level_desc",width:80,render:e=>{let t=p.value.find(t=>t.id===e.risk_level)?.style;return k("span",{style:t},[Q(" "),e.risk_level_desc,Q(" ")])}},{title:l("Home.Security.index_16"),key:"time",width:140},Ne({width:160,options:e=>[{label:l("Ftp.Table.index_8"),onClick:()=>{De({title:"Ignore malicious file",content:`Are you sure you want to ignore this malicious file? [${e.filename}]`,onConfirm:async()=>{const{filepath:t,md5:a}=e,{message:i}=await ie({files:JSON.stringify([{filepath:t,md5:a}])});r(i)&&(i[0].success?o.success(l("Home.Security.index_20")):o.error(i[0].message)),A()}})}},{label:l("Home.Security.index_17"),onClick:()=>{u.isFree?Ce({source:399}):De({title:l("Home.Security.index_18"),content:l("Home.Security.index_19"),onConfirm:async()=>{await le({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"},!1),o.success(l("Home.Security.index_20")),A()}})}},{label:l("Security.Anti.Index_21"),onClick:()=>{v.data=e,v.title=`[${e.filename}] ${l("Home.Security.index_21")}`,v.show=!0}}]})]),w=[{key:"delete",type:"confirm",label:l("Home.Security.index_17"),confirm:{title:l("Crontab.Planned.index_16",[l("Home.Security.index_22")]),desc:l("Crontab.Planned.index_17",[l("Home.Security.index_22")]),columns:[h.value[1]],api:e=>le({file_list:JSON.stringify([{filepath:e.filepath,md5:e.md5}]),action_type:"delete"},!1),done:async()=>{await A(),f.value=[]}}},{key:"ignore",label:l("Ftp.Table.index_8"),onBatch:e=>{De({title:l("Ftp.Table.index_8"),content:"Are you sure you want to ignore these malicious files?",onConfirm:async()=>{const{message:t}=await ie({files:JSON.stringify(e.map(e=>({filepath:e.filepath,md5:e.md5})))});r(t)&&Te({title:l("Public.Table.Result"),width:480,data:{message:t},component:Tt}),f.value=[],A()}})}}],_=e=>{y.day=e,M.data=[],A()},A=async()=>{try{M.loading=!0;const{message:e}=await se({day:y.day?y.day:null,p:y.p,limit:y.limit});if(i(e)){M.data=e.detected.map((e,t)=>({...e,keyid:t})),m.value[1].value=e.total_detected,g.value=e.last_scan_time;const{total_scanned_files:t,risk_stats:a}=e;p.value[0].value=t,p.value[1].value=a[2],p.value[2].value=a[1],p.value[3].value=a[0],M.total=e.total_detected}}finally{M.loading=!1}};return A(),(e,t)=>{const i=Ge,l=Se,s=Ye,r=He,n=Qe,o=Ae,c=_e;return N(),I("div",null,[k(n,null,{toolsLeft:U(()=>[k(i,{value:S(y).day,"onUpdate:value":[t[0]||(t[0]=e=>S(y).day=e),_],options:x,class:"mr-[1rem] !w-[12rem]"},null,8,["value"])]),toolsRight:U(()=>[k(zt)]),table:U(()=>[k(l,{"loading-num":3,"checked-row-keys":S(f),"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>L(f)?f.value=e:null),"row-key":"keyid",loading:S(M).loading,data:S(M).data,columns:S(h),"max-height":"220px"},null,8,["checked-row-keys","loading","data","columns"])]),pageLeft:U(()=>[k(s,{"checked-row-keys":S(f),"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>L(f)?f.value=e:null),"row-key":"keyid",data:S(M).data,options:w},null,8,["checked-row-keys","data"])]),pageRight:U(()=>[k(r,{"show-size-picker":!1,"show-quick-jumper":!1,page:S(y).p,"onUpdate:page":t[3]||(t[3]=e=>S(y).p=e),"page-size":S(y).limit,"onUpdate:pageSize":t[4]||(t[4]=e=>S(y).limit=e),"item-count":S(M).total,onRefresh:A},null,8,["page","page-size","item-count"])]),_:1}),k(o,{class:"mt-16px"},{default:U(()=>[D("li",null,j(e.$t("Home.Security.index_10")),1),H("",!0)]),_:1}),k(c,{show:S(v).show,"onUpdate:show":t[5]||(t[5]=e=>S(v).show=e),title:S(v).title,data:S(v).data,width:500,"min-height":400,footer:!1,component:S(a)},null,8,["show","title","data","component"])])}}}),Ot={class:"text-20px"},Ut=w({__name:"index",setup:e=>(e,t)=>(N(),I(_,null,[D("div",Ot,j(e.$t("Home.Security.index_32")),1),k(ht),k(Lt)],64))}),Qt={class:"text-20px"},Ht={class:"w-250px"},Yt=w({__name:"index",setup(e){const{t:t}=C(),a=h(null),l=P({status:!0,type:[],method:[]}),s={type:{trigger:"change",type:"array",required:!0,message:t("Home.Security.index_36")},method:{trigger:"change",type:"array",required:!0,message:t("Config.Safe.index_7")}},r=()=>({status:l.status,safe_type:l.type.join(","),sender:l.method.join(",")}),n=async()=>{await(a.value?.validate()),await re(r()),r()},{loading:o,setLoading:c}=je();return(async()=>{try{c(!0);const{message:e}=await q();if(i(e)){const t=e.data;l.status=t.alertable.status,l.method=t.alertable.sender,l.type=t.alertable.safe_type}}finally{c(!1)}})(),(e,t)=>{const i=Ee,r=Be,c=Ve,d=Je,m=it,p=Re,g=at,v=u;return N(),E(v,{show:S(o)},{default:U(()=>[D("div",Qt,j(e.$t("Home.Security.index_33")),1),k(g,{class:"p-16px",ref_key:"formRef",ref:a,model:S(l),rules:s},{default:U(()=>[k(r,{label:e.$t("Home.Security.index_34")},{default:U(()=>[k(i,{value:S(l).status,"onUpdate:value":t[0]||(t[0]=e=>S(l).status=e)},null,8,["value"])]),_:1},8,["label"]),k(r,{label:e.$t("Docker.App.Backup.index_5"),path:"type"},{default:U(()=>[k(d,{value:S(l).type,"onUpdate:value":t[1]||(t[1]=e=>S(l).type=e)},{default:U(()=>[k(c,{value:"webshell",label:e.$t("Home.Security.index_35")},null,8,["label"])]),_:1},8,["value"])]),_:1},8,["label"]),k(r,{label:e.$t("Config.Safe.index_6"),path:"method"},{default:U(()=>[D("div",Ht,[k(m,{value:S(l).method,"onUpdate:value":t[2]||(t[2]=e=>S(l).method=e)},null,8,["value"])])]),_:1},8,["label"]),k(r,{label:" "},{default:U(()=>[k(p,{type:"primary",onClick:n},{default:U(()=>[Q(j(e.$t("Public.Btn.Save")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])}}}),Pt=n(),Wt=M("home-security-loophole",()=>({scanRes:h([]),scanResShow:h(!1),scanContentShow:h(!0),onVulScanSwitch:()=>{Pt.isFree?Ce({source:399}):Te({title:"Setting up automatic scanning",width:"550px",height:"200px",footer:!0,component:W(()=>c(()=>t.import("./risk-info-form-legacy.js?v=1760428868419"),void 0))})}})),Et={class:"p-16px"},Rt={class:"mb-[2rem]"},Zt={class:"flex flex-nowrap items-center justify-between"},Gt={key:0,class:"relative"},Bt={key:0,class:"loading-icon"},Jt={class:"pr-[2rem]"},Vt=["innerHTML"],Ft={class:"text-[1.6rem] mt-[1.2rem]"},$t={class:"relative"},Xt={class:"text-[1.5rem]"},Kt=w({__name:"loophole-scan",setup(e){const{t:t}=C(),a=Wt(),s=ot(),r=n(),{scanResShow:o,scanContentShow:c,scanRes:u}=b(a),p=h("success"),g=h(!1),v=h({scanTitle:t("Home.Security.index_39"),scanTime:t("Home.Security.index_40"),scanCheckButton:t("Home.Security.index_41")}),y=async()=>{if(r.isFree)Ce({source:399});else{p.value="loading",v.value.scanTitle=t("Home.Security.index_42")+"...";try{g.value=!0;const{message:e}=await ne();i(e)&&(v.value.scanTitle=t("Home.Security.index_43"),v.value.scanTime=`${t("Logs.Panel.index_13")}：${m(e.time)}`,v.value.scanCheckButton=t("Home.Security.index_41"),c.value=!1,e.info.length?(o.value=!1,u.value=e.info,p.value="danger",v.value.scanCheckButton=t("Home.Security.index_41"),v.value.scanTitle=`${t("Security.Anti.Index_7")} [<span class='text-primary px-2px'>${e.site_num}</span>] ${t("Home.Security.index_45")} <span class='text-error'>${e.loophole_num}</span>`):(o.value=!0,v.value.scanTitle=t("Home.Security.index_44")),s.risk_details[0].value=e.loophole_num)}catch(e){console.log(e),p.value="success"}finally{g.value=!1}}};return(async()=>{const{message:e}=await oe();if(i(e)){const{loophole_num:a,site_num:i,time:l}=e.data;a>0?(v.value.scanTitle=`<span class='text-error'>${a}</span> ${t("Home.Security.index_46")} <span class='text-primary'>${i}</span>`,v.value.scanTime=`${t("Home.Security.index_9")}:${l}`,p.value="danger",v.value.scanCheckButton=t("Home.Security.index_41")):(v.value.scanTitle=`${t("Home.Security.index_47")} ${i}`,v.value.scanTime=`${t("Home.Security.index_9")}:${l}`,v.value.scanCheckButton=t("Home.Security.index_41"),p.value="success")}})(),(e,t)=>{const i=l,s=Fe,r=Re,n=d;return N(),I("div",Et,[D("div",Rt,[D("div",Zt,[k(s,{class:"flex-nowrap!"},{default:U(()=>["loading"==S(p)?(N(),I("div",Gt,[S(g)?(N(),I("div",Bt)):H("",!0),k(i,{name:"home-scanning-scan",size:80,color:"#20a53a"})])):H("",!0),D("div",null,["success"==S(p)?(N(),E(i,{key:0,name:"home-scanning-success",size:80,color:"#20a53a"})):H("",!0),"danger"==S(p)?(N(),E(i,{key:1,name:"home-scanning-danger",size:80,color:"#ef0808"})):H("",!0)]),D("div",Jt,[D("div",{class:"text-[2rem] font-bold",innerHTML:S(v).scanTitle},null,8,Vt),D("div",Ft,j(S(v).scanTime),1)])]),_:1}),D("div",$t,[k(r,{type:"primary",text:"",class:"absolute top-[5rem] right-1rem",onClick:S(a).onVulScanSwitch},{default:U(()=>[Q(j(e.$t("Home.Security.index_38"))+">> ",1)]),_:1},8,["onClick"]),k(r,{class:"h-[4rem] w-[10rem]",type:"loading"==S(p)?"default":"primary",size:"large",onClick:y},{default:U(()=>[D("span",Xt,j(S(v).scanCheckButton),1)]),_:1},8,["type"])])])]),k(n)])}}}),qt=s(Kt,[["__scopeId","data-v-a91fb030"]]),ea={class:"px-16px"},ta={key:0,class:"info"},aa={class:"webedit-con flex items-center justify-center"},ia={class:"thumbnail-introduce mt-[0rem]"},la={class:"text-[1.8rem] font-bold"},sa={key:1,class:"scan"},ra={key:0,class:"scan-success border-[0.1rem] p-[2rem] h-[38rem] border-[#e8e8e8] flex items-center justify-center"},na={class:"flex flex-column items-center"},oa={class:"absolute mt-[10.5rem] text-[2rem] leading-[0.14rem]"},ca={key:1},ua={class:"flex items-center mb-[2rem] text-[#333]"},da={class:"w-[26rem]"},ma={class:"overflow-auto h-[34rem] scrollable"},pa={class:"w-[25rem] flex-shrink-0"},ga={class:"ml-[1.2rem]"},va={class:"whitespace-nowrap"},ya={class:"text-font2 text-[1.2rem] w-auto"},xa={class:"flex items-center justify-between w-full"},fa={class:"flex items-center ml-[1.2rem]"},Ma={class:"text-[#999] ml-[1.2rem]"},ha={class:"bg-[#f6f6f6] text-[#999] p-[2rem] ml-[1.2rem]"},ba={class:"flex items-center"},wa=w({__name:"loophole-view",setup(e){const t=Wt(),{scanResShow:a,scanContentShow:i,scanRes:l}=b(t),s=h(["1"]),r={4:["error","Critical"],3:["warning","High"],2:["info","Medium"],1:["success","Low"]},n=e=>r[e]||["default","Unknown"];return(e,t)=>{const r=$e,o=Ae,c=Ze,u=Fe,d=v,m=g,y=p;return N(),I("div",ea,[S(i)?(N(),I("div",ta,[D("div",aa,[k(r,{class:"max-w-[90rem] mr-[4rem] w-[36rem]",width:"100%",src:S("/static/vite/images/toolview.png")},null,8,["src"]),D("div",ia,[D("span",la,j(e.$t("Home.Security.index_49"))+"：",1),k(o,null,{default:U(()=>[D("li",null,[Q(j(e.$t("Home.Security.index_50"))+": ",1),t[1]||(t[1]=D("br",null,null,-1)),t[2]||(t[2]=Q(" XunRui CMS、pbootcms、Apple CMS、eyoucms、Ocean CMS、 ",-1)),t[3]||(t[3]=D("br",null,null,-1)),t[4]||(t[4]=Q(" ThinkCMF、zfaka、dedecms、MetInfo、emlog、 ",-1)),t[5]||(t[5]=D("br",null,null,-1)),t[6]||(t[6]=Q("Empire CMS、discuz、Thinkphp、Wordpress、Z-Blog、 ",-1)),t[7]||(t[7]=D("br",null,null,-1)),t[8]||(t[8]=Q("Ultimate CMS、ShopXO、HYBBS、ECShop、SchoolCMS、 ",-1)),t[9]||(t[9]=D("br",null,null,-1)),t[10]||(t[10]=Q("phpcms、likeshop、iCMS、WellCMS、chanzhiEPS、 ",-1)),t[11]||(t[11]=D("br",null,null,-1)),t[12]||(t[12]=Q("PHPOK、LaySNS、Knight CMS、openSNS、QiBo CMS、 ",-1)),t[13]||(t[13]=D("br",null,null,-1)),t[14]||(t[14]=Q("ZZZCMS、prestashop、ThinkphpSHOP、DouPHP、 ",-1)),t[15]||(t[15]=D("br",null,null,-1)),t[16]||(t[16]=Q("cmseasy、piwigo、phpwind、XingYunHai CMS ",-1))]),D("li",null,j(e.$t("Home.Security.index_51")),1),D("li",null,j(e.$t("Home.Security.index_52")),1)]),_:1})])])])):(N(),I("div",sa,[S(a)?(N(),I("div",ra,[D("div",na,[k(r,{class:"w-[34.0rem] h-[30.1rem]",width:"100%",src:S("/static/vite/images/secure.png"),"preview-disabled":""},null,8,["src"]),D("span",oa,j(e.$t("Home.Security.index_53")),1)])])):(N(),I("div",ca,[D("div",ua,[D("span",da,j(e.$t("Layout.Sider.site_1")),1),D("span",null,j(e.$t("Mail.MailBox.index_4")),1)]),D("div",ma,[k(y,{modelValue:S(s),"onUpdate:modelValue":t[0]||(t[0]=e=>L(s)?s.value=e:null),accordion:"","arrow-placement":"right"},{default:U(()=>[(N(!0),I(_,null,A(S(l),(t,a)=>(N(),E(m,{key:a},{header:U(()=>[k(u,{class:"items-center flex-nowrap! w-full"},{default:U(()=>[D("div",pa,[k(c,{size:"small",color:t.cms.length>0?{color:"#f2711c",borderColor:"#f2711c",textColor:"white"}:{color:"#67c23a",borderColor:"#67c23a",textColor:"white"}},{default:U(()=>[Q(j(t.cms.length)+" items ",1)]),_:2},1032,["color"]),D("span",ga,j(t.name),1)]),D("span",va,j(t.cms_name+"--"+t.version_info),1),D("div",ya,j(e.$t("Home.Security.index_54")),1)]),_:2},1024)]),default:U(()=>[k(y,{accordion:"","arrow-placement":"right"},{default:U(()=>[(N(!0),I(_,null,A(t.cms,(t,a)=>(N(),E(m,{key:a},{header:U(()=>[D("div",xa,[D("div",fa,[k(c,{type:n(t.dangerous)[0],size:"small"},{default:U(()=>[Q(j(n(t.dangerous)[1]),1)]),_:2},1032,["type"]),D("span",Ma,j(t.ps),1)]),k(d,{class:"mb-[.2rem] mr-[1.6rem]"},{default:U(()=>[Q(j(e.$t("Public.Btn.Details")),1)]),_:1})])]),default:U(()=>[D("div",ha,j(e.$t("Home.Security.index_55"))+": "+j(t.repair),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])]))])),D("div",null,[D("div",ba,[Q(j(e.$t("Home.Security.index_56"))+"： ",1),k(d,{target:"_blank",href:"https://www.aapanel.com/forum/t/support"},{default:U(()=>t[17]||(t[17]=[Q(" https://www.aapanel.com/forum/t/support ",-1)])),_:1,__:[17]})])])])}}}),ka=s(wa,[["__scopeId","data-v-0e08d546"]]),_a={class:"text-20px"},Ia=w({__name:"index",setup:e=>(e,t)=>(N(),I(_,null,[D("div",_a,j(e.$t("Home.Security.index_37")),1),k(qt),k(ka)],64))}),Na={class:"risk-chart"},Da={class:"circle-box"},ja={class:"circle-box-inner"},Sa={class:"circle-box-value"},Aa={class:"circle-box-desc"},za={class:"flex-1 m-[1rem]"},Ca={key:0,class:"mb-[1rem]"},Ta={class:"text-error"},La={class:"mb-[1rem]"},Oa={class:"mt-[1rem]"},Ua={class:"flex h-[3.2rem]"},Qa={class:"text-[30px] mr-[2rem]"},Ha={class:"bg-[#ef0808] px-2"},Ya={class:"bg-[#f0ad4e] px-2"},Pa={class:"bg-[#a1a1a1] px-2"},Wa=w({__name:"risk-score",setup(e){const{t:t}=C(),a=ot(),{scoreData:l}=b(a),s=[{color:"#ef0808",percentage:60,type:"danger"},{color:"#f0ad4e",percentage:80,type:"warn"},{color:"#e8d544",percentage:90,type:"alert"},{color:"#20a53a",percentage:100,type:"safe"}],r=T(()=>s.find(e=>l.value.score<=e.percentage)),n=P({total:0,high_risk:0,medium_risk:0,low_risk:0}),o=(e=[])=>[{type:"category",show:!1,boundaryGap:!1,data:e}],c=(e=[])=>[{name:t("Home.Security.index_71"),type:"line",data:e,itemStyle:{color:"#ec958d"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#fcdcd5"},{offset:1,color:"#fcdcd5"}]}}}],u=R({tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{width:1,type:"solid"}}},grid:{top:"30%",left:"0",right:"0",bottom:"0%",containLabel:!1},yAxis:{show:!1},xAxis:o(),series:c()});return(async()=>{const{message:e}=await ce();if(i(e)){n.total=e.total,n.high_risk=e.high_risk,n.medium_risk=e.medium_risk,n.low_risk=e.low_risk;const t=e.trend_list.map(e=>m(e.timestamp)),a=e.trend_list.map(e=>e.count);u.xAxis=o(t),u.series=c(a)}})(),(e,t)=>{const a=Fe;return N(),I("div",null,[D("div",{class:Z(["flex items-center mt-[2rem]",`circle-${S(r)?.type}`])},[D("div",Na,[D("div",Da,[t[1]||(t[1]=D("div",{class:"circle-box-bg"},null,-1)),D("div",ja,[D("div",Sa,[Q(j(S(l).score)+" ",1),t[0]||(t[0]=D("div",{class:"unit"},null,-1))]),D("div",Aa,j(S(l).scoreLevel),1)])])]),D("div",za,[S(l).riskNum>0?(N(),I("div",Ca,[D("span",Ta,j(S(l).riskNum),1),Q(" "+j(e.$t("Home.Security.index_68")),1)])):H("",!0),D("template",null,[D("div",La,j(e.$t("Home.Security.index_69")),1)]),D("p",null,j(S(l).subtitle),1)])],2),D("div",Oa,[D("div",null,j(e.$t("Home.Security.index_70")),1),D("div",Ua,[D("span",Qa,j(S(n).total),1),k(a,{class:"items-end color-white"},{default:U(()=>[D("span",Ha,j(S(n).high_risk),1),D("span",Ya,j(S(n).medium_risk),1),D("span",Pa,j(S(n).low_risk),1)]),_:1})]),k(lt,{height:60,option:S(u)},null,8,["option"])])])}}}),Ea=s(Wa,[["__scopeId","data-v-56656608"]]),Ra={class:"flex items-center justify-between flex-nowrap text-[11px]"},Za={class:"text-[30px] mx-[0.4rem] text-primary"},Ga={class:"leading-[2rem]"},Ba={class:"flex items-center"},Ja={class:"flex ml-[0.6rem]"},Va=["title"],Fa={class:"flex flex-wrap mt-15 justify-center!"},$a=["onClick"],Xa=w({__name:"risk-info",setup(e){const{t:t}=C(),a=ot(),{safe:i,capabilitySwitch:s,risk_details:r,menu:o}=b(a),c=n(),u=Wt(),m=async e=>{const a=t(e?"Home.Security.index_64":"Home.Security.index_65"),i=t(e?"Home.Security.index_66":"Home.Security.index_67");await De({title:a,content:i,onConfirm:async()=>{await ue({dynamic_detection:e}),s.value.file_detection.status=e}})};return(e,t)=>{const a=l,n=d,p=Ee,g=Fe,v=Xe;return N(),I("div",null,[D("div",Ra,[D("div",null,[Q(j(e.$t("Security.Anti.Index_35")),1),D("strong",Za,j(S(i).day),1),Q(j(e.$t("Crontab.arrange.index_41")),1)]),D("div",Ga,[D("div",Ba,[t[0]||(t[0]=D("span",null,"Protection",-1)),D("ul",Ja,[(N(!0),I(_,null,A(S(s),(e,t)=>(N(),I("li",{class:"mr-[0.1rem]",key:t,title:e.name},[k(a,{name:e.icon+(e.status?"-active":""),size:14},null,8,["name"])],8,Va))),128))])]),D("div",null,"Last Scan："+j(S(i).time),1),D("div",null,"Last Virus DB Update："+j(S(i).virus),1)])]),k(n,{class:"!mb-[1.8rem] !mt-0"}),k(g,{class:"text-[14px] text-bold"},{default:U(()=>[k(g,{size:4,class:"items-center! mr-[1rem]"},{default:U(()=>[t[1]||(t[1]=D("span",null,"Malware Scan",-1)),k(p,{size:"small",value:S(s).file_detection.status,onUpdateValue:m},null,8,["value"])]),_:1,__:[1]}),k(g,{size:4,class:"items-center!"},{default:U(()=>[D("span",null,j(e.$t("Home.Security.index_63")),1),k(p,{size:"small",value:S(s).vul_scan.status,"onUpdate:value":S(u).onVulScanSwitch},null,8,["value","onUpdate:value"])]),_:1})]),_:1}),k(n,{class:"my-[1rem]!"}),D("div",Fa,[(N(!0),I(_,null,A(S(r),(e,a)=>(N(),I("div",{key:a,class:"flex flex-col items-center w-[12rem] mb-[1rem] w-1/3"},[D("div",null,[D("span",null,j(e.title),1),k(v,{trigger:"hover"},{trigger:U(()=>t[2]||(t[2]=[D("span",{class:"ml-4px bt-ico-ask"},"?",-1)])),default:U(()=>[D("span",null,j(e.tips),1)]),_:2},1024)]),D("div",{class:Z(["text-[22px] cursor-pointer",e.value>0?"text-[#ef0808]":"text-[#20a53a]"]),onClick:t=>(async e=>{if("tamper"===e){if(c.isFree)return void Ce({source:399});await Le("tamper_core"),await st({name:"tamper_core",title:"Tamper-proof for Enterprise\t",admin:!0})}else o.value=e})(e.type)},j(e.value),11,$a)]))),128)),t[3]||(t[3]=D("div",{class:"w-1/3"},null,-1))])])}}}),Ka=w({__name:"security-trend",setup(e){const{loading:t,setLoading:a}=je(),l=h(!0),s=h(null);let r=null;const n=G("--chart-tooltip-bg-color");return B(()=>{(async()=>{if(s.value){r=rt(s.value);try{a(!0);const{message:e}=await de();if(i(e)){l.value=e.trend_list.length>0;const t=e.trend_list.map(e=>m(e.timestamp,"MM-dd")),a=e.trend_list.map(e=>e.handled_risks),i=e.trend_list.map(e=>e.unhandled_risks),s=e.trend_list.map(e=>e.risk_scan),o=e.trend_list.map(e=>e.vul_scan),c=e.trend_list.map(e=>e.server_risks),u={tooltip:{trigger:"axis",backgroundColor:n.value,borderColor:"transparent",textStyle:{color:"#c7c7c7"},axisPointer:{type:"shadow",label:{show:!0}}},grid:{top:"10%",right:"5%",bottom:"15%",left:"5%",containLabel:!0},legend:{bottom:0,itemWidth:12,itemHeight:10,itemGap:10,textStyle:{fontSize:10,color:"#666666"},data:["Unaddressed","Processed","Home","Bug","Baseline"]},xAxis:{type:"category",data:t},yAxis:{type:"value",min:0},series:[{name:"Unaddressed",type:"line",smooth:!0,showSymbol:!1,sampling:"average",data:i},{name:"Processed",type:"line",smooth:!0,showSymbol:!1,sampling:"#20a53a",data:a},{name:"Home",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(29, 159, 234, 1)"}},data:s},{name:"Bug",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(30,67,180,1)"}},data:o},{name:"Baseline",type:"bar",barWidth:"8px",itemStyle:{normal:{color:"rgb(70,44,104,1)"}},data:c}]};r.setOption(u)}}finally{a(!1)}}})()}),J(()=>{r?.dispose()}),(e,a)=>{const i=Ke,r=u;return N(),E(r,{show:S(t)},{default:U(()=>[D("span",null,j(e.$t("Home.Security.index_79")),1),S(l)?(N(),I("div",{key:0,ref_key:"chartContainer",ref:s,style:{height:"230px"}},null,512)):(N(),E(i,{key:1,description:"No data available"}))]),_:1},8,["show"])}}}),qa={class:"security-risk-news"},ei=w({__name:"security-news",setup(e){const a=W(()=>c(()=>t.import("./security-news-detail-legacy.js?v=1760428868419"),void 0)),{t:l}=C(),s=ze(),{table:r,columns:n}=Ie([{key:"description",title:l("Home.Security.index_72"),ellipsis:{tooltip:{width:"trigger"}}},{key:"title",title:l("Home.Security.index_73"),align:"center",width:80,render:e=>{const{text:t,style:a}=pt(e.level);return k("span",{style:a},[Q("["),t,Q("]")])}},{key:"title",title:"Time",width:60,render:e=>m(e.time,"MM-dd")},Ne({width:80,options:e=>[{label:l("Security.Anti.Index_21"),onClick:()=>{s.title=`[${e.file_path}] ${l("Security.Anti.Index_21")}`,s.data.row=e,s.show=!0}}]})]),{loading:o,setLoading:u}=je();return(async()=>{try{u(!0);const{message:e}=await me();i(e)&&(r.data=e.events)}finally{u(!1)}})(),(e,t)=>{const i=Se,l=et,c=qe,u=_e;return N(),I("div",qa,[k(c,{"default-value":"security"},{default:U(()=>[k(l,{name:"security",tab:"Security News"},{default:U(()=>[k(i,{loading:S(o),data:S(r).data,columns:S(n),"loading-num":4,"max-height":"160"},null,8,["loading","data","columns"])]),_:1})]),_:1}),k(u,{show:S(s).show,"onUpdate:show":t[0]||(t[0]=e=>S(s).show=e),title:S(s).title,data:S(s).data,width:500,footer:!1,"min-height":380,component:S(a)},null,8,["show","title","data","component"])])}}}),ti={class:"text-20px"},ai={class:"flex"},ii={class:"flex"},li=w({__name:"index",setup:e=>(ot().getSafeOverviewData(),(e,t)=>{const a=d;return N(),I(_,null,[D("div",ti,j(e.$t("Home.Security.index_57")),1),D("div",ai,[k(Ea,{class:"w-50%"}),k(Xa,{class:"w-50%"})]),k(a,{class:"my-6!"}),D("div",ii,[k(Ka,{class:"w-50%"}),k(ei,{class:"w-50%"})])],64)})}),si=ot(),ri=n(),{risk_details:ni}=b(si),oi=e("H",M("HOME-SECURITY-RISKS-STORE",()=>{const e=h(""),t=h(""),a=h("Scanning, please wait patiently..."),l=h(!1),s=h(!1),r=h(""),n=h(!1),c=h(!1),u=h(!0),d=h(!1),m=h(),p=h(!0),g=h(!1),v=h("primary"),y=h(100),x=h("!text-[#20a53A]"),f=h("safe"),M=h(),b=h("The current server has not been scanned for security and may be at risk"),w=h(""),_=h([]),I=h(),N=h([]),D=h(!0),j=h([]),S=h([]),A=h(!0),z=h(!1),C=h(!1),T=P({progress:1,repairProgress:!1,repairText:"Repairing.."}),L=P({processPercentage:0,processColor:"#20a53a"}),O={risk:{type:"danger",label:"Risk Items",list:[]},security:{type:"primary",label:"Risk-free item",list:[]},ignore:{type:"warning",label:"Ignored items",list:[]}},U=P({cannot_automatically:0,failed:0,success:0}),H=h(0),{table:Y,columns:W}=Ie([{title:"Risk Items",key:"m_name",width:150,ellipsis:{tooltip:{width:"trigger"}}},{title:"Fixes",key:"msg",ellipsis:{tooltip:{width:"trigger"}}},{title:"Information",key:"type",width:100,align:"center",render:e=>Array.isArray(e.type)&&e.type.length>0?k("span",{class:"h-[3.2rem] inline-block whitespace-pre-wrap"},[Q(" "),e.type.join("，"),Q(" ")]):"None"},{title:"Operation Results",key:"status",width:120,align:"right",render:e=>e.status?k("span",{class:"text-[#20a53a]"},[Q(" Repair Success ")]):k("span",{class:"text-[red]"},[Q(" Repair failed ")])}]),E=P({1:{text:"Low",bg:"rgba(232, 213, 68, 0.1)",color:"#D4BB00"},2:{text:"Medium",bg:"rgba(240, 173, 78, 0.14)",color:"#f0ad4e"},3:{text:"High",bg:"rgba(239, 8, 8, 0.1)",color:"#EF0808"}}),R=h("overview"),Z=P({risk:0,malware:0,web:0,baseline:0}),G=()=>{100==y.value?(x.value="!text-[#20a53A]",f.value="safe",L.processColor="#20a53A"):y.value>=80&&y.value<=99?(x.value="!text-[#E8D544]",f.value="risk",L.processColor="#E8D544"):y.value>=60&&y.value<=79?(x.value="!text-[#F0AD4E]",L.processColor="#F0AD4E",f.value="warn"):y.value<60&&(x.value="!text-[#EF0808]",L.processColor="#EF0808",f.value="danger")},B=e=>{N.value=e.is_autofix,localStorage.setItem("isAutoFix",JSON.stringify(N.value));for(const t in O){const a=e[t];if(Array.isArray(a)){for(let e=0;e<a.length;e++){const i=O[t].list.find(t=>t.m_name==a[e].m_name);a[e].show=i?.show||!1,a[e].selection=i?.selection||!1}Object.keys(O).includes(t)&&"risk"==t&&I.value&&a&&(I.value=[...I.value,...a]),O[t].list=a}}r.value=e.check_time,v.value="primary",n.value=!0,g.value=!0,J(),m.value=" !animate-none",localStorage.setItem("scanData",JSON.stringify(I.value)),localStorage.setItem("lastScanTime",JSON.stringify(r.value))},J=()=>{I.value?.forEach(e=>{N.value.includes(e.m_name)?(e.selection=!0,j.value.push(e)):e.selection=!1}),j.value.length>0?(D.value=!1,s.value=!0):D.value=!0},V=async(e=!1)=>{l.value=!0,a.value="Scanning, please wait...";try{const t={};let a;e&&(t.force=1),a=e?(await he(t)).message:(await be()).message,i(a)&&(a.interrupt||(I.value=[],B(a),y.value=a.score??0,H.value=I.value.length,ni.value[2].value=H.value,b.value="Security scan completed.",S.value=a.ignore??[]))}catch(t){console.log(t)}l.value=!1},F=async e=>{Y.data=[],c.value=!0,U.cannot_automatically=e.cannot_automatically.length,U.failed=e.failed.length,U.success=e.success.length,_.value=[];for(const t in e)for(const a of e[t])_.value.push({m_name:a.m_name,type:a.result.type,msg:a.result.msg,status:a.result.status,name:t});Y.data=_.value,l.value=!1,I.value=I.value?.filter(t=>!e.success.some(e=>e.m_name===t.m_name)),H.value=I.value?.length||0,ni.value[2].value=H.value,localStorage.setItem("scanData",JSON.stringify(I.value))};return{showAnimation:d,scanScore:y,scanTextClass:x,scanOuterClass:f,animateFlag:m,scanPreText:b,riskNum:H,scanButtonType:v,repairAutoRiskButton:n,cookieRepair:p,scanItemText:w,processData:L,lastScanTime:r,scanSelectShow:g,allSelect:s,allSelectionDis:D,isIgnoreAll:z,ignoreData:S,emptyDetail:u,loading:l,loadingText:a,isShow:A,activeMent:e,activeMentIgnore:t,is_autofix:N,levelData:E,allData:I,repairData:T,resultConfirm:c,resultItemLength:U,resultTable:Y,resultColumn:W,reportPopup:C,onIgnore:async e=>{try{l.value=!0,a.value="Ignoring risk items, please wait patiently...",await we({m_name:e.m_name}),V(!1)}finally{l.value=!1}},onScan:async()=>{if(A.value=!1,u.value=!1,y.value=100,f.value="safe",x.value="!text-[#20a53A]","info"==v.value){clearInterval(M.value),await ve();const{message:e}=await ye();i(e)&&(B(e),y.value="?",x.value="!text-[#EF0808]",f.value="danger",l.value=!1,H.value=e.risk.length,ni.value[2].value=H.value,b.value="Scan interruption ")}else{L.processPercentage=0,d.value=!0,b.value="Security scan in progress...",H.value=0,w.value="Testing...",m.value="",v.value="info",p.value=!0,n.value=!1,V(!0);try{clearInterval(M.value),M.value=setInterval(async function(){const{message:e}=await xe();i(e)&&(L.processPercentage=e.percentage,H.value=e.count,ni.value[2].value=H.value,w.value=e.status,y.value=e.score,e.count&&100!=e.percentage&&(x.value="!text-[#EF0808]",f.value="danger",b.value="A security scan is in progress. "),100==e.percentage&&clearInterval(M.value),G())},1e3)}catch(e){console.log(e)}}},onRepairAll:async()=>{if(ri.isFree)Ce({source:399});else try{const e=I.value?.filter(e=>1==e.selection).map(e=>e.m_name);if(0==e?.length)return l.value=!1,void o.error("There are currently no risk items that can be automatically repaired!");l.value=!0,a.value="It is being repaired. It may take a long time. Please wait patiently...",T.progress=0;const{message:t}=await fe(JSON.stringify({m_name:e}));if(i(t)){T.repairProgress=!0;const e=setInterval(async()=>{const{message:a}=await Me();if(i(a)&&(T.progress=a.percentage,T.repairText=a.status,100===a.percentage)){T.repairText="Repair Completed",T.repairProgress=!1,T.progress=100,clearInterval(e);const a=await t;F(a),V(!0)}},800)}}catch(e){console.log(e)}finally{l.value=!1}},onRepair:async(e,t)=>{if(ri.isFree)return void Ce({source:399});const s=I.value?.filter(e=>1==e.selection).map(e=>e.m_name);try{if(!e&&0==s?.length)return void o.error("Please select the risk items that need to be repaired!");l.value=!0,a.value="It is being repaired. It may take a long time. Please wait patiently...";const{message:r}=await fe(JSON.stringify({m_name:e?[t?.m_name]:s}));i(r)&&(e&&r.success.length>0?(o.success("Repair Success"),H.value--,ni.value[2].value=H.value,I.value=I.value?.filter(e=>e.m_name!==t?.m_name),F(r)):F(r))}catch(r){console.log(r)}finally{l.value=!1}},vulnerabilityInvolvesSoftware:e=>{const t=Object.keys(e.soft_name);let a="";return t.forEach((i,l)=>{l===t.length-1?a+=`${t}:${e.soft_name[i]}`:a+=`${t}:${e.soft_name[i]}\n`}),a},onToggle:(e,t)=>{e.show||t.forEach(e=>e.show=!1),e.show=!e.show},repairTypeActive:R,tootipTotal:Z,getScanTotal:async()=>{const{message:e}=await pe();if(i(e)){const{vulnerability:t,malware:a,security:l,baseline:s}=e.data;if(Z.malware=a,Z.risk=l,Z.web=t,Z.baseline=s,Z.risk){b.value=`<span class='text-error'>${Z.risk}</span> risks have been detected, please fix them in time`;const{message:e}=await ge();i(e)&&(N.value=e.is_autofix,I.value=e.risk,r.value=e.check_time,g.value=!0,n.value=!0,A.value=!1,u.value=!1,d.value=!0,y.value=e.score,G(),J())}}}}})),ci={class:"flex items-center p-[2rem]"},ui={class:"flex items-center w-full"},di={key:0,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},mi={key:1,class:"w-[10rem] h-[10rem] relative flex-shrink-0"},pi={class:"w-full text-[2rem] flex flex-col ml-[3rem]"},gi={class:"flex items-center w-full justify-between"},vi={class:"w-420px"},yi=["innerHTML"],xi={key:1},fi={class:"mx-[4px] text-[2.4rem] mx-[4px] text-error"},Mi={class:"flex items-center"},hi={key:0,class:"text-[1.4rem] text-font2 mt-[1rem]"},bi={key:1,class:"text-[1.4rem] text-font2 mt-[1rem]"},wi={key:3,class:"text-[1.4rem] mt-[12px] text-font2 flex items-center"},ki={key:4,class:"text-[1.4rem] mt-[12px] text-[#F0AD4E] flex items-center"},_i=w({__name:"risk-scan",setup(e){const t=oi(),{showAnimation:a,scanScore:i,scanTextClass:l,scanOuterClass:s,animateFlag:r,scanPreText:n,riskNum:o,scanButtonType:c,repairAutoRiskButton:u,cookieRepair:d,scanItemText:m,processData:p,lastScanTime:g}=b(t);return(e,v)=>{const y=Re,x=tt;return N(),I("div",ci,[D("div",ui,[S(a)?H("",!0):(N(),I("div",di,v[1]||(v[1]=[D("span",{class:"inline-block scan-icon-img icon-img-safe"},null,-1),D("span",{class:"scan-icon-img-bg"},null,-1),D("span",{class:"text-[3.2rem] h-[4.4rem] w-[0.7rem] text-[#20a53a] font-bold absolute-center"},"i",-1)]))),S(a)?(N(),I("div",mi,[D("p",{class:Z("box-text w-[5.8rem] "+S(l))},j(S(i)),3),D("span",{class:Z("scan-icon-img icon-img-"+S(s))},null,2),v[4]||(v[4]=D("span",{class:"circle-inner"},null,-1)),D("span",{class:Z("circle-outer "+S(s))},null,2),D("div",{class:Z("animate-box"+S(r))},[D("div",{class:Z("animate-box-left linear-"+S(s))},null,2),v[2]||(v[2]=D("div",{class:"animate-box-right"},null,-1)),v[3]||(v[3]=D("div",{class:"animate-box-bottom"},null,-1))],2)])):H("",!0),D("div",pi,[D("div",gi,[D("span",vi,[S(o)?(N(),I("span",xi,[D("span",fi,j(S(o)),1),Q(" "+j(e.$t("Home.Security.index_89")),1)])):(N(),I("span",{key:0,innerHTML:S(n)},null,8,yi))]),D("div",Mi,[S(u)&&S(d)?H("",!0):(N(),E(y,{key:0,class:Z("w-[9rem] "+("info"==S(c)?"bg-[#CBCBCB]":"")),type:S(c),round:"",onClick:S(t).onScan},{default:U(()=>[Q(j("info"==S(c)?e.$t("Home.Security.index_90"):e.$t("Home.Security.index_41")),1)]),_:1},8,["class","type","onClick"])),S(u)&&S(d)?(N(),I("span",{key:1,round:"",onClick:v[0]||(v[0]=(...e)=>S(t).onScan&&S(t).onScan(...e)),class:"!p-[0] bt-link text-[1.2rem] mr-4px whitespace-nowrap"},j(e.$t("Ftp.Log.Index_12")),1)):H("",!0),S(u)&&S(d)?(N(),E(y,{key:2,round:"",type:S(c),onClick:S(t).onRepairAll},{default:U(()=>[Q(j(e.$t("Home.Security.index_91")),1)]),_:1},8,["type","onClick"])):H("",!0)])]),"info"===S(c)||S(u)?H("",!0):(N(),I("span",hi,j(e.$t("Home.Security.index_92")),1)),"info"==S(c)?(N(),I("span",bi,j(S(m)),1)):H("",!0),"info"==S(c)?(N(),E(x,{key:2,class:"mt-[1.6rem] h-[1rem]","process-color":S(p).processColor,percentage:S(p).processPercentage,"stroke-width":10,"show-text":!1},null,8,["process-color","percentage"])):H("",!0),S(u)?(N(),I("span",wi,j(e.$t("Home.Security.index_9"))+"："+j(S(g)),1)):H("",!0),S(u)&&S(d)?(N(),I("span",ki,j(e.$t("Home.Security.index_93")),1)):H("",!0)])])])}}}),Ii=s(_i,[["__scopeId","data-v-f660504b"]]),Ni={key:0,class:"text-[1.4rem] w-full flex items-center justify-between px-[0.8rem]"},Di={class:"items-center flex"},ji={class:"flex items-center"},Si=w({__name:"risk-select",setup(e){const t=oi(),{scanSelectShow:a,allSelect:i,allSelectionDis:s,allData:r,isIgnoreAll:n,is_autofix:o,reportPopup:c}=b(t),u=T(()=>r.value?.filter(e=>1==e.selection).map(e=>e.m_name).length);return V(i,e=>{e?r.value?.forEach(e=>{o.value.includes(e.m_name)&&(e.selection=!0)}):r.value?.forEach(e=>{e.selection=!1})}),(e,r)=>{const o=Ve,d=v,m=l,p=Re;return S(a)?(N(),I("div",Ni,[D("div",Di,[k(o,{checked:S(i),"onUpdate:checked":r[0]||(r[0]=e=>L(i)?i.value=e:null),disabled:S(s)},{default:U(()=>[Q(j(e.$t("Public.SelectAll")),1)]),_:1},8,["checked","disabled"]),k(d,{onClick:r[1]||(r[1]=e=>S(t).onRepair(!1)),class:Z(S(u)?"ml-[20px] text-[1.4rem]":"ml-[20px] text-[1.4rem] text-[#999] cursor-not-allowed ")},{default:U(()=>[Q(j(e.$t("Home.Security.index_94")),1)]),_:1},8,["class"])]),D("div",ji,[k(d,{onClick:r[2]||(r[2]=e=>n.value=!0)},{default:U(()=>[Q(j(e.$t("Home.Security.index_95")),1)]),_:1}),r[5]||(r[5]=D("span",{class:"text-[#999] mx-[1.2rem]"},"|",-1)),k(p,{type:"primary",text:"",onClick:r[3]||(r[3]=e=>c.value=!0)},{default:U(()=>[k(m,{name:"home-safe-report",class:"mr-4px"}),r[4]||(r[4]=Q(" View Report ",-1))]),_:1,__:[4]})])])):H("",!0)}}}),Ai=["onClick"],zi={class:"module-head flex items-center h-[5.4rem] justify-between border-b-1 px-[0.8rem] w-full"},Ci={class:"w-full flex items-center"},Ti=["title"],Li={class:"px-[3rem] py-[3.2rem]",style:{background:"var(--home-risk-security-ignore-collapse-bg)"}},Oi={class:"flex items-center"},Ui={class:"w-100px text-right",style:{color:"var(--home-risk-file-info-item-color)"}},Qi=["innerHTML"],Hi={class:"flex mt-[16px] items-center"},Yi={key:0,class:"collapse-item flex-col !items-start"},Pi={key:1,class:"collapse-item"},Wi={class:"flex mt-[16px] items-center"},Ei={class:"w-100px text-right"},Ri={class:"collapse-item"},Zi=w({__name:"risk-list",setup(e){const{t:t}=C(),a=oi(),{emptyDetail:i,allData:l,loading:s,loadingText:r,activeMent:n,isShow:o,is_autofix:c,levelData:d}=b(a),m=e=>[{label:"Fix it now",show:!!c.value.includes(e.m_name),onClick:()=>{a.onRepair(!0,e)}},{label:t("Ftp.Table.index_8"),class:"text-[#999]",onClick:()=>{a.onIgnore(e)}},{label:e.show?t("Home.Security.index_83"):t("Security.Anti.Index_21"),onClick:t=>{t.stopPropagation(),a.onToggle(e,l.value)}}];return(e,t)=>{const g=Ve,x=Fe,f=v,M=Oe,h=y,b=p,w=u;return N(),I(_,null,[S(i)?H("",!0):(N(),E(w,{key:0,show:S(s),class:Z([S(o)?"h-[24rem]":"h-[34rem]","scan-body mt-16px"]),description:S(r)},{default:U(()=>[k(b,{"expanded-names":S(n),"onUpdate:expandedNames":t[0]||(t[0]=e=>L(n)?n.value=e:null),accordion:"","arrow-placement":"right"},{default:U(()=>[D("div",{class:Z(["module-list overflow-auto",S(o)?"h-[24rem]":"h-[34rem]"])},[(N(!0),I(_,null,A(S(l),(i,s)=>(N(),I("div",{class:"module-item text-[1.2rem] cursor-pointer",key:`${s}`,onClick:e=>S(a).onToggle(i,S(l))},[D("div",zi,[D("div",Ci,[k(g,{checked:i.selection,"onUpdate:checked":e=>i.selection=e,disabled:!S(c).includes(i.m_name)},null,8,["checked","onUpdate:checked","disabled"]),k(x,{class:Z(["flex-nowrap!",S(c).includes(i.m_name)?"w-[50rem]!":"w-[30rem]!"])},{default:U(()=>[D("span",{class:"text-[1.2rem] h-[2.2rem] px-[8px] rounded-[0.2rem] mx-[8px] whitespace-nowrap flex items-center",style:z({color:S(d)[i.level].color,backgroundColor:S(d)[i.level].bg})},j(S(d)[i.level].text),5),D("div",{class:"truncate",style:z({color:S(d)[i.level].color}),title:i.ps?i.ps:i.vuln_name},j(i.ps?i.ps:i.vuln_name),13,Ti)]),_:2},1032,["class"]),S(c).includes(i.m_name)?H("",!0):(N(),E(x,{key:0,size:0,class:"text-font2 ml-10px items-center!"},{default:U(()=>[t[2]||(t[2]=D("span",null,"Contact Now",-1)),k(f,{href:"mailto:support@aapanel.com",target:"_blank",class:"ml-2px"},{default:U(()=>t[1]||(t[1]=[Q("support@aapanel.com",-1)])),_:1,__:[1]})]),_:1,__:[2]}))]),k(M,{class:"w-200px",options:m(i)},null,8,["options"])]),k(h,null,{default:U(()=>[F(D("div",Li,[D("div",Oi,[D("div",Ui,j(i.ps?"Risk Description":"Involved software "),1),F(D("div",{class:"collapse-item",innerHTML:i.msg},null,8,Qi),[[$,i.msg]]),F(D("div",{class:"collapse-item"},j(i.soft_name?S(a).vulnerabilityInvolvesSoftware(i):""),513),[[$,i.soft_name]])]),D("div",Hi,[t[3]||(t[3]=D("div",{class:"w-100px text-right"},"Solution",-1)),i.tips?(N(),I("div",Yi,[(N(!0),I(_,null,A(i.tips,(e,t)=>(N(),I("p",{key:t,class:Z(0==t?"":"mt-[4px]")},j(t+1)+"、"+j(e),3))),128))])):H("",!0),i.vuln_solution?(N(),I("div",Pi,j(i.vuln_solution),1)):H("",!0)]),F(D("div",Wi,[D("div",Ei,j(e.$t("Home.Security.index_81")),1),D("div",Ri,j(i.remind),1)],512),[[$,i.remind]])],512),[[$,i.show]])]),_:2},1024)],8,Ai))),128))],2)]),_:1},8,["expanded-names"])]),_:1},8,["show","class","description"])),S(i)?(N(),I("div",{key:1,class:Z([S(o)?"h-[32rem]":"h-[40rem]","scan-body flex justify-center flex-col my-[3rem] relative"])},[t[4]||(t[4]=D("span",{class:"risk-spin h-[3rem] w-[33%] mb-[12px]"},null,-1)),(N(),I(_,null,A(4,(e,t)=>D("span",{class:"risk-spin h-[3rem] w-full mb-[12px]",key:t})),64)),t[5]||(t[5]=D("span",{class:"risk-spin h-[3rem] w-[60%] mb-[12px]"},null,-1)),(N(),I(_,null,A(3,(e,t)=>D("span",{class:"risk-spin h-[3rem] w-full mb-[12px]",key:t})),64)),t[6]||(t[6]=D("span",{class:"risk-spin h-[3rem] w-[40%] mb-[12px]"},null,-1))],2)):H("",!0)],64)}}}),Gi=s(Zi,[["__scopeId","data-v-a3822d9f"]]),Bi={class:"text-20px"},Ji=w({__name:"index",setup(e){const a=W(()=>c(()=>t.import("./risk-repair-legacy.js?v=1760428868419"),void 0)),i=W(()=>c(()=>t.import("./risk-ignore-list-legacy.js?v=1760428868419"),void 0)),l=W(()=>c(()=>t.import("./risk-report-legacy.js?v=1760428868419"),void 0)),s=oi(),{resultConfirm:r,isIgnoreAll:n,reportPopup:o}=b(s);return s.getScanTotal(),(e,t)=>{const s=_e;return N(),I(_,null,[D("div",Bi,j(e.$t("Home.Security.index_80")),1),k(Ii),k(Si),k(Gi),k(s,{show:S(r),"onUpdate:show":t[0]||(t[0]=e=>L(r)?r.value=e:null),title:"Result Confirmation",width:500,component:S(a)},null,8,["show","component"]),k(s,{show:S(n),"onUpdate:show":t[1]||(t[1]=e=>L(n)?n.value=e:null),title:"Ignore risk items",width:700,"min-height":400,component:S(i)},null,8,["show","component"]),k(s,{show:S(o),"onUpdate:show":t[2]||(t[2]=e=>L(o)?o.value=e:null),title:"Security Scan Report",width:1e3,"min-height":800,component:S(l),footer:!0,"confirm-text":e.$t("Public.Btn.Export"),"hide-close":!0},null,8,["show","component","confirm-text"])],64)}}}),Vi=M("home-security-server",()=>{const e=h(!1),t=h("");return{serverScanParams:h({scanStatus:!1,isEnd:!1,error:0,warn:0,time:0,progress:0,progressColor:"#20a53a",progressConfig:{system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},statusTotal:{},allArr:[],result:{},progressStatus:{},active:{}}),checkTopic:t,isScan:e}}),Fi={class:"progress-header"},$i={class:"progress-header-cot"},Xi={key:0,class:"relative"},Ki={class:"absolute top-[1.6rem] left-[2.6rem] flex flex-col"},qi={class:"text-[1.2rem] font-bold leading-none"},el={class:"progress-header-cot"},tl={class:"scanning-progress-title"},al={class:"color-#fc6d26"},il={class:"scanning-progress-cont"},ll=w({__name:"server-scan",setup(e){const t=Vi(),a=n(),{serverScanParams:s,checkTopic:r,isScan:o}=b(t),c=P({status:!0,time:0,security_count:0,risk_count:{warning:0,danger:7}}),u=h(""),d=T(()=>s.value.scanStatus&&!s.value.isEnd?"Scanning":c.status?"Last detection time "+x(c.time):"Currently not undergoing security testing"),p=T(()=>s.value.scanStatus&&!s.value.isEnd?`Scanning-${u.value}`:s.value.isEnd?"Detection time："+m(s.value.time/1e3,"yyyy-MM-dd"):c.status?"The server may have security risks. It is recommended to check it immediately":"The current security risk is unknown, please check immediately"),{open:g,send:v,close:y}=Ue("/ws_project",{immediate:!1,onMessage:(e,t)=>{const a=JSON.parse(t.data.replace(/'/g,'"'));a&&"object"==typeof a&&"callback"in a?(y(),s.value.scanStatus=!1,s.value.isEnd=!0,s.value.time=(new Date).getTime(),A()):(u.value=a.name,r.value=a.topic,s.value.progress=parseInt(a.progress),s.value.progressConfig[a.topic]?.push(a),s.value.statusTotal[a.topic]=f(s.value.progressConfig[a.topic]),s.value.allArr.push(a),3===a.status&&s.value.error++,2!==a.status&&3!==a.status||s.value.warn++,1!==a.status&&(s.value.progressColor="#fc6d26"))}}),f=e=>{const t={};return e.length&&e.forEach(e=>{t[e.status]?t[e.status]++:t[e.status]=1}),t},M=()=>{if(a.isFree)Ce({source:399});else{if(s.value.scanStatus&&!s.value.isEnd)return y(),void w();s.value.isEnd&&w(),s.value.scanStatus=!0,g(),v({mod_name:"safe_detect",def_name:"get_safe_scan",ws_callback:""}),o.value=!0}},w=()=>{s.value.scanStatus=!1,s.value.isEnd=!1,s.value.error=0,s.value.warn=0,s.value.time=0,s.value.progress=0,s.value.progressColor="#20a53a",s.value.progressConfig={system_account:[],sshd_service:[],file_mode:[],software:[],other:[],backdoor:[],proc:[],history:[],log:[],rootkit:[]},s.value.statusTotal={},s.value.allArr=[],s.value.result={},s.value.progressStatus={},s.value.active={system_account:!1,sshd_service:!1,file_mode:!1,software:!1,other:!1,backdoor:!1,proc:!1,history:!1,log:!1,rootkit:!1}},A=()=>{const e=e=>e.sort((e,t)=>t.status-e.status);for(const i in s.value.progressConfig){const t=s.value.progressConfig[i];Array.isArray(t)&&t.length&&e(t)}const t=s.value.allArr;Array.isArray(t)&&t.length&&e(t);const a=s.value.result;if(a&&Object.keys(a).length){const t={};Object.keys(a).forEach(t=>{const i=a[t];Array.isArray(i)&&e(i)}),Object.keys(a).sort((e,t)=>{const i=a[e].some(e=>e.status>1);return i===a[t].some(e=>e.status>1)?0:i?-1:1}).forEach(e=>{t[e]=a[e]}),s.value.result=t}};return(async()=>{try{const{message:e}=await ke();if(i(e)){if(Object.prototype.hasOwnProperty.call(e,"msg"))return void(c.status=!1);c.time=e.time,c.security_count=e.security_count,c.risk_count=e.risk_count}}catch{c.status=!1}})(),X(()=>{y()}),(e,t)=>{const a=l,i=tt,r=Re;return N(),I("div",Fi,[D("div",$i,[D("div",{class:Z("progresscirclebar "+(S(c).status?"security ":"")+"text-["+(100===S(c).security_count?" #20a53a ":" #fc6d26 ")+"]")},[S(c).status?(N(),I(_,{key:1},[S(s).scanStatus&&!S(s).isEnd?(N(),I("div",Xi,[k(i,{class:"animate-spin",type:"circle",percentage:70,"stroke-width":4,color:S(s).warn||S(s).error?"#fc6d26":"#20a53a"},{default:U(()=>[Q(j(),1)]),_:1},8,["color"]),D("div",Ki,[k(a,{name:"firewall-icon-safe-detect"+(S(s).warn||S(s).error?"-org":""),size:50},null,8,["name"]),D("span",qi,j(e.$t("Home.Security.index_41")),1)])])):(N(),E(i,{key:1,type:"circle",percentage:S(c).security_count,color:100===S(c).security_count?"#20a53a":"#fc6d26"},{default:U(()=>[Q(j(S(c).security_count),1)]),_:1},8,["percentage","color"]))],64)):(N(),E(a,{key:0,size:100,name:"firewall-icon-safe-detect"}))],2)]),D("div",el,[D("div",tl,[S(s).isEnd?(N(),I(_,{key:1},[t[2]||(t[2]=Q(" Testing completed ",-1)),S(s).error>0||S(s).warn>0?(N(),I(_,{key:0},[t[1]||(t[1]=Q(" ，Found ",-1)),S(s).warn>0?(N(),I(_,{key:0},[D("span",al,j(S(s).warn),1),t[0]||(t[0]=Q(" risk items ",-1))],64)):H("",!0)],64)):H("",!0)],64)):(N(),I(_,{key:0},[Q(j(S(d)),1)],64))]),S(s).scanStatus?(N(),E(i,{key:0,percentage:S(s).progress,color:S(s).warn||S(s).error?"#fc6d26":"#20a53a","stroke-width":10},null,8,["percentage","color"])):H("",!0),D("div",il,j(S(p)),1)]),D("div",null,[k(r,{size:"large",type:S(s).scanStatus&&!S(s).isEnd?"warning":"primary",onClick:M,plain:!(!S(s).scanStatus||S(s).isEnd)},{default:U(()=>[Q(j(S(s).scanStatus&&!S(s).isEnd?"Cancel Scan":(S(s).isEnd,e.$t("Home.Security.index_41"))),1)]),_:1},8,["type","plain"])])])}}}),sl=s(ll,[["__scopeId","data-v-0a5f55f9"]]),rl={class:"progress-cont-list scrollable"},nl=["onClick"],ol={class:"progress_type"},cl={class:"progress_status"},ul={key:0,class:"text-error"},dl={key:1,class:"text-warning"},ml={key:1},pl={key:2,class:"text-font2"},gl={key:0},vl={key:0,class:"progress_fold"},yl={class:"progress_item_body"},xl={class:"info_cont"},fl={class:"info_cont_desc"},Ml=w({__name:"server-list",setup(e){const t=Vi(),{serverScanParams:a,checkTopic:i,isScan:s}=b(t),r=[{color:"#888",text:"Not Installed"},{color:"#666",text:"Good"},{color:"#e6a23c",text:"Warn"},{color:"red",text:"Danger"}],n={system_account:"System Account",sshd_service:"SSHD Remote Service",file_mode:"Important file permissions and attributes",software:"Key software detection",other:"Other project testing",backdoor:"Backdoor Detection",proc:"Malicious processes",history:"History Commands",log:"Log troubleshooting",rootkit:"Rootkit detection"};return(e,t)=>{const o=l;return N(),I("div",rl,[(N(),I(_,null,A(n,(t,l)=>D("div",{key:l,class:Z([l+"_item "+(S(a).active[l]?"active":""),"progress_item"])},[D("div",{class:"progress_item_header",onClick:e=>(e=>{a.value.active[e]=!a.value.active[e]})(l)},[D("div",ol,[k(o,{class:"title-icon",name:"firewall-icon-"+l},null,8,["name"]),D("span",null,j(t),1)]),D("div",cl,[S(a).statusTotal[l]?(N(),I(_,{key:0},[S(a).statusTotal[l][3]||S(a).statusTotal[l][2]?(N(),I(_,{key:0},[S(a).statusTotal[l][3]?(N(),I("span",ul,j(S(a).statusTotal[l][3])+" "+j(e.$t("Home.Security.index_89")),1)):H("",!0),S(a).statusTotal[l][2]?(N(),I("span",dl,j((S(a).statusTotal[l][3]?"":"Found ")+S(a).statusTotal[l][2])+" "+j(e.$t("Database.tools.index_20")),1)):H("",!0)],64)):S(a).scanStatus&&S(i)==l?(N(),I("span",ml,j(e.$t("Home.Security.index_97"))+"... ",1)):(N(),I("span",pl,j(e.$t("Home.Security.index_98")),1))],64)):(N(),I(_,{key:1},[S(a).scanStatus&&!S(a).statusTotal[l]?(N(),I("span",gl,j(e.$t("Home.Security.index_99")),1)):H("",!0)],64))]),S(s)?(N(),I("div",vl,[k(o,{name:"base-arrow-bottom"})])):H("",!0)],8,nl),D("div",yl,[S(a).progressConfig[l]&&S(a).progressConfig[l].length?(N(!0),I(_,{key:0},A(S(a).progressConfig[l],(e,t)=>(N(),I("div",{key:t,class:Z([e.info?"active":"","progress_item_info"])},[D("div",xl,[D("div",null,j(e.name),1),D("div",{class:Z("text-["+r[e.status<0?0:e.status].color+"]")},j(r[e.status<0?0:e.status].text),3)]),D("div",fl,j(e.info||""),1)],2))),128)):H("",!0)])],2)),64))])}}}),hl=s(Ml,[["__scopeId","data-v-9466c95d"]]),bl={class:"text-20px"},wl=w({__name:"index",setup:e=>(e,t)=>(N(),I(_,null,[D("div",bl,j(e.$t("Home.Security.index_96")),1),k(sl),k(hl)],64))}),kl={class:"h-600px"};e("_",w({__name:"index",setup(e){const t=ot(),{menu:i}=b(t),s=[{key:"overview",label:()=>{const e="overview"===i.value;return k(l,{size:32,name:e?"home-aapanel-active":"home-aapanel"},null)},component:li},{key:"risk",label:()=>{const e="risk"===i.value?"home-risk-active":"home-risk";return k(dt,{value:mt("risk"),iconName:e},null)},component:Ji},{key:"file",label:()=>{const e="file"===i.value?"home-ware-active":"home-ware";return k(dt,{value:mt("file"),iconName:e},null)},component:Ut},{key:"loophole",label:()=>{const e="loophole"===i.value?"home-web-active":"home-web";return k(dt,{value:mt("loophole"),iconName:e},null)},component:Ia},{key:"server",label:()=>{const e="server"===i.value?"home-safeDetect-active":"home-safeDetect";return k(dt,{value:mt("server"),iconName:e},null)},component:wl},{key:"global",label:()=>{const e="global"===i.value;return k(l,{size:32,name:e?"home-alarm-active":"home-alarm"},null)},component:Yt}];return i.value="overview",(e,t)=>{const l=f,r=v,n=a,o=Fe;return N(),I("div",kl,[k(l,{"is-icon":"",value:S(i),"onUpdate:value":t[0]||(t[0]=e=>L(i)?i.value=e:null),data:s,class:"relative"},null,8,["value"]),k(o,{size:3,class:"absolute right-[2rem] top-[1rem] items-center!"},{default:U(()=>[k(n,{"icon-name":"demand"},{default:U(()=>[k(r,{href:"mailto:support@aapanel.com",target:"_blank"},{default:U(()=>t[1]||(t[1]=[Q("support@aapanel.com",-1)])),_:1,__:[1]})]),_:1})]),_:1})])}}}))}}});
