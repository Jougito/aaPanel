const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/HighRiskSection.js?v=1760428868419","js/vue.js?v=1760428868419","js/__commonjsHelpers__.js?v=1760428868419","js/page_layout.js?v=1760428868419","js/naive.js?v=1760428868419","js/common.js?v=1760428868419","js/public.js?v=1760428868419","css/public.css?v=1760428868419","css/page_layout.css?v=1760428868419","css/HighRiskSection.css?v=1760428868419","js/MidRiskSection.js?v=1760428868419","css/MidRiskSection.css?v=1760428868419","js/CveSection.js?v=1760428868419","css/CveSection.css?v=1760428868419","js/LowRiskSection.js?v=1760428868419","css/LowRiskSection.css?v=1760428868419","js/MaliciousSection.js?v=1760428868419","css/MaliciousSection.css?v=1760428868419","js/WebVulnSection.js?v=1760428868419","css/WebVulnSection.css?v=1760428868419","js/ServerSecSection.js?v=1760428868419","css/ServerSecSection.css?v=1760428868419","js/html2pdf.js?v=1760428868419"])))=>i.map(i=>d[i]);
import{u as s,S as t,a as e,m as i,p as a}from"./page_layout.js?v=1760428868419";import{b as l}from"./public.js?v=1760428868419";import{B as n}from"./index42.js?v=1760428868419";import{k as r,e as o,r as c,c as d,_ as u,o as v,a2 as p,V as m,a3 as _,S as g,R as h,a4 as f,H as w,U as b,F as y,O as S,j as k,an as x,a7 as T}from"./vue.js?v=1760428868419";import"./naive.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index103.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang13.js?v=1760428868419";import"./soft.js?v=1760428868419";import"./site.js?v=1760428868419";import"./index168.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1760428868419";const L={id:"reportContent",class:"report-content"},j={class:"report-page cover-page"},H={class:"cover-header"},M={class:"report-date"},R={class:"cover-content"},z={class:"level-badge"},E={class:"stats-summary"},A={class:"stats-item"},D={class:"stats-icon warning-icon"},V=["innerHTML"],N={class:"stats-info"},C={class:"stats-value"},O={class:"stats-item"},P={class:"stats-icon cve-icon"},I=["innerHTML"],q={class:"stats-info"},F={class:"stats-value"},U={class:"stats-item"},B={class:"stats-icon scan-icon"},W=["innerHTML"],K={class:"stats-info"},X={class:"stats-value"},Y={class:"cover-info"},G={class:"info-grid"},J={class:"info-item"},Q={class:"info-value"},Z={class:"info-item"},$={class:"info-value"},ss={class:"info-item"},ts={class:"info-value"},es={class:"info-item"},is={class:"info-value"},as={class:"report-page toc-page"},ls={class:"toc-content"},ns={class:"toc-title"},rs={class:"toc-page"},os={class:"report-page content-page"},cs={class:"security-rating"},ds={class:"rating-value"},us={class:"rating-info"},vs=["innerHTML"],ps={class:"rating-date"},ms={class:"last-scan"},_s={class:"report-page content-page"},gs={class:"security-stats"},hs={class:"stats-row"},fs={class:"stats-icon warning-icon"},ws=["innerHTML"],bs={class:"stats-content"},ys={class:"stats-breakdown"},Ss={class:"stats-item high"},ks={class:"stats-item medium"},xs={class:"stats-item low"},Ts={class:"stats-row"},Ls={class:"stats-icon scan-icon"},js=["innerHTML"],Hs={class:"stats-content"},Ms={class:"stats-breakdown breakdown-block"},Rs={class:"breakdown-group"},zs={class:"group-items"},Es={class:"stats-item db-item"},As={class:"breakdown-group"},Ds={class:"group-items"},Vs={class:"stats-item scan-item"},Ns={class:"stats-item scan-item"},Cs={class:"stats-item scan-item"},Os={class:"page-header"},Ps={key:0},Is={class:"page-number"},qs={class:"report-page content-page"},Fs={class:"page-header"},Us={class:"page-number"},Bs={class:"scan-stats"},Ws={class:"stats-row"},Ks={class:"stats-value"},Xs={class:"stats-row"},Ys={class:"stats-value"},Gs={class:"stats-row"},Js={class:"stats-value"},Qs={class:"stats-info"},Zs={class:"stats-desc"},$s={class:"stats-desc"},st={class:"stats-desc"},tt=a(r({__name:"risk-report",setup(a,{expose:r}){const tt='<svg\r\n  t="1658198918096"\r\n  viewBox="0 0 1024 1024"\r\n  version="1.1"\r\n  xmlns="http://www.w3.org/2000/svg"\r\n  p-id="3020">\r\n  <path\r\n    d="M512 64q190.016 4.992 316.512 131.488T960 512q-4.992 190.016-131.488 316.512T512 960q-190.016-4.992-316.512-131.488T64 512q4.992-190.016 131.488-316.512T512 64z m0 192q-26.016 0-43.008 19.008T453.984 320l23.008 256q2.016 14.016 11.488 22.496t23.488 8.512 23.488-8.512 11.488-22.496l23.008-256q2.016-26.016-15.008-44.992T511.936 256z m0 512q22.016-0.992 36.512-15.008t14.496-36-14.496-36.512T512 665.984t-36.512 14.496-14.496 36.512 14.496 36T512 768z"\r\n    p-id="3021">\r\n  </path>\r\n</svg>\r\n',et="<svg class='icon' viewBox='0 0 1024 1024' xmlns='http://www.w3.org/2000/svg' data-spm-anchor-id='a313x.7781069.0.i7'>\r\n\t<path d='M842.667 981.333H181.333A53.393 53.393 0 0 1 128 928V96a53.393 53.393 0 0 1 53.333-53.333H648.08a52.987 52.987 0 0 1 37.713 15.62L880.38 252.873A52.987 52.987 0 0 1 896 290.587V928a53.393 53.393 0 0 1-53.333 53.333zm-661.334-896A10.667 10.667 0 0 0 170.667 96v832a10.667 10.667 0 0 0 10.666 10.667h661.334A10.667 10.667 0 0 0 853.333 928V298.667h-160A53.393 53.393 0 0 1 640 245.333v-160zM682.667 115.5v129.833A10.667 10.667 0 0 0 693.333 256h129.834zM704 768H320a21.333 21.333 0 0 1 0-42.667h384A21.333 21.333 0 0 1 704 768zm0-213.333H320A21.333 21.333 0 0 1 320 512h384a21.333 21.333 0 0 1 0 42.667zm-213.333-256H320A21.333 21.333 0 0 1 320 256h170.667a21.333 21.333 0 0 1 0 42.667z' />\r\n</svg>\r\n",it=s(),at=o({first:null,second:null,third:null,fourth:null,fifth:null,sixth:null,malicious_files:null,website_vulnerabilities:null,server_security:null}),lt=c(!1),nt=[{key:"high_risk",title:"High-risk issues",component:u(()=>e(()=>import("./HighRiskSection.js?v=1760428868419"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),data:()=>{var s;return null==(s=at.fifth)?void 0:s.focus_high_list},pageSize:2},{key:"mid_risk",title:"Mid-risk issues",component:u(()=>e(()=>import("./MidRiskSection.js?v=1760428868419"),__vite__mapDeps([10,1,2,3,4,5,6,7,8,11]))),data:()=>{var s;return null==(s=at.fifth)?void 0:s.focus_mid_list},pageSize:2},{key:"cve",title:"CVE vulnerabilities",component:u(()=>e(()=>import("./CveSection.js?v=1760428868419"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,13]))),data:()=>{var s;return null==(s=at.fifth)?void 0:s.focus_cve_list},pageSize:2},{key:"low_risk",title:"Low-risk issues",component:u(()=>e(()=>import("./LowRiskSection.js?v=1760428868419"),__vite__mapDeps([14,1,2,3,4,5,6,7,8,15]))),data:()=>{var s;return null==(s=at.sixth)?void 0:s.low_warn_list},pageSize:2},{key:"malicious",title:"Malicious file detection",component:u(()=>e(()=>import("./MaliciousSection.js?v=1760428868419"),__vite__mapDeps([16,1,2,3,4,5,6,7,8,17]))),data:()=>{var s;return null==(s=at.malicious_files)?void 0:s.detected},pageSize:8},{key:"web_vuln",title:"Website vulnerability detection",component:u(()=>e(()=>import("./WebVulnSection.js?v=1760428868419"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,19]))),data:()=>{var s;return null==(s=at.website_vulnerabilities)?void 0:s.info},pageSize:1},{key:"server_sec",title:"Server security detection",component:u(()=>e(()=>import("./ServerSecSection.js?v=1760428868419"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,21]))),data:()=>{var s;return null==(s=at.server_security)?void 0:s.server_security_list},pageSize:8}];const rt=d(()=>nt.map(s=>{const t=function(s,t){if(!s||!s.length)return[];const e=[];for(let i=0;i<s.length;i+=t)e.push(s.slice(i,i+t));return e}(s.data(),s.pageSize);return{...s,pages:t,pageCount:t.length}})),ot=d(()=>{let s=3;const t=[{title:"Security Rating Overview",page:s++},{title:"Security Overview Statistics",page:s++}];return rt.value.forEach(e=>{e.pageCount&&(t.push({title:e.title,page:s}),s+=e.pageCount)}),t.push({title:"Scan Statistics",page:s++}),t});function ct(s,t=0){let e=4;for(const i of rt.value){if(i.key===s)return e+t;e+=i.pageCount}return e}return v(()=>{(async()=>{try{lt.value=!0;const{message:s}=await n();s&&"object"==typeof s&&(at.first=s.first||null,at.second=s.second||null,at.third=s.third||null,at.fourth=s.fourth||null,at.fifth=s.fifth||null,at.sixth=s.sixth||null,at.malicious_files=s.malicious_files||null,at.website_vulnerabilities=s.website_vulnerabilities||null,at.server_security=s.server_security||null)}finally{lt.value=!1}})()}),r({onConfirm:async()=>{if(it.isFree)return void l({source:399});const s=i.loading("Exporting PDF...");try{const s=await e(()=>import("./html2pdf.js?v=1760428868419").then(s=>s.h),__vite__mapDeps([22,2,3,1,4,5,6,7,8])),t=document.getElementById("reportContent");if(!t)return void i.error("Failed to get report content");const a={margin:0,filename:"Security Scan Report_".concat((new Date).toISOString().split("T")[0],".pdf"),image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,allowTaint:!0,scrollX:0,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};await s.default().set(a).from(t).save(),i.success("PDF export successful")}catch(t){i.error("PDF export failed")}finally{s.close()}}}),(s,e)=>{const i=t;return m(),p(i,{show:b(lt),description:"Loading...",class:"p-20px"},{default:_(()=>{var s,t,i,a,l,n,r,o,c,d,u,v,_,it,lt,nt,dt,ut,vt,pt,mt,_t,gt,ht,ft,wt,bt,yt,St,kt,xt,Tt,Lt,jt,Ht,Mt,Rt,zt;return[g("div",L,[g("div",j,[g("div",H,[e[0]||(e[0]=g("div",{class:"logo"},[g("img",{src:"/static/vite/images/aapanel.png",alt:"Logo"}),g("div",{class:"logo-text"},"aaPanel Security")],-1)),g("div",M,f((new Date).toISOString().split("T")[0]),1)]),g("div",R,[e[5]||(e[5]=g("h1",{class:"report-title"},"Security Scan Report",-1)),g("div",{class:w(["security-level","level-"+((null==(t=null==(s=b(at).second)?void 0:s.level)?void 0:t.toLowerCase())||"normal")])},[g("div",z,f((null==(i=b(at).second)?void 0:i.level)||"Unknown"),1),e[1]||(e[1]=g("div",{class:"level-text"},"Security Level",-1))],2),g("div",E,[g("div",A,[g("div",D,[g("div",{innerHTML:b(tt),class:"w-24px h-24px text-yellow-500"},null,8,V)]),g("div",N,[g("div",C,f(Number((null==(a=b(at).fourth)?void 0:a.high_warn)||0)+Number((null==(l=b(at).fourth)?void 0:l.low_warn)||0)+Number((null==(n=b(at).fourth)?void 0:n.mid_warn)||0)),1),e[2]||(e[2]=g("div",{class:"stats-label"},"Security Risks",-1))])]),g("div",O,[g("div",P,[g("div",{innerHTML:b('<svg t="1735025023293" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10305">\r\n\t<path d="M896 170.666667H128v512h768V170.666667zM85.333333 85.333333h853.333334c23.552 0 42.666667 16.981333 42.666666 37.930667v606.805333c0 20.949333-19.114667 37.930667-42.666666 37.930667H85.333333c-23.552 0-42.666667-16.981333-42.666666-37.930667V123.264C42.666667 102.314667 61.781333 85.333333 85.333333 85.333333z m196.266667 768h460.8c14.165333 0 25.6 9.557333 25.6 21.333334v42.666666c0 11.776-11.434667 21.333333-25.6 21.333334H281.6c-14.122667 0-25.6-9.557333-25.6-21.333334v-42.666666c0-11.776 11.477333-21.333333 25.6-21.333334z m187.733333-106.666666h85.333334v128h-85.333334v-128z" p-id="10306"></path>\r\n</svg>'),class:"w-24px h-24px text-purple-500"},null,8,I)]),g("div",q,[g("div",F,f((null==(r=b(at).fourth)?void 0:r.cve_num)||0),1),e[3]||(e[3]=g("div",{class:"stats-label"},"Scan Item",-1))])]),g("div",U,[g("div",B,[g("div",{innerHTML:b(et),class:"w-24px h-24px text-blue-500"},null,8,W)]),g("div",K,[g("div",X,f(Number((null==(o=b(at).fourth)?void 0:o.web_num)||0)+Number((null==(c=b(at).fourth)?void 0:c.sys_num)||0)+Number((null==(d=b(at).fourth)?void 0:d.kernel_num)||0)),1),e[4]||(e[4]=g("div",{class:"stats-label"},"Detection Type",-1))])])])]),g("div",Y,[g("div",G,[g("div",J,[e[6]||(e[6]=g("div",{class:"info-label"},"Host Name",-1)),g("div",Q,f((null==(u=b(at).first)?void 0:u.host)||"Unknown"),1)]),g("div",Z,[e[7]||(e[7]=g("div",{class:"info-label"},"IP Address",-1)),g("div",$,f((null==(v=b(at).first)?void 0:v.ip)||"Unknown"),1)]),g("div",ss,[e[8]||(e[8]=g("div",{class:"info-label"},"Report Date",-1)),g("div",ts,f((null==(_=b(at).first)?void 0:_.date)||"Unknown"),1)]),g("div",es,[e[9]||(e[9]=g("div",{class:"info-label"},"Last Scan",-1)),g("div",is,f((null==(it=b(at).second)?void 0:it.last_date)||"Unknown"),1)])])]),e[10]||(e[10]=g("div",{class:"cover-footer"},[g("div",{class:"footer-text"},"aaPanel Security Scanning System"),g("div",{class:"footer-note"},"This report provides a comprehensive security assessment of your server.")],-1))]),g("div",as,[e[12]||(e[12]=g("div",{class:"toc-header"},[g("h2",null,"Table of Contents")],-1)),g("div",ls,[(m(!0),h(y,null,S(b(ot),(s,t)=>(m(),h("div",{class:"toc-item",key:s.title},[g("span",ns,f(t+1)+". "+f(s.title),1),e[11]||(e[11]=g("span",{class:"toc-dots"},"...",-1)),g("span",rs,f(s.page),1)]))),128))])]),g("div",os,[e[14]||(e[14]=g("div",{class:"page-header"},[g("h2",null,"1. Security Rating Overview"),g("div",{class:"page-number"},"3")],-1)),g("div",cs,[g("div",{class:w(["rating-card","level-"+((null==(lt=b(at).second)?void 0:lt.total_level.toLowerCase())||"normal")])},[g("div",ds,f((null==(nt=b(at).second)?void 0:nt.total_level)||"Unknown"),1),e[13]||(e[13]=g("div",{class:"rating-label"},"Security Level",-1))],2),g("div",us,[g("div",{class:"rating-reason",innerHTML:(null==(dt=b(at).second)?void 0:dt.level_reason)||""},null,8,vs),g("div",ps," Report Date: "+f((null==(ut=b(at).second)?void 0:ut.date)||""),1),g("div",ms," Last Scan: "+f((null==(vt=b(at).second)?void 0:vt.last_date)||""),1)])])]),g("div",_s,[e[19]||(e[19]=g("div",{class:"page-header"},[g("h2",null,"2. Security Overview Statistics"),g("div",{class:"page-number"},"4")],-1)),g("div",gs,[g("div",hs,[g("div",fs,[g("div",{innerHTML:b(tt),class:"w-24px h-24px text-yellow-500"},null,8,ws)]),g("div",bs,[g("div",null,[e[15]||(e[15]=g("div",{class:"stats-label"},"Security Risks",-1)),g("div",{class:w(["stats-value",{"text-warning!":Number((null==(pt=b(at).fourth)?void 0:pt.high_warn)||0)+Number((null==(mt=b(at).fourth)?void 0:mt.low_warn)||0)+Number((null==(_t=b(at).fourth)?void 0:_t.mid_warn)||0)>0}])},f(Number((null==(gt=b(at).fourth)?void 0:gt.high_warn)||0)+Number((null==(ht=b(at).fourth)?void 0:ht.low_warn)||0)+Number((null==(ft=b(at).fourth)?void 0:ft.mid_warn)||0)),3)]),g("div",ys,[g("span",Ss,"High: "+f((null==(wt=b(at).fourth)?void 0:wt.high_warn)||0),1),g("span",ks,"Medium: "+f((null==(bt=b(at).fourth)?void 0:bt.mid_warn)||0),1),g("span",xs,"Low: "+f((null==(yt=b(at).fourth)?void 0:yt.low_warn)||0),1)])])]),g("div",Ts,[g("div",Ls,[g("div",{innerHTML:b(et),class:"w-24px h-24px text-blue-500"},null,8,js)]),g("div",Hs,[e[18]||(e[18]=g("div",{class:"stats-label"},"Virus Database & Scan Types",-1)),g("div",Ms,[g("div",Rs,[e[16]||(e[16]=g("div",{class:"group-title db-label"},"🦠 Virus Database",-1)),g("div",zs,[g("span",Es,"Number: "+f((null==(St=b(at).fourth)?void 0:St.cve_num)||0),1)])]),g("div",As,[e[17]||(e[17]=g("div",{class:"group-title scan-label"},"🔍 Scan Types",-1)),g("div",Ds,[g("span",Vs,"Web risk: "+f((null==(kt=b(at).fourth)?void 0:kt.web_num)||0),1),g("span",Ns,"System risk: "+f((null==(xt=b(at).fourth)?void 0:xt.sys_num)||0),1),g("span",Cs,"Kernel risk: "+f((null==(Tt=b(at).fourth)?void 0:Tt.kernel_num)||0),1)])])])])])])]),(m(!0),h(y,null,S(b(rt),s=>(m(),h(y,null,[(m(!0),h(y,null,S(s.pages,(t,e)=>(m(),h("div",{key:e,class:"report-page content-page"},[g("div",Os,[g("h2",null,[k(f(s.title),1),e>0?(m(),h("span",Ps,"（Continue "+f(e+1)+"）",1)):x("",!0)]),g("div",Is,f(ct(s.key,e)),1)]),(m(),p(T(s.component),{data:t,"total-pages":s.pageCount,"page-index":e},null,8,["data","total-pages","page-index"]))]))),128))],64))),256)),g("div",qs,[g("div",Fs,[e[20]||(e[20]=g("h2",null,"Scan Statistics",-1)),g("div",Us,f(ct("stats",0)),1)]),g("div",Bs,[g("div",Ws,[e[21]||(e[21]=g("div",{class:"stats-label"},"Number of Security Scans:",-1)),g("div",Ks,f((null==(Lt=b(at).third)?void 0:Lt.warn_times)||0),1)]),g("div",Xs,[e[22]||(e[22]=g("div",{class:"stats-label"},"Number of Vulnerability Scans:",-1)),g("div",Ys,f((null==(jt=b(at).third)?void 0:jt.cve_times)||0),1)]),g("div",Gs,[e[23]||(e[23]=g("div",{class:"stats-label"},"Number of Repair Actions:",-1)),g("div",Js,f((null==(Ht=b(at).third)?void 0:Ht.repair_times)||0),1)]),g("div",Qs,[g("div",Zs,f((null==(Mt=b(at).third)?void 0:Mt.second_warn)||""),1),g("div",$s,f((null==(Rt=b(at).third)?void 0:Rt.second_cve)||""),1),g("div",st,f((null==(zt=b(at).third)?void 0:zt.repair)||""),1)])])])])]}),_:1},8,["show"])}}}),[["__scopeId","data-v-661164a0"]]);export{tt as default};
