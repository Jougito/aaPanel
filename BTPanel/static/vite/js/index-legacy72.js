System.register(["./page_layout-legacy.js?v=1760428868419","./public-legacy.js?v=1760428868419","./vue-legacy.js?v=1760428868419","./naive-legacy.js?v=1760428868419","./index.vue_vue_type_script_setup_true_lang-legacy15.js?v=1760428868419","./index-legacy.js?v=1760428868419","./echartsGl-legacy.js?v=1760428868419","./common-legacy.js?v=1760428868419","./interface-legacy.js?v=1760428868419","./echarts-legacy.js?v=1760428868419","./tools-legacy2.js?v=1760428868419","./__commonjsHelpers__-legacy.js?v=1760428868419","./rules-legacy.js?v=1760428868419"],function(e,t){"use strict";var a,l,o,i,r,n,s,d,c,u,p,v,f,m,x,h,b,y,g,w,_,k,S,O,W,$,C,j,L,z,T,D,E,q,M,R,A,I,G,U,N,H,P,B,F,V,Q,X,Y,Z,J,K,ee,te,ae,le,oe,ie,re,ne,se,de,ce,ue,pe,ve,fe,me,xe,he,be,ye;return{setters:[e=>{a=e.p,l=e.d8,o=e.q,i=e.a5,r=e.a8,n=e.bf,s=e.d9,d=e.w,c=e.S,u=e.k,p=e.o,v=e.a,f=e.da,m=e.am,x=e.db,h=e.d,b=e.j,y=e.dc,g=e.s,w=e.ct},e=>{_=e.l,k=e.e,S=e.c,O=e.h,W=e.a},e=>{$=e.a2,C=e.V,j=e.a3,L=e.q,z=e.k,T=e.am,D=e.e,E=e.S,q=e.W,M=e.a4,R=e.U,A=e.r,I=e.P,G=e.ae,U=e.y,N=e.R,H=e.ak,P=e.F,B=e.O,F=e.j,V=e.X,Q=e.a0,X=e.aG,Y=e.an,Z=e.H,J=e._,K=e.w,ee=e.n,te=e.av,ae=e.o,le=e.b},e=>{oe=e.dS,ie=e.dh,re=e.bH,ne=e.dT,se=e.dZ,de=e.G,ce=e.dj,ue=e.e2},e=>{pe=e._},e=>{ve=e._},e=>{fe=e.i,me=e.a,xe=e.b},e=>{he=e.a0},null,e=>{be=e.ac},e=>{ye=e.a},null,null],execute:function(){var ge=document.createElement("style");ge.textContent='.wap-card[data-v-93a608a4]{--n-border-radius: 6px;--n-title-font-size: 14px;box-shadow:0 1px 3px 1px rgba(0,0,0,.05)}.wap-card[data-v-93a608a4] .n-card-header{height:50px;padding:0 16px}.refresh-progress[data-v-8898e53f]{width:28px;cursor:pointer}.bt-radio[data-v-f8a2b372] .n-radio-button:last-child{border-right:none;border-top-right-radius:0;border-bottom-right-radius:0}.bt-date-picker[data-v-f8a2b372] .n-input{border-top-left-radius:0;border-bottom-left-radius:0}.count-item[data-v-a0dab078]{color:var(--waf-overview-text-color)}.count-item+.count-item[data-v-a0dab078]{padding-top:20px;margin-top:20px;border-top:1px solid var(--color-border)}.count-item .count-tit[data-v-a0dab078]{margin-bottom:12px;font-size:14px}.count-item .count-val[data-v-a0dab078]{display:flex;align-items:baseline;padding-left:12px}.count-item .count-num[data-v-a0dab078]{font-size:22px;font-weight:700;cursor:pointer}.district-legend[data-v-24df7b56]{position:absolute;left:4%;bottom:4%;display:flex;align-items:center;color:var(--color-text-2)}.district-legend .item[data-v-24df7b56]{width:15px;height:4px}.district-legend .item+.item[data-v-24df7b56]{margin-left:6px}.district-legend .item[data-v-24df7b56]:nth-of-type(1){background-color:rgba(62,183,82,.125)}.district-legend .item[data-v-24df7b56]:nth-of-type(2){background-color:rgba(62,183,82,.5)}.district-legend .item[data-v-24df7b56]:nth-of-type(3){background-color:#3eb752}.attack-map{width:100%;height:100%}.attack-map>div:first-child:before{content:"";background:radial-gradient(closest-side,#fff,var(--color-bg-1));border-radius:100%;width:464px;height:464px;display:inline-block;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;border:26px solid var(--color-bg-2)}.attack-map>div:first-child:after{content:"";background:var(--color-bg-2);border-radius:100%;display:inline-block;width:534px;height:534px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;border:10px solid var(--color-bg-1)}.attack-map canvas{z-index:4}\n/*$vite$:1*/',document.head.appendChild(ge);const we=a({},[["render",function(e,t){const a=oe;return C(),$(a,{class:"wap-card"},{header:j(()=>[L(e.$slots,"header",{},void 0,!0)]),default:j(()=>[L(e.$slots,"default",{},void 0,!0)]),_:3})}],["__scopeId","data-v-93a608a4"]]),_e={class:"flex items-center h-184px text-font3 color-[var(--waf-overview-text-color)]"},ke={class:"flex-1 flex-center flex-col"},Se={class:"flex items-center mb-16px"},Oe={class:"ml-8px text-14px"},We={class:"text-22px font-bold"},$e={class:"flex-1 flex-center flex-col"},Ce={class:"flex items-center mb-16px"},je={class:"ml-8px text-14px"},Le=z({__name:"index",setup(e){const t=l(),a=T(),i=D({request:0,malicious:0}),r=()=>{a.push("/waf/block")};return t.onReady("total",e=>{i.request=e.count.today_request,i.malicious=e.count.malicious_request}),(e,t)=>{const a=o;return C(),$(we,null,{default:j(()=>[E("div",_e,[E("div",ke,[E("div",Se,[t[0]||(t[0]=E("img",{class:"icon",src:"/static/vite/images/today.svg"},null,-1)),E("span",Oe,M(e.$t("Waf.Overview.index_1")),1)]),E("div",We,M(R(i).request),1)]),q(a,{class:"text-106px",vertical:""}),E("div",$e,[E("div",Ce,[t[1]||(t[1]=E("img",{class:"icon",src:"/static/vite/images/malicious.svg"},null,-1)),E("span",je,M(e.$t("Waf.Overview.index_2")),1)]),E("div",{class:"text-22px font-bold cursor-pointer",onClick:r},M(R(i).malicious),1)])])]),_:1})}}}),ze={class:"text-desc text-12px leading-1"},Te=z({__name:"auto-refresh",props:{open:{type:Boolean,default:!0},seconds:{default:3},refresh:{}},setup(e){const t=e,a=t.seconds,l=A(0),o=A(a),i=A(!1),{loop:r}=_(async()=>{if(0===o.value)try{i.value=!0,await(t.refresh?.())}finally{l.value=0,o.value=a,i.value=!1}else o.value-=1,l.value=(a-o.value)/a*100},1);return r(),(e,t)=>{const r=re,n=ie;return C(),$(n,{placement:"bottom"},{trigger:j(()=>[q(r,{class:"refresh-progress",type:"circle",status:"success",processing:R(i),"rail-color":"#e8e8e8","stroke-width":12,"offset-degree":180,percentage:R(l)},{default:j(()=>[E("span",ze,M(R(o)),1)]),_:1},8,["processing","percentage"])]),default:j(()=>[E("span",null,M(e.$t("Waf.Overview.index_8",[R(a)])),1)]),_:1})}}}),De=a(Te,[["__scopeId","data-v-8898e53f"]]),Ee={class:"flex"},qe=a(z({__name:"query-date",props:{value:{default:"today"},valueModifiers:{}},emits:["update:value"],setup(e){const{t:t}=I(),a=A("today"),l=A(null),o=G(e,"value"),s=[{label:t("Public.Search.Yesterday"),value:"yesterday"},{label:t("Public.Search.Today"),value:"today"}],d=e=>{l.value=null,o.value=e},c=e=>{a.value=e?"":"today",o.value=n(e)?r(e,"yyyy-MM-dd"):"today"};return U(()=>{s.map(e=>e.value).includes(o.value)?(a.value=o.value,l.value=null):(a.value="",l.value=new Date(o.value).getTime())}),(e,t)=>{const o=se,r=ne,n=i;return C(),N("div",Ee,[q(r,{value:R(a),"onUpdate:value":[t[0]||(t[0]=e=>H(a)?a.value=e:null),d],size:"small",class:"bt-radio"},{default:j(()=>[(C(),N(P,null,B(s,e=>q(o,{key:e.value,value:e.value},{default:j(()=>[F(M(e.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"]),q(n,{value:R(l),"onUpdate:value":[t[1]||(t[1]=e=>H(l)?l.value=e:null),c],type:"date",size:"small",class:"bt-date-picker",clearable:!0},null,8,["value"])])}}}),[["__scopeId","data-v-f8a2b372"]]),Me={class:"flex justify-between flex-1"},Re={class:"flex items-center"},Ae={class:"mr-10px"},Ie={class:"flex-center h-134px p-10px"},Ge=z({__name:"index",setup(e){const{t:t}=I(),a=V("--chart-tooltip-bg-color"),o=V("--color-text-2"),i=V("--color-border"),n=l(),{loading:u,startTime:p}=Q(n),v=A(!0),f=()=>{n.getInfo()},m=async()=>{await n.getNewInfo()},x=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:o.value},nameTextStyle:{color:o.value},axisLine:{show:!0,lineStyle:{color:i.value}},axisTick:{show:!0,lineStyle:{color:i.value}}}),h=(e=[],a=[])=>[{name:t("Waf.Overview.index_4"),type:"line",data:e,symbol:"none",sampling:"average",smooth:!0,showSymbol:!1,itemStyle:{color:"#A0BFE0"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(242, 242, 242, 0.6)"},{offset:.8,color:"rgba(242, 242, 242, 0)"}]}}},{name:t("Waf.Overview.index_5"),type:"line",data:a,sampling:"average",smooth:!0,symbol:"none",showSymbol:!1,itemStyle:{color:"#20a53a"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.6)"},{offset:1,color:"rgba(32, 164, 58, 0)"}]}}}],b=X({grid:{left:"5%",right:"4%",bottom:"3%",top:"20%",containLabel:!0},legend:{icon:"circle",data:[t("Waf.Overview.index_5"),t("Waf.Overview.index_4")],top:"-2%",itemWidth:10,itemHeight:10,itemGap:16,textStyle:{color:o.value,lineHeight:12,padding:[0,0,-2,0],rich:{a:{verticalAlign:"middle"}}}},tooltip:{trigger:"axis",backgroundColor:a.value,borderColor:"transparent",textStyle:{color:"#c7c7c7"},formatter(e){let a="";const l=Object.entries(e);return l.forEach(([,e],o)=>{0===o&&(a+=`${t("Waf.Overview.index_6",[r(s(p.value),"yyyy-MM-dd"),e.name])}<br />`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}<br />`,o===l.length-1&&(a+=`<div style="padding-left: 20px;">${t("Waf.Overview.index_7_1",[e.data.err_499])}<br />${t("Waf.Overview.index_7_2",[e.data.err_502])}</div>`)}),a}},xAxis:x(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:i.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:o.value},nameTextStyle:{color:o.value}},series:h()});return n.onReady("flow",e=>{d(e.traffic_filter)&&e.traffic_filter.length>0?(v.value=!1,(e=>{const t=[],a=[],l=[];e.forEach(e=>{const o=e.hour<10?"0"+e.hour:e.hour,i=e.minute<10?"0"+e.minute:e.minute;t.push(`${o}:${i}`),a.push(e.proxy_count),l.push({value:e.request,err_499:e.err_499,err_502:e.err_502})}),b.xAxis=x(t),b.series=h(a,l)})(e.traffic_filter)):v.value=!0}),(e,t)=>{const a=de,l=c;return C(),$(we,null,{header:j(()=>[E("div",Me,[E("div",Re,[E("div",Ae,M(e.$t("Waf.Overview.index_3")),1),q(qe,{value:R(p),"onUpdate:value":[t[0]||(t[0]=e=>H(p)?p.value=e:null),f]},null,8,["value"])]),q(De,{refresh:m})])]),default:j(()=>[q(l,{show:R(u)},{default:j(()=>[E("div",Ie,[R(v)?(C(),$(a,{key:0})):(C(),$(pe,{key:1,type:"line",height:"100%",option:R(b)},null,8,["option"]))])]),_:1},8,["show"])]),_:1})}}}),Ue={class:"h-134px p-10px"},Ne=z({__name:"index",setup(e){const{t:t}=I(),a=V("--chart-tooltip-bg-color"),o=V("--color-text-2"),i=V("--color-border"),n=l(),s=A(0),d=(e=[])=>({type:"category",boundaryGap:!1,data:e,axisLabel:{color:o.value,formatter:e=>r(u(e),"hh:mm:ss")},nameTextStyle:{color:o.value},axisLine:{show:!0,lineStyle:{color:i.value}},axisTick:{show:!0,lineStyle:{color:i.value}}}),c=(e=[])=>[{name:"QPS",type:"line",stack:"Total",data:e,itemStyle:{color:"#20a53a"},smooth:!0,showSymbol:!1,sampling:"average",areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"rgba(32, 164, 58, 0.4)"},{offset:.7,color:"rgba(32, 164, 58, 0)"}]}}}],p=X({grid:{left:"5%",right:"10%",bottom:"3%",top:"20%",containLabel:!0},tooltip:{trigger:"axis",backgroundColor:a.value,borderColor:"transparent",textStyle:{color:"#c7c7c7"},formatter(e){let a="";return Object.entries(e).forEach(([,e],l)=>{0===l&&(a+=`${t("Waf.Overview.index_22",[r(e.axisValue)])}<br>`),a+=`<span style="display: inline-block; width: 10px; height: 10px; margin-right:10px; border-radius: 50%;background: ${e.color};"></span>${e.seriesName}: ${e.value}`}),a}},xAxis:d(),yAxis:{type:"value",nameGap:8,splitNumber:4,splitLine:{show:!0,lineStyle:{type:"dashed",width:1,color:i.value}},axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:o.value},nameTextStyle:{color:o.value}},series:c()}),v=[],f=[],m=()=>{var e;v.length>0&&(e=v[0],(new Date).getTime()-e>6e4)&&(v.shift(),f.shift()),p.xAxis=d(v),p.series=c(f)};return n.onReady("qps",e=>{s.value=e.qps,v.push(Date.now()),f.push(e.qps),m()}),(e,t)=>(C(),$(we,null,{header:j(()=>[E("span",null,M(e.$t("Waf.Overview.index_21",[R(s)])),1)]),default:j(()=>[E("div",Ue,[q(pe,{type:"line",height:"100%",option:R(p)},null,8,["option"])])]),_:1}))}}),He={class:"flex-center h-292px p-10px"},Pe=z({__name:"index",setup(e){const{t:t}=I(),a=V("--color-bg-2"),o=V("--color-text-1"),i=V("--color-text-2"),r=V("--color-text-3"),n=V("--color-border"),s=l(),d=A(!1),c=X({backgroundColor:a.value,title:u(),tooltip:{trigger:"item",confine:!0,formatter(e){const t=e;return`${t.marker} ${t.name}: ${t.value} (${t.percent}%)`}},series:v()});function u(e=0){return{text:t("Waf.Overview.index_32"),textStyle:{color:o.value,fontSize:17},subtext:`${e}`,subtextStyle:{color:i.value,fontSize:15},itemGap:20,left:"center",top:"42%"}}const p=["#6ec71e","#4885FF","#fc8b40","#818af8","#31c9d7","#f35e7a","#ab7aee","#14d68b","#cde5ff"];function v(e=[]){return[{type:"pie",data:e,radius:["45%","55%"],center:["50%","50%"],clockwise:!0,avoidLabelOverlap:!0,label:{show:!0,position:"outside",color:r.value,lineHeight:18,formatter:e=>""!==e.name?0===e.percent?"":t("Waf.Overview.index_33",[e.name,e.value,e.percent]):""},labelLine:{length:30,length2:30,lineStyle:{width:1,color:n.value}},itemStyle:{labelLine:{length:30,length2:30,lineStyle:{width:1,color:n.value}},color:e=>p[e.dataIndex]},emphasis:{scaleSize:15}}]}return s.onReady("block",e=>{d.value=0===e.type.length,(e=>{let t=0;const a=[];e.forEach(e=>{t+=e[1],a.push({name:e[0],value:e[1]})}),c.title=u(t),c.series=v(a)})(e.type)}),(e,t)=>{const a=de;return C(),$(we,{class:"mb-16px"},{header:j(()=>[E("span",null,M(e.$t("Waf.Overview.index_31")),1)]),default:j(()=>[E("div",He,[R(d)?(C(),$(a,{key:0})):(C(),$(pe,{key:1,type:"pie",height:"100%",option:R(c)},null,8,["option"]))])]),_:1})}}}),Be={class:"flex flex-col justify-center h-306px p-20px"},Fe={class:"count-item"},Ve={class:"count-tit"},Qe={class:"count-val"},Xe={class:"count-item"},Ye={class:"count-tit"},Ze={class:"count-val"},Je={class:"count-item"},Ke={class:"count-tit"},et={class:"count-val"},tt=a(z({__name:"index",setup(e){const a=J(()=>v(()=>t.import("./shell-legacy.js?v=1760428868419"),void 0)),o=J(()=>v(()=>t.import("./site-legacy2.js?v=1760428868419"),void 0)),i=J(()=>v(()=>t.import("./cc-legacy.js?v=1760428868419"),void 0)),{t:r}=I(),n=l(),s=D({webshell:0,site:0,siteList:[],cc:0,ccList:[]}),d=k(r("Waf.Overview.index_14")),c=()=>{},u=k(r("Waf.Overview.index_15")),m=async()=>{await f(),n.getNewInfo()},x=()=>{u.data.list=s.siteList,u.show=!0},h=k(r("Waf.Overview.index_16")),b=()=>{h.data.list=s.ccList,h.show=!0};return n.onReady("count",e=>{s.webshell=e.count.webshell,s.site=e.count.unprotected_site,s.siteList=e.count.unprotected_site_list,s.cc=e.count.maybe_err_cc,s.ccList=e.count.maybe_err_cc_list}),(e,t)=>{const l=p,r=ve;return C(),$(we,null,{default:j(()=>[E("div",Be,[E("div",Fe,[E("div",Ve,M(e.$t("Waf.Overview.index_9")),1),E("div",Qe,[E("div",{class:"count-num",onClick:c},M(R(s).webshell),1)])]),E("div",Xe,[E("div",Ye,M(e.$t("Waf.Overview.index_10")),1),E("div",Ze,[E("div",{class:"count-num",onClick:x},M(R(s).site),1),R(s).site>0?(C(),N(P,{key:0},[q(l,{class:"ml-20px",onClick:m},{default:j(()=>[F(M(e.$t("Waf.Overview.index_11")),1)]),_:1}),q(l,{class:"ml-20px",onClick:x},{default:j(()=>[F(M(e.$t("Waf.Overview.index_12")),1)]),_:1})],64)):Y("",!0)])]),E("div",Je,[E("div",Ke,M(e.$t("Waf.Overview.index_13")),1),E("div",et,[E("div",{class:Z(["count-num",{"text-error":R(s).cc>0}]),onClick:b},M(R(s).cc),3),R(s).cc>0?(C(),$(l,{key:0,class:"ml-20px",onClick:b},{default:j(()=>[F(M(e.$t("Waf.Overview.index_12")),1)]),_:1})):Y("",!0)])])]),q(r,{show:R(d).show,"onUpdate:show":t[0]||(t[0]=e=>R(d).show=e),title:R(d).title,width:800,"min-height":236,component:R(a)},null,8,["show","title","component"]),q(r,{show:R(u).show,"onUpdate:show":t[1]||(t[1]=e=>R(u).show=e),title:R(u).title,data:R(u).data,width:440,"min-height":236,component:R(o)},null,8,["show","title","data","component"]),q(r,{show:R(h).show,"onUpdate:show":t[2]||(t[2]=e=>R(h).show=e),title:R(h).title,data:R(h).data,width:800,"min-height":236,component:R(i)},null,8,["show","title","data","component"])]),_:1})}}}),[["__scopeId","data-v-a0dab078"]]),at={class:"w-full h-full"},lt={class:"district-legend"},ot={class:"mr-2"},it={class:"ml-2"},rt=a(z({__name:"Map2d",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=I(),a=m(),l=V("--waf-map-color"),o=V("--waf-map-border-color"),i=X({title:{left:"center",top:"top"},grid:{top:70,bottom:40,left:0,right:0},tooltip:{padding:4,borderColor:"rgba(50, 50, 50, 0)",backgroundColor:"rgba(50, 50, 50, 0.7)",textStyle:{color:"#fff"},formatter:e=>{const a=e;let l="";const o=`${a.value}`.split(".");return l="NaN"===o[0]?a.name:`${a.name}<br />${t("Waf.Overview.index_26",[o[0]])}`,l}},visualMap:{min:0,max:100,left:-200,range:null,inRange:{color:["rgba(62, 183, 82, 0.13)","rgba(62, 183, 82, 0.5)","#3eb752"]}},series:r()});function r(e=[]){return[{name:"World Population (2010)",type:"map",map:"world",zoom:1.2,itemStyle:{borderColor:o.value,areaColor:l.value},label:{show:!1},emphasis:{itemStyle:{borderColor:o.value,areaColor:a.value.primaryColor}},data:e}]}return K(()=>e.data,e=>{ee(()=>{var t;t=e,i.series=r(t)})},{immediate:!0}),(e,t)=>(C(),N("div",at,[E("div",lt,[E("span",ot,M(e.$t("Waf.Overview.index_24")),1),t[0]||(t[0]=E("div",{class:"item"},null,-1)),t[1]||(t[1]=E("div",{class:"item"},null,-1)),t[2]||(t[2]=E("div",{class:"item"},null,-1)),E("span",it,M(e.$t("Waf.Overview.index_25")),1)]),q(pe,{type:"map",height:"100%",option:R(i)},null,8,["option"])]))}}),[["__scopeId","data-v-24df7b56"]]),nt=z({__name:"Map3d",setup(e){const t=te("mapRef");let a=null;const l=A(0),o=A(0),i=A([]),r=()=>{const e=document.createElement("canvas"),t=be.init(e,null,{width:4096,height:2048});return t.setOption({backgroundColor:{type:"linear",x:0,y:0,x2:0,y2:1,global:!1,colorStops:[{offset:0,color:"#9ed6ff"},{offset:.7,color:"#fafcfa"},{offset:1,color:"#9ed6ff"}]},series:[{type:"map",map:"world",left:0,top:0,right:0,bottom:0,boundingCoords:[[-180,90],[180,-90]],label:{show:!1,color:"#fff",fontSize:20},itemStyle:{areaColor:"#44b359",borderColor:"#fff",borderWidth:1}}]}),t},n=async()=>{if(!t.value)return;const{message:e}=await x();h(e)&&(l.value=e.load_ip.latitude,o.value=e.load_ip.longitude,i.value=e.attack_ip.map(t=>({coords:[[t.ip_longitude,t.ip_latitude],[e.load_ip.longitude,e.load_ip.latitude]],value:1}))),a=be.init(t.value);const n={tooltip:{show:!0},globe:{silent:!0,shading:"color",baseTexture:r(),viewControl:{distance:240,targetCoord:[o.value,l.value],maxDistance:240,minDistance:240,rotateSensitivity:2,autoRotateSpeed:10}},series:[{type:"bar3D",coordinateSystem:"globe",shading:"lambert",opacity:1,bevelSize:.2,itemStyle:{color:"#EBE806"},label:{show:!1,formatter:"{b}"},data:[]},{name:"lines3D",type:"lines3D",coordinateSystem:"globe",effect:{show:!0,period:2,trailWidth:4,trailLength:.5,trailOpacity:1,trailColor:"red"},blendMode:"lighter",lineStyle:{width:1,color:"red",opacity:0},data:i.value,silent:!1},{type:"lines3D",coordinateSystem:"globe",effect:{show:!0,trailWidth:5,trailOpacity:1,trailLength:.2,constantSpeed:5},blendMode:"lighter",lineStyle:{color:"#EBE806",width:1,opacity:1},data:[]}]};a.setOption(n)},s=()=>{a?.resize()};return be.use([fe,me,xe]),ae(async()=>{await(async()=>{const{data:e}=await he.get("/static/vite/data/world.json");be.registerMap("world",e)})(),n(),window.addEventListener("resize",s)}),le(()=>{a?.dispose(),a=null,window.removeEventListener("resize",s)}),(e,a)=>(C(),N("div",{ref_key:"mapRef",ref:t,class:"attack-map"},null,512))}}),st=z({__name:"Table",props:{data:{type:Array,default:()=>[]}},setup(e){const{t:t}=I(),{columns:a}=S([{key:"ip",width:120,title:t("Waf.Overview.index_27"),ellipsis:{tooltip:!0},render:e=>q("a",{class:"bt-link",href:"javascript:;",onClick:()=>{ye({ip:e.ip})}},[e.ip])},{key:"count",width:90,title:t("Waf.Overview.index_28")},{key:"address",title:t("Waf.Overview.index_29"),ellipsis:{tooltip:!0}}]);return(t,l)=>{const o=O;return C(),$(o,{"max-height":520,bordered:!1,data:e.data,columns:R(a)},null,8,["data","columns"])}}}),dt={class:"flex items-center justify-between flex-1"},ct={class:"flex items-center"},ut={class:"mr-8px text-12px"},pt={class:"bt-link text-12px",href:"/btwaf/content_report.html",target:"_blank"},vt={class:"flex gap-12px h-616px p-16px"},ft={class:"relative flex-1"},mt={class:"w-320px min-w-320px"},xt=z({__name:"index",setup(e){const{t:t}=I(),a=l(),i=A(u(b("waf-map-type","0"))),r=A(!0),n=A([]),s=A([]),d=e=>{W({title:t(e?"Waf.Overview.index_35":"Waf.Overview.index_36"),content:t(e?"Waf.Overview.index_37":"Waf.Overview.index_38"),onConfirm:async()=>{await y(),r.value=e,i.value=e?3:2,g("waf-map-type",i.value)}})},c=e=>{g("waf-map-type",e)};return a.onReady("map",e=>{n.value=e.map,s.value=e.attack_details,r.value=e["3D"],0===i.value&&(i.value=e["3D"]?3:2)}),(e,t)=>{const a=ce,l=o,u=se,p=ne;return C(),$(we,null,{header:j(()=>[E("div",dt,[E("div",null,M(e.$t("Waf.Overview.index_23")),1),E("div",ct,[E("span",ut,M(e.$t("Waf.Overview.index_34")),1),q(a,{value:R(r),size:"small","onUpdate:value":d},null,8,["value"]),q(l,{vertical:""}),E("a",pt,M(e.$t("Waf.Overview.index_30")),1)])])]),default:j(()=>[E("div",vt,[E("div",ft,[R(r)?(C(),$(p,{key:0,value:R(i),"onUpdate:value":[t[0]||(t[0]=e=>H(i)?i.value=e:null),c],class:"absolute top-0 left-0 z-1000",size:"small"},{default:j(()=>[q(u,{value:3},{default:j(()=>t[1]||(t[1]=[F("3D",-1)])),_:1,__:[1]}),q(u,{value:2},{default:j(()=>t[2]||(t[2]=[F("2D",-1)])),_:1,__:[2]})]),_:1},8,["value"])):Y("",!0),3===R(i)?(C(),$(nt,{key:1})):Y("",!0),2===R(i)?(C(),$(rt,{key:2,data:R(n)},null,8,["data"])):Y("",!0)]),E("div",mt,[q(st,{data:R(s)},null,8,["data"])])])]),_:1})}}});e("default",z({__name:"index",setup:e=>(l().getInfo(),(e,t)=>{const a=ue,l=w;return C(),N("div",null,[q(l,{"x-gap":"16","y-gap":"16"},{default:j(()=>[q(a,{span:"6 992:24"},{default:j(()=>[q(Le)]),_:1}),q(a,{span:"12 992:24"},{default:j(()=>[q(Ge)]),_:1}),q(a,{span:"6 992:24"},{default:j(()=>[q(Ne)]),_:1}),q(a,{span:"6 992:24"},{default:j(()=>[q(Pe),q(tt)]),_:1}),q(a,{span:"18 992:24"},{default:j(()=>[q(xt)]),_:1})]),_:1})])})}))}}});
