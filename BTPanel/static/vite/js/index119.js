import{_ as a}from"./index.js?v=1760428868419";import{_ as e}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419";import{c as t,d as r,h as n,f as s,e as l,a as i}from"./public.js?v=1760428868419";import{_ as o}from"./index.vue_vue_type_script_setup_true_lang.js?v=1760428868419";import{bh as d,w as p,a8 as _,d as u,x as g}from"./page_layout.js?v=1760428868419";import{h as c,i as m,g as b,j as x,k as h,l as v}from"./organization.js?v=1760428868419";import{k as w,P as f,r as C,e as y,R as k,V as j,W as U,U as P,a3 as L,a2 as R,an as T,m as $,j as z,a4 as q}from"./vue.js?v=1760428868419";import{da as E,dR as S,dV as D,au as I,dh as V,aC as B}from"./naive.js?v=1760428868419";import{_ as F}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419";const H={class:"p-20px"},O=w({__name:"form",props:{data:{}},setup(a,{expose:e}){const{t:t}=f(),r=a,{isEdit:n,row:s,getList:l,id:i}=r.data,_=C([]),u=C(null),g=y({contrast:"in",compare:"",executeType:"1",script:null,args:"",id:0}),x=y({is_args:!1,args_holder:"",args_title:""}),h=a=>$(V,{trigger:"hover",placement:"top-start"},{trigger:()=>$("span",a.label),default:()=>$("span",a.label)}),v=(a,e)=>{x.is_args=e.is_args,x.args_holder=e.args_ps,x.args_title=e.args_title},w=[{label:t("Crontab.Planned.index_3"),value:"1"}],z=[{label:t("Crontab.arrange.index_9"),value:"in"},{label:t("Crontab.arrange.index_10"),value:"not in"},{label:t("Crontab.arrange.index_11"),value:"="},{label:t("Crontab.arrange.index_12"),value:"!="}],q={compare:{required:!0,message:t("Crontab.arrange.index_8"),trigger:["blur","input"]},script:{required:!0,type:"number",message:t("Crontab.arrange.index_13"),trigger:["blur","input"]},args:{required:!0,trigger:["blur","change"],message:t("Security.Conf.Index_28")}},B=()=>({run_script_id:g.script,operator:g.contrast,op_value:g.compare,run_script:"",args:g.args,...n?{where_id:g.id}:{trigger_id:i}});return(async()=>{const{message:a}=await b();p(a)&&(_.value=a.map(a=>({label:a.name,value:a.name,children:a.script_list.map(a=>({label:a.name,value:a.script_id,is_args:a.is_args,args_ps:a.args_ps,args_title:a.args_title}))})))})(),n&&s&&(g.contrast=s.operator,g.compare=s.op_value,g.script=s.run_script_id,g.args=s.args,x.is_args=!!s.script_info.is_args,x.args_holder=s.script_info.args_ps,x.args_title=s.script_info.args_title,g.id=s.where_id),e({onConfirm:async({hide:a})=>{var e;await(null==(e=u.value)?void 0:e.validate()),n?await c(B()):await m(B()),null==l||l(),a()}}),(a,e)=>{const t=D,r=S,n=I,s=E,l=d,i=o;return j(),k("div",H,[U(i,{ref_key:"formRef",ref:u,model:P(g),rules:q},{default:L(()=>[U(s,null,{default:L(()=>[U(r,{label:a.$t("Crontab.Planned.index_23")},{default:L(()=>[U(t,{class:"w-120px!",value:P(g).contrast,"onUpdate:value":e[0]||(e[0]=a=>P(g).contrast=a),options:z},null,8,["value"])]),_:1},8,["label"]),U(r,{path:"compare"},{default:L(()=>[U(n,{class:"w-215px!",value:P(g).compare,"onUpdate:value":e[1]||(e[1]=a=>P(g).compare=a),placeholder:a.$t("Crontab.arrange.index_8")},null,8,["value","placeholder"])]),_:1})]),_:1}),U(s,null,{default:L(()=>[U(r,{label:a.$t("Docker.LocalImage.pull.index_12")},{default:L(()=>[U(t,{class:"w-120px!",value:P(g).executeType,"onUpdate:value":e[2]||(e[2]=a=>P(g).executeType=a),options:w},null,8,["value"])]),_:1},8,["label"]),U(r,{path:"script"},{default:L(()=>[U(l,{class:"w-218px!",value:P(g).script,"onUpdate:value":[e[3]||(e[3]=a=>P(g).script=a),v],filterable:!0,"check-strategy":"child","show-path":!1,placeholder:a.$t("Crontab.arrange.index_29"),options:P(_),"render-label":h},null,8,["value","placeholder","options"])]),_:1})]),_:1}),P(x).is_args?(j(),R(r,{key:0,label:P(x).args_title,path:"args"},{default:L(()=>[U(n,{class:"w-350px!",value:P(g).args,"onUpdate:value":e[4]||(e[4]=a=>P(g).args=a),placeholder:P(x).args_holder},null,8,["value","placeholder"])]),_:1},8,["label"])):T("",!0)]),_:1},8,["model"])])}}}),W={class:"p-20px"},A=w({__name:"logs",props:{data:{}},setup(a,{expose:s}){const{t:l}=f(),i=a,{id:o}=i.data,d=y({p:1,rows:10}),{keys:p,table:c,columns:m}=t([{key:"name",title:l("Crontab.arrange.index_5"),render:a=>$("span",{},[_(a.start_time)])},{key:"name",title:l("Crontab.arrange.index_6"),render:a=>{const e=a.end_time-a.start_time;return $("span",{},["".concat(e<1?"<1":e).concat(l("Crontab.Planned.index_45"))])}},{key:"name",title:l("Crontab.Planned.index_23"),render:function(a){return $("span",{},[a.status?$("span",{class:"text-[#20a53a]"},l("Crontab.arrange.index_35")):$("span",{class:"text-[#ef0808]"},l("Crontab.arrange.index_36"))])}},{key:"name",title:l("Crontab.arrange.index_20"),ellipsis:{tooltip:!0},width:"50%",render:function(a){return $("span",{class:"h-60px p-5px"},[a.status?a.result_succ:a.result_err])}}]),{loading:b,setLoading:h}=r(),v=async()=>{try{h(!0);const{message:a}=await x({...d,where_id:o});u(a)&&(c.data=a.data,c.total=g(a.page))}finally{p.value=[],h(!1)}};return v(),s({init:v}),(a,t)=>{const r=n,s=F,l=e;return j(),k("div",W,[U(l,null,{table:L(()=>[U(r,{"max-height":250,loading:P(b),data:P(c).data,columns:P(m)},null,8,["loading","data","columns"])]),pageRight:L(()=>[U(s,{page:P(d).p,"onUpdate:page":t[0]||(t[0]=a=>P(d).p=a),"page-size":P(d).rows,"onUpdate:pageSize":t[1]||(t[1]=a=>P(d).rows=a),"item-count":P(c).total,onRefresh:v},null,8,["page","page-size","item-count"])]),_:1})])}}}),G={class:"p-20px"},J=w({__name:"index",props:{data:{}},setup(o,{expose:d}){const{t:_}=f(),u=o,{id:g}=u.data,{keys:c,table:m,columns:b}=t([{key:"name",title:_("Crontab.arrange.index_15"),ellipsis:{tooltip:{width:"trigger"}},render:a=>{const e={in:_("Crontab.arrange.index_9"),"not in":_("Crontab.arrange.index_10"),"=":_("Crontab.arrange.index_11"),"!=":_("Crontab.arrange.index_12")};return $("span",{},_("Crontab.arrange.index_39",[a.script_info.name,e[a.operator],a.op_value]))}},s({width:130,options:a=>[{label:_("Site.TableOP.index_7"),onClick:()=>{E(a)}},{label:_("Ftp.Table.index_15"),onClick:()=>{R.data.id=a.where_id,R.show=!0}},{label:_("Public.Btn.Del"),onClick:()=>{i({title:_("Crontab.arrange.index_16"),content:_("Crontab.arrange.index_18"),onConfirm:async({hide:e})=>{await h({where_id:a.where_id}),C(),e()}})}}]})]),{loading:x,setLoading:w}=r(),C=async()=>{try{w(!0);const{message:a}=await v({trigger_id:g});p(a)&&(m.data=a)}finally{c.value=[],w(!1)}},y=l(_("Crontab.arrange.index_14"),{getList:C,id:g}),R=l(_("Crontab.arrange.index_17")),T=()=>{y.data.isEdit=!1,y.title=_("Crontab.arrange.index_14"),y.show=!0},E=a=>{y.data.row=a,y.data.isEdit=!0,y.title=_("Crontab.arrange.index_19"),y.show=!0};return C(),d({init:C}),(t,r)=>{const s=B,l=n,i=e,o=a;return j(),k("div",G,[U(i,null,{toolsLeft:L(()=>[U(s,{type:"primary",onClick:T},{default:L(()=>[z(q(t.$t("Crontab.arrange.index_14")),1)]),_:1})]),table:L(()=>[U(l,{loading:P(x),"max-height":200,data:P(m).data,columns:P(b)},null,8,["loading","data","columns"])]),_:1}),U(o,{show:P(y).show,"onUpdate:show":r[0]||(r[0]=a=>P(y).show=a),title:P(y).title,data:P(y).data,width:600,footer:!0,component:O},null,8,["show","title","data"]),U(o,{show:P(R).show,"onUpdate:show":r[1]||(r[1]=a=>P(R).show=a),title:P(R).title,data:P(R).data,width:850,component:A},null,8,["show","title","data"])])}}});export{J as default};
