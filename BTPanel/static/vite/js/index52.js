const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/batch2.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang.js?v=1760428868419","js/vue.js?v=1760428868419","js/__commonjsHelpers__.js?v=1760428868419","js/naive.js?v=1760428868419","js/common.js?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang2.js?v=1760428868419","js/index98.js?v=1760428868419","js/page_layout.js?v=1760428868419","js/public.js?v=1760428868419","css/public.css?v=1760428868419","css/page_layout.css?v=1760428868419","css/index13.css?v=1760428868419","js/index.vue_vue_type_script_setup_true_lang16.js?v=1760428868419","js/mail.js?v=1760428868419"])))=>i.map(i=>d[i]);
import{t as a,i as e,u as l,d as t,p as i,w as s,n,k as o,x as u,a as d,bg as r}from"./page_layout.js?v=1760428868419";import{_ as c}from"./index.js?v=1760428868419";import{_ as p}from"./index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419";import{_ as m}from"./index.vue_vue_type_script_setup_true_lang12.js?v=1760428868419";import{_}from"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";import{b as v,e as x,c as w,I as h,f,a as M,u as b,h as g,i as y}from"./public.js?v=1760428868419";import{_ as k}from"./index.vue_vue_type_script_setup_true_lang8.js?v=1760428868419";import{o as B}from"./upload.js?v=1760428868419";import{q,r as j,c as P,t as U,u as $,v as E,w as C,x as A}from"./mail.js?v=1760428868419";import{a as S}from"./quota.js?v=1760428868419";import{aC as z,dR as R,au as D,dj as V,df as I,dV as L,dS as T}from"./naive.js?v=1760428868419";import{k as W,t as G,R as O,V as F,W as K,a3 as Z,S as H,a4 as N,j as Q,P as J,r as X,e as Y,a2 as aa,an as ea,U as la,am as ta,ab as ia,ak as sa,_ as na}from"./vue.js?v=1760428868419";import{_ as oa}from"./index.vue_vue_type_script_setup_true_lang.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419";const ua={class:"flex justify-center p-32px"},da=i(W({__name:"login",props:{row:{},info:{}},setup(i){const s=G(i,"row"),n=l(),o=async()=>{if(n.isFree)return void v({source:221});const{message:l}=await(i={rc_user:s.value.username,rc_pass:s.value.password},a.post("/plugin?action=a&name=mail_sys&s=login_roundcube_multiple",i,{requestOptions:{loading:e.global.t("Mail.Api.index_36")}}));var i;t(l)&&window.open("".concat(l.result))},u=()=>{s.value.webmail_url&&window.open("".concat(s.value.webmail_url.url))};return(a,e)=>{const l=z;return F(),O("div",ua,[K(l,{onClick:o},{default:Z(()=>[H("span",null,N(a.$t("Database.PhpAdmin.index_11")),1),e[0]||(e[0]=H("span",{class:"bg-recommend"},null,-1))]),_:1,__:[0]}),K(l,{class:"ml-32px",onClick:u},{default:Z(()=>[Q(N(a.$t("Database.PhpAdmin.index_6")),1)]),_:1})])}}}),[["__scopeId","data-v-d0312145"]]),ra={class:"p-20px"},ca={class:"w-280px"},pa={class:"w-100px ml-10px"},ma={class:"w-280px"},_a={class:"w-130px"},va={class:"w-140px ml-10px"},xa={class:"w-280px"},wa=W({__name:"index",props:{row:{},isEdit:{type:Boolean}},emits:["refresh"],setup(a,{expose:e,emit:l}){const t=a,i=l,{isEdit:u}=t,{t:d}=J(),r=X(null),c=Y({full_name:"",domain:null,quota:5,quota_unit:"GB",is_admin:0,username:"",password:"",active:1,quota_limit:1}),p=X([]),m=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],_=[{label:d("Mail.MailBox.index_19"),value:0},{label:d("Mail.MailBox.index_20"),value:1}],v={full_name:{trigger:["blur","input"],validator:()=>""!==c.full_name.trim()||new Error(d("Mail.MailBox.index_21"))},username:{trigger:["blur","input"],validator:()=>!(""===c.username.trim()||!c.domain)||new Error(d("Mail.MailBox.index_22"))},quota:{trigger:["blur","input"],validator:()=>!!c.quota||new Error(d("Mail.MailBox.index_23"))},password:{trigger:["blur","input"],validator:()=>{if(u){if(c.password&&c.password.trim().length<8)return new Error(d("Mail.MailBox.index_26"));const a=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/;if(c.password&&!a.test(c.password))return new Error(d("Mail.MailBox.index_27"))}else{if(c.password.trim().length<8)return new Error(d("Mail.MailBox.index_24"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(c.password))return new Error(d("Mail.MailBox.index_25"))}return!0}}},x=()=>({full_name:c.full_name,quota:c.quota+" "+c.quota_unit,is_admin:c.is_admin,username:c.username+"@"+c.domain,password:c.password,active:c.active,quota_active:c.quota_limit});return(async()=>{const{message:a}=await P();s(a)&&(p.value=a.map(a=>({label:a,value:a})),null===c.domain&&(c.domain=a[0]))})(),(()=>{const{row:a,isEdit:e}=t;if(e&&a){c.full_name=a.full_name,c.is_admin=a.is_admin,c.username=a.username.split("@")[0],c.active=a.active;const[e,l]=a.username.split("@");c.username=e,c.domain=l;const t=n(a.quota),[i,s]=t.split(" ");c.quota=o(i),c.quota_unit=s,c.quota_limit=a.quota_active}})(),e({onConfirm:async()=>{var a;await(null==(a=r.value)?void 0:a.validate()),u?await q(x()):await j(x()),i("refresh")}}),(a,e)=>{const l=D,t=R,i=V,s=I,n=L,o=oa;return F(),O("div",ra,[K(o,{ref_key:"formRef",ref:r,model:la(c),rules:v},{default:Z(()=>[K(t,{label:a.$t("Mail.MailBox.index_10"),path:"full_name"},{default:Z(()=>[H("div",ca,[K(l,{value:la(c).full_name,"onUpdate:value":e[0]||(e[0]=a=>la(c).full_name=a),placeholder:a.$t("Mail.MailBox.index_11")},null,8,["value","placeholder"])])]),_:1},8,["label"]),K(t,{label:"Quota limit"},{default:Z(()=>[K(i,{"checked-value":1,"unchecked-value":0,value:la(c).quota_limit,"onUpdate:value":e[1]||(e[1]=a=>la(c).quota_limit=a)},null,8,["value"])]),_:1}),la(c).quota_limit?(F(),aa(t,{key:0,label:a.$t("Mail.MailBox.index_3"),path:"quota"},{default:Z(()=>[K(s,{value:la(c).quota,"onUpdate:value":e[2]||(e[2]=a=>la(c).quota=a),class:"w-170px",min:0,"show-button":!1,placeholder:a.$t("Mail.MailBox.index_12")},null,8,["value","placeholder"]),H("div",pa,[K(n,{value:la(c).quota_unit,"onUpdate:value":e[3]||(e[3]=a=>la(c).quota_unit=a),options:m},null,8,["value"])])]),_:1},8,["label"])):ea("",!0),K(t,{label:a.$t("Mail.MailBox.index_13"),path:"is_admin"},{default:Z(()=>[H("div",ma,[K(n,{value:la(c).is_admin,"onUpdate:value":e[4]||(e[4]=a=>la(c).is_admin=a),options:_},null,8,["value"])])]),_:1},8,["label"]),K(t,{label:a.$t("Mail.MailBox.index_14"),path:"username"},{default:Z(()=>[H("div",_a,[K(l,{value:la(c).username,"onUpdate:value":e[5]||(e[5]=a=>la(c).username=a),disabled:la(u),placeholder:a.$t("Mail.MailBox.index_15")},null,8,["value","disabled","placeholder"])]),H("div",va,[K(n,{value:la(c).domain,"onUpdate:value":e[6]||(e[6]=a=>la(c).domain=a),disabled:la(u),filterable:!0,options:la(p)},null,8,["value","disabled","options"])])]),_:1},8,["label"]),K(t,{label:a.$t("Mail.MailBox.index_16"),path:"password"},{default:Z(()=>[H("div",xa,[K(l,{value:la(c).password,"onUpdate:value":e[7]||(e[7]=a=>la(c).password=a),placeholder:la(u)?a.$t("Mail.MailBox.index_17"):a.$t("Mail.MailBox.index_18")},null,8,["value","placeholder"])])]),_:1},8,["label"]),la(u)?ea("",!0):(F(),aa(t,{key:1,label:a.$t("Public.Table.Status"),path:"active","show-feedback":!1},{default:Z(()=>[K(i,{value:la(c).active,"onUpdate:value":e[8]||(e[8]=a=>la(c).active=a),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"]))]),_:1},8,["model"])])}}}),ha={class:"w-220px mr-8px"},fa="/www/server/panel/data/mail",Ma=W({__name:"index",setup(a){const e=na(()=>d(()=>import("./batch2.js?v=1760428868419"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]))),{t:i}=J(),o=l(),j=ta(),R=X([]),D=()=>{R.value.unshift({label:i("Public.All"),value:"all"})},I=({option:a})=>"".concat(i("Mail.MailBox.index_29")).concat(a.label),W=()=>{B({path:fa,uploadData:{accept:".json",multiple:!1},onUploadSuccess:async a=>{const e=fa+a[0].fullPath;await E({file:e}),ka()}})},G=async()=>{const{message:a}=await C({domain:O.domain});t(a)&&r(a.result)},O=Y({p:1,size:10,domain:"all",search:""}),oa=x("",{isEdit:!1,row:void 0,onRefresh:()=>{ka()}}),ua=()=>{oa.data.isEdit=!1,oa.data.row=void 0,oa.title=i("Mail.MailBox.index_1"),oa.show=!0},ra=()=>{o.isFree?v({source:327}):Ba.show=!0},{keys:ca,table:pa,columns:ma}=w([{type:"selection",width:40},{key:"username",title:i("Public.Table.Username"),ellipsis:{tooltip:!0}},h({width:160}),{key:"info",title:i("Mail.MailBox.index_2"),width:180,render:a=>K("a",{class:"bt-link",href:"javascript:;",onClick:()=>{xa(a)}},[i("Public.Btn.Copy")])},{key:"quota",title:i("Mail.MailBox.index_3"),render:a=>a.quota_active?"".concat(n(a.current_usage),"/").concat(n(a.quota)):K("img",{src:S},null)},{key:"is_admin",title:i("Mail.MailBox.index_4"),render:a=>1===a.is_admin?"Admin":"General user"},{key:"active",title:i("Public.Table.Status"),render:a=>K(V,{value:a.active,size:"small",checkedValue:1,uncheckedValue:0,onUpdateValue:async e=>{await q({username:a.username,full_name:a.full_name,quota:n(a.quota),active:e,is_admin:a.is_admin,quota_active:a.quota_active}),a.active=e}},null)},f({width:150,options:a=>[{label:"WebMail",onClick:()=>{a.webmail_url?Ma(a):_a()}},{label:i("Public.Btn.Edit"),onClick:()=>{ba(a)}},{label:i("Public.Btn.Del"),onClick:()=>{ga(a)}}]})]),_a=()=>{const{hide:a}=M({title:i("Mail.MailBox.index_5"),content:()=>K(ia,{tag:"div",keypath:"Mail.MailBox.index_6",scope:"global"},{link_1:()=>K("a",{class:"bt-link",href:"javascript:;",onClick:()=>{j.push("/mail/domain"),a()}},[i("Layout.Sider.mail_1"),Q(" > Mail Domain")])}),onConfirm:()=>{j.push("/mail/domain")}})},va=[{key:"delete",type:"confirm",label:i("Site.Batch.index_21"),confirm:{title:i("Site.Batch.index_21"),desc:i("Site.Batch.index_11"),columns:[{...ma.value[1],width:"auto"}],api:a=>U({username:a.username},!1),done:()=>{ka()}}}],xa=a=>{const e=a.webmail_url?a.webmail_url.url:"Not installed WebMail";y("WebMail: ".concat(e,"\nUsername: ").concat(a.username,"\nPassword: ").concat(a.password,"\nPOP service [ Address: ").concat(a.mx," Port: 110/995 ]\nIMAP service [ Address: ").concat(a.mx," Port: 143/993 ]\nSMTP service [ Address: ").concat(a.mx," Port: 25/465/587 ]\n"))},Ma=async a=>{b({title:"WebMail",width:400,data:{row:a,info:ya},component:da})},ba=a=>{oa.data.isEdit=!0,oa.data.row=a,oa.title=i("Mail.MailBox.index_7"),oa.show=!0},ga=async a=>{M({title:i("Mail.MailBox.index_8"),content:i("Mail.MailBox.index_9",[a.username]),onConfirm:async()=>{await U({username:a.username}),ka()}})},ya=Y({id:0,site_name:"",status:!1,ssl_status:!1}),ka=async()=>{try{pa.loading=!0;const{message:a}=await $({p:O.p,size:O.size,search:O.search,..."all"!==O.domain?{domain:O.domain}:{}});t(a)&&(pa.data=s(a.data)?a.data:[],a.page?pa.total=u(a.page):pa.total=a.total)}finally{pa.loading=!1,ca.value=[]}},Ba=x(i("Mail.MailBox.index_31"),{getList:ka}),qa=()=>{O.p=1,ka()};return D(),(async()=>{const{message:a}=await P();s(a)&&(R.value=a.map(a=>({label:a,value:a})),D())})(),(async()=>{try{pa.loading=!0,await(async()=>{const{message:a}=await A();t(a)&&(ya.id=a.id,ya.status=a.status,ya.site_name=a.site_name,ya.ssl_status=a.ssl_status)})(),await ka()}finally{pa.loading=!1}})(),(a,l)=>{const t=z,i=L,s=k,n=g,o=_,u=m,d=p,r=c,v=T;return F(),aa(v,{class:"p-16px"},{default:Z(()=>[K(d,{feedback:!0},{toolsLeft:Z(()=>[K(t,{type:"primary",onClick:ua},{default:Z(()=>[Q(N(a.$t("Mail.MailBox.index_1")),1)]),_:1}),K(t,{onClick:ra},{default:Z(()=>[Q(N(a.$t("Mail.MailBox.index_30")),1)]),_:1}),ea("",!0),K(t,{onClick:W},{default:Z(()=>[Q(N(a.$t("Public.Btn.Import")),1)]),_:1}),K(t,{onClick:G},{default:Z(()=>[Q(N(a.$t("Public.Btn.Export")),1)]),_:1})]),toolsRight:Z(()=>[H("div",ha,[K(i,{value:la(O).domain,"onUpdate:value":[l[0]||(l[0]=a=>la(O).domain=a),qa],options:la(R),"render-tag":I,filterable:!0},null,8,["value","options"])]),K(s,{value:la(O).search,"onUpdate:value":l[1]||(l[1]=a=>la(O).search=a),width:"280",placeholder:a.$t("Mail.MailBox.index_28"),onSearch:qa},null,8,["value","placeholder"])]),table:Z(()=>[K(n,{"row-key":"username","checked-row-keys":la(ca),"onUpdate:checkedRowKeys":l[2]||(l[2]=a=>sa(ca)?ca.value=a:null),loading:la(pa).loading,data:la(pa).data,columns:la(ma)},null,8,["checked-row-keys","loading","data","columns"])]),pageRight:Z(()=>[K(o,{page:la(O).p,"onUpdate:page":l[3]||(l[3]=a=>la(O).p=a),"page-size":la(O).size,"onUpdate:pageSize":l[4]||(l[4]=a=>la(O).size=a),"item-count":la(pa).total,onRefresh:ka},null,8,["page","page-size","item-count"])]),pageLeft:Z(()=>[K(u,{"row-key":"username","checked-row-keys":la(ca),"onUpdate:checkedRowKeys":l[5]||(l[5]=a=>sa(ca)?ca.value=a:null),data:la(pa).data,options:va},null,8,["checked-row-keys","data"])]),_:1}),K(r,{show:la(oa).show,"onUpdate:show":l[6]||(l[6]=a=>la(oa).show=a),title:la(oa).title,data:la(oa).data,width:480,"min-height":236,footer:!0,component:wa},null,8,["show","title","data"]),K(r,{show:la(Ba).show,"onUpdate:show":l[7]||(l[7]=a=>la(Ba).show=a),title:la(Ba).title,data:la(Ba).data,width:480,"min-height":236,footer:!0,component:la(e)},null,8,["show","title","data","component"])]),_:1})}}});export{Ma as default};
