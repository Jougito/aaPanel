import{_ as e}from"./index108.js?v=1760428868419";import{_ as a}from"./index133.js?v=1760428868419";import{_ as l}from"./index.vue_vue_type_script_setup_true_lang.js?v=1760428868419";import{w as t,e as i,g as r,_ as n,o,d as s,m as d}from"./page_layout.js?v=1760428868419";import{k as u,a0 as p,ae as _,r as m,a2 as c,V as v,U as b,n as f,w as h,c as x,P as g,e as w,a3 as k,W as y,l as S,j,a4 as P,ak as $,v as L,S as E,an as U,R}from"./vue.js?v=1760428868419";import{u as W,g as A,a as q,c as C,b as V,d as B}from"./index87.js?v=1760428868419";import{d as D,m as H,_ as z}from"./public.js?v=1760428868419";import{D as F}from"./domain-input.js?v=1760428868419";import{g as M}from"./site.js?v=1760428868419";import{dV as I,dR as N,dT as T,dU as J,au as O,da as Q,d8 as Y,_ as Z,dj as G,dZ as K,aC as X,av as ee,dY as ae}from"./naive.js?v=1760428868419";import{_ as le}from"./index.vue_vue_type_script_setup_true_lang17.js?v=1760428868419";import{_ as te}from"./index.vue_vue_type_script_setup_true_lang10.js?v=1760428868419";import{o as ie}from"./upload.js?v=1760428868419";import{_ as re}from"./task-view.vue_vue_type_script_setup_true_lang.js?v=1760428868419";import"./common.js?v=1760428868419";import"./__commonjsHelpers__.js?v=1760428868419";import"./index.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang5.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang6.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang7.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang12.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang8.js?v=1760428868419";import"./index131.js?v=1760428868419";import"./php.js?v=1760428868419";import"./soft.js?v=1760428868419";import"./site4.js?v=1760428868419";import"./index.vue_vue_type_script_setup_true_lang15.js?v=1760428868419";import"./index245.js?v=1760428868419";import"./index99.js?v=1760428868419";import"./index100.js?v=1760428868419";import"./index101.js?v=1760428868419";import"./file.js?v=1760428868419";import"./theme-monokai.js?v=1760428868419";import"./refersh.js?v=1760428868419";import"./index105.js?v=1760428868419";import"./ssl.js?v=1760428868419";import"./cert.js?v=1760428868419";import"./ssl-lets-progress.js?v=1760428868419";import"./utils3.js?v=1760428868419";import"./index218.js?v=1760428868419";import"./paypal-js.js?v=1760428868419";import"./index98.js?v=1760428868419";const ne=u({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=W(),{phpVersion:l}=p(a),i=_(e,"value"),{loading:r,setLoading:n}=D(),o=m([]),s=e=>{l.value=e};return(async()=>{try{n(!0);const{message:e}=await M(),a=t(e)?e:[];o.value=a.filter(e=>"00"!==e.version).map(e=>({label:e.name,value:e.version})),await f(),a.length>0&&(i.value="00"==a[0].version?"":a[0].version,l.value="00"==a[0].version?"":a[0].version)}finally{n(!1)}})(),(e,a)=>{const l=I;return v(),c(l,{value:i.value,"onUpdate:value":[a[0]||(a[0]=e=>i.value=e),s],loading:b(r),options:b(o)},null,8,["value","loading","options"])}}}),oe=u({__name:"index",props:{value:{},valueModifiers:{}},emits:["update:value"],setup(e){const a=W();h(()=>a.phpVersion,e=>{s(e)});const l=x(()=>a.phpVersion?"Not supported by current PHP":"Please select PHP version"),i=_(e,"value"),{loading:r,setLoading:n}=D(),o=m([]),s=async e=>{try{n(!0),i.value="";const{message:a}=await A({php_version_short:e});t(a)&&(o.value=a.map(e=>({label:e.version,value:e.version})),await f(),a.length>0&&(i.value=a[0].version))}finally{n(!1)}};return a.phpVersion&&s(a.phpVersion),(e,a)=>{const t=I;return v(),c(t,{value:i.value,"onUpdate:value":a[0]||(a[0]=e=>i.value=e),loading:b(r),options:b(o),placeholder:b(l)},null,8,["value","loading","options","placeholder"])}}}),se={key:1},de={class:"w-400px"},ue={class:"w-400px"},pe={class:"w-230px"},_e={class:"w-230px"},me={class:"w-400px"},ce={class:"w-230px mr-16px"},ve={class:"w-400px"},be={class:"w-400px"},fe=u({__name:"index",props:{getList:{type:Function}},setup(e,{expose:t}){const u=e,{t:_}=g(),f=W(),{web:h,mysql:x,php:A}=p(f),C=m(null),V=m(null),B=m([]),D=w({type:0,domain_auto:[""],domain:"",weblog_title:"",language:"en",php_version:null,wp_version:null,user_name:r(6),admin_password:i(16,"wp"),pw_weak:!1,admin_email:"",Login_url:"wp-admin",redirection_url:"404",prefix:"wp_"+r(6)+"_",enable_cache:!1,wps:!1,is_create_default_file:!0}),z={domain:{required:!0,trigger:["blur","input"],validator:()=>0!==D.type||""!==D.domain.trim()||new Error(_("Site.RulesError.index_31"))},domain_auto:{trigger:["blur"],validator:(e,a)=>!(1===D.type&&!a[0])||new Error(_("Site.PHP.add_site_23"))},weblog_title:{required:!0,trigger:["blur","input"],validator:()=>""!==D.weblog_title.trim()||new Error(_("Site.RulesError.index_3"))},language:{trigger:"change",validator:()=>null!==D.language||new Error(_("Site.RulesError.index_4"))},php_version:{trigger:"change",validator:()=>null!==D.php_version||new Error(_("Site.RulesError.index_5"))},wp_version:{trigger:"change",validator:()=>null!==D.php_version||new Error(_("Site.RulesError.index_6"))},user_name:{required:!0,trigger:["blur","input"],validator:()=>""!==D.user_name.trim()||new Error(_("Site.RulesError.index_7"))},admin_password:{required:!0,trigger:["blur","input"],validator:()=>""!==D.admin_password.trim()||new Error(_("Site.RulesError.index_8"))},admin_email:{required:!0,trigger:["blur","input"],validator:()=>""!==D.admin_email.trim()||new Error(_("Site.RulesError.index_9"))},redirection_url:{required:!0,trigger:["blur","input"],validator:()=>""!==D.redirection_url.trim()||new Error(_("Site.RulesError.index_12"))},Login_url:{required:!0,trigger:["blur","input"],validator:()=>""!==D.Login_url.trim()||new Error(_("Site.RulesError.index_11"))},prefix:{required:!0,trigger:["blur","input"],validator:()=>""!==D.prefix.trim()||new Error(_("Site.RulesError.index_10"))}},M=e=>{var a;if(null==(a=C.value)||a.restoreValidation(),!e)return void(D.domain=D.domain_auto[0]);const l=D.domain.trim();l!==D.domain_auto[0]&&(D.domain_auto=l?[l]:[""],D.domain_auto.forEach((e,a)=>{var l;return null==(l=V.value)?void 0:l.onDomainItemBlur(e,a)}))};return t({onConfirm:async()=>{var e;await new Promise((e,a)=>{0===B.value.filter(e=>e.support.includes("auto")).length&&1===D.type?(d.error("This domain does not support automatic resolution, please choose manual resolution"),a(!1)):e(!0)}),await(null==(e=C.value)?void 0:e.validate());const{message:a}=await q((()=>{const{domain:e,php_version:a}=D,l=e.replace(new RegExp(/([-.])/g),"_");if(null===a)throw d.error(_("Site.RulesError.index_5")),new Error(_("Site.RulesError.index_5"));const t=B.value.map(e=>({domain:e.domain,hash:e.hash,support:[...e.auto?["auto"]:[],...e.ssl_cert?["ssl_cert"]:[],...e.cf_proxy?["cf_proxy"]:[]]}));return{webname:{domain:e,domainlist:[],count:0},type:"PHP",port:80,type_id:0,ftp:!1,sql:"MySQL",codeing:"utf8",set_ssl:0,force_ssl:0,project_type:"WP",path:f.sitePath+"/"+(0===D.type?e:D.domain_auto[0]),ps:l,version:a,datauser:"sql_"+l,datapassword:r(16),password:D.admin_password,pw_weak:D.pw_weak?"on":"off",email:D.admin_email,weblog_title:D.weblog_title,language:D.language,user_name:D.user_name,prefix:D.prefix,enable_cache:D.enable_cache?1:0,enable_whl:0,whl_page:D.Login_url?D.Login_url:null,whl_redirect_admin:D.redirection_url?D.redirection_url:null,package_version:D.wp_version,wp_parse_list:1===D.type&&t.length?JSON.stringify(t):null,is_create_default_file:D.is_create_default_file}})());s(a)&&u.getList()}}),(e,t)=>{const i=o,r=J,s=T,d=n,u=N,p=O,_=Y,m=Q,f=Z,g=G,w=l,W=a;return v(),c(W,{install:b(x).setup&&b(A).setup},{desc:k(()=>[E("span",null,P(e.$t("WP.index_6")),1),b(A).setup?U("",!0):(v(),c(i,{key:0,class:"ml-4px",onClick:t[0]||(t[0]=e=>b(H)("php-8.0"))},{default:k(()=>[j(P(e.$t("WP.index_7")),1)]),_:1})),b(x).setup?U("",!0):(v(),R("span",se,[t[17]||(t[17]=E("span",{class:"mx-4px"},"|",-1)),y(i,{onClick:t[1]||(t[1]=e=>b(H)("mysql"))},{default:k(()=>[j(P(e.$t("WP.index_8")),1)]),_:1})]))]),default:k(()=>[y(w,{ref_key:"formRef",ref:C,model:b(D),rules:z},{default:k(()=>[y(u,{label:e.$t("SSL.index_1")},{default:k(()=>[y(s,{value:b(D).type,"onUpdate:value":[t[2]||(t[2]=e=>b(D).type=e),M]},{default:k(()=>[y(r,{value:0},{default:k(()=>[j(P(e.$t("SSL.index_2")),1)]),_:1}),y(r,{value:1},{default:k(()=>[j(P(e.$t("SSL.index_3")),1)]),_:1})]),_:1},8,["value"]),y(d,{name:"ssl-stars",size:22})]),_:1},8,["label"]),S(y(u,{label:e.$t("Site.Lable.index_1"),path:"domain_auto"},{default:k(()=>[y(F,{ref_key:"domainInputRef",ref:V,value:b(D).domain_auto,"onUpdate:value":t[3]||(t[3]=e=>b(D).domain_auto=e),"parse-list":b(B),"onUpdate:parseList":t[4]||(t[4]=e=>$(B)?B.value=e:null),is_wp:""},null,8,["value","parse-list"])]),_:1},8,["label"]),[[L,1===b(D).type]]),S(y(u,{label:e.$t("Site.Lable.index_1"),path:"domain"},{default:k(()=>[E("div",de,[y(p,{value:b(D).domain,"onUpdate:value":t[5]||(t[5]=e=>b(D).domain=e),placeholder:e.$t("Site.Placeholder.index_12")},null,8,["value","placeholder"])])]),_:1},8,["label"]),[[L,0===b(D).type]]),y(u,{label:e.$t("Site.Lable.index_20"),path:"weblog_title"},{default:k(()=>[E("div",ue,[y(p,{value:b(D).weblog_title,"onUpdate:value":t[6]||(t[6]=e=>b(D).weblog_title=e),placeholder:e.$t("Site.Placeholder.index_13")},null,8,["value","placeholder"])])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_21"),path:"language"},{default:k(()=>[E("div",pe,[y(le,{value:b(D).language,"onUpdate:value":t[7]||(t[7]=e=>b(D).language=e)},null,8,["value"])])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_22"),path:"php_version"},{default:k(()=>[E("div",_e,[y(ne,{value:b(D).php_version,"onUpdate:value":t[8]||(t[8]=e=>b(D).php_version=e)},null,8,["value"])])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_23"),path:"wp_version"},{default:k(()=>[y(m,{class:"items-center",size:8},{default:k(()=>[y(oe,{value:b(D).wp_version,"onUpdate:value":t[9]||(t[9]=e=>b(D).wp_version=e),class:"w-230px"},null,8,["value"]),y(_,{trigger:"hover"},{trigger:k(()=>[y(d,{name:"common-ask",size:"18",color:"#999"})]),default:k(()=>[j(" "+P(e.$t("WP.Add.index_8")),1)]),_:1})]),_:1})]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_24"),path:"user_name"},{default:k(()=>[E("div",me,[y(p,{value:b(D).user_name,"onUpdate:value":t[10]||(t[10]=e=>b(D).user_name=e),placeholder:e.$t("Site.Placeholder.index_14")},null,8,["value","placeholder"])])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_27"),path:"admin_password"},{default:k(()=>[E("div",ce,[y(p,{value:b(D).admin_password,"onUpdate:value":t[11]||(t[11]=e=>b(D).admin_password=e),placeholder:e.$t("Site.Placeholder.index_15")},null,8,["value","placeholder"])]),y(f,{checked:b(D).pw_weak,"onUpdate:checked":t[12]||(t[12]=e=>b(D).pw_weak=e)},{default:k(()=>[E("span",null,P(e.$t("WP.Add.index_9")),1)]),_:1},8,["checked"])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_28"),path:"admin_email"},{default:k(()=>[E("div",ve,[y(p,{value:b(D).admin_email,"onUpdate:value":t[13]||(t[13]=e=>b(D).admin_email=e),placeholder:e.$t("Site.Placeholder.index_16")},null,8,["value","placeholder"])])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_29"),path:"prefix"},{default:k(()=>[E("div",be,[y(p,{value:b(D).prefix,"onUpdate:value":t[14]||(t[14]=e=>b(D).prefix=e),placeholder:e.$t("Site.Placeholder.index_17")},null,8,["value","placeholder"])])]),_:1},8,["label"]),y(u,{label:e.$t("Site.Lable.index_31"),"show-feedback":!1},{default:k(()=>[y(f,{checked:b(D).enable_cache,"onUpdate:checked":t[15]||(t[15]=e=>b(D).enable_cache=e),disabled:"nginx"!==b(h).type},{default:k(()=>[E("span",null,P(e.$t("WP.Add.index_10")),1)]),_:1},8,["checked","disabled"])]),_:1},8,["label"]),y(u,{label:e.$t("SSL.SiteSSL.index_18")},{default:k(()=>[y(g,{value:b(D).is_create_default_file,"onUpdate:value":t[16]||(t[16]=e=>b(D).is_create_default_file=e)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["install"])}}}),he={key:1},xe={class:"w-302px ml-12px"},ge={class:"w-302px ml-12px"},we={class:"w-400px"},ke={class:"w-230px"},ye=u({__name:"index",props:{getList:{type:Function}},setup(e,{expose:t}){const{t:i}=g(),r=W(),{web:n,mysql:s,php:d}=p(r),u=e,_=m(null),f=m(null),h=m(null),S=w({method:1,bak_file:"",domain:"",sub_path:"",php_version:null,enable_cache:!1,db_bak_file:""}),L={bak_file:{trigger:["blur","input"],validator:()=>""!==S.bak_file.trim()||new Error(i("WP.Add.import_6"))},domain:{trigger:["blur","input"],validator:()=>""!==S.domain.trim()||new Error(i("Site.RulesError.index_31"))},php_version:{trigger:"change",validator:()=>null!==S.php_version||new Error(i("Site.RulesError.index_5"))},db_bak_file:{trigger:["blur","input"],validator:()=>""!==S.db_bak_file.trim()||new Error(i("WP.Add.import_6"))}},A=x(()=>S.domain?"/".concat(S.domain,"/"):"/"),q=e=>{const a="/www/server/panel/temp";ie({path:a,uploadData:{multiple:!1},onUploadSuccess:l=>{"wp"===e?(S.bak_file="".concat(a,"/").concat(l[0].name),D()):"db"===e&&(S.db_bak_file="".concat(a,"/").concat(l[0].name),F())}})},D=()=>{var e;null==(e=f.value)||e.restoreValidation()},F=()=>{var e;null==(e=h.value)||e.restoreValidation()};return t({onConfirm:async()=>{var e;await(null==(e=_.value)?void 0:e.validate());const a=3===S.method?{db_bak_file:S.db_bak_file,bak_file:S.bak_file,domain:S.domain,sub_path:S.sub_path,php_ver_short:S.php_version||"",enable_cache:S.enable_cache?1:0}:{bak_file:S.bak_file,domain:S.domain,sub_path:S.sub_path,php_ver_short:S.php_version||"",enable_cache:S.enable_cache?1:0};1===S.method?await C(a):2===S.method?await V(a):3===S.method&&await B(a),u.getList()}}),(e,t)=>{const i=o,u=K,p=T,m=N,x=X,g=te,w=O,W=ae,C=ee,V=Z,B=l,M=z,I=a;return v(),c(I,{install:b(s).setup&&b(d).setup},{desc:k(()=>[E("span",null,P(e.$t("WP.index_6")),1),b(d).setup?U("",!0):(v(),c(i,{key:0,class:"ml-4px",onClick:t[0]||(t[0]=e=>b(H)("php-8.0"))},{default:k(()=>[j(P(e.$t("WP.index_7")),1)]),_:1})),b(s).setup?U("",!0):(v(),R("span",he,[t[12]||(t[12]=E("span",{class:"mx-4px"},"|",-1)),y(i,{onClick:t[1]||(t[1]=e=>b(H)("mysql"))},{default:k(()=>[j(P(e.$t("WP.index_8")),1)]),_:1})]))]),default:k(()=>[y(B,{ref_key:"formRef",ref:_,modelValue:b(S),"onUpdate:modelValue":t[11]||(t[11]=e=>$(S)?S.value=e:null),rules:L},{default:k(()=>[y(m,{label:e.$t("WP.Add.import_1")},{default:k(()=>[y(p,{value:b(S).method,"onUpdate:value":t[2]||(t[2]=e=>b(S).method=e)},{default:k(()=>[y(u,{label:e.$t("WP.Add.import_2"),value:1},null,8,["label"]),y(u,{label:e.$t("WP.Add.import_3"),value:2},null,8,["label"]),y(u,{label:"Manual Backup",value:3})]),_:1},8,["value"])]),_:1},8,["label"]),y(m,{ref_key:"bakFileRef",ref:f,label:"WP backup file",path:"bak_file"},{default:k(()=>[y(x,{onClick:t[3]||(t[3]=e=>q("wp"))},{default:k(()=>[j(P(e.$t("Docker.App.Backup.index_3")),1)]),_:1}),E("div",xe,[y(g,{value:b(S).bak_file,"onUpdate:value":t[4]||(t[4]=e=>b(S).bak_file=e),"default-path":"/www/backup/wordpress","checked-type":["file"],onChange:D},null,8,["value"])])]),_:1},512),3===b(S).method?(v(),c(m,{key:0,ref_key:"dbBakFileRef",ref:h,label:"DB backup file",path:"db_bak_file"},{default:k(()=>[y(x,{onClick:t[5]||(t[5]=e=>q("db"))},{default:k(()=>[j(P(e.$t("Docker.App.Backup.index_3")),1)]),_:1}),E("div",ge,[y(g,{value:b(S).db_bak_file,"onUpdate:value":t[6]||(t[6]=e=>b(S).db_bak_file=e),"default-path":"/www/backup/wordpress","checked-type":["file"],onChange:F},null,8,["value"])])]),_:1},512)):U("",!0),y(m,{label:e.$t("Site.Lable.index_1"),path:"domain"},{default:k(()=>[E("div",we,[y(w,{value:b(S).domain,"onUpdate:value":t[7]||(t[7]=e=>b(S).domain=e),placeholder:e.$t("Site.Placeholder.index_12")},null,8,["value","placeholder"])])]),_:1},8,["label"]),y(m,{label:e.$t("Site.PHP.add_site_9"),path:"path"},{default:k(()=>[y(C,{class:"w-400px"},{default:k(()=>[y(W,null,{default:k(()=>[j(P(b(r).sitePath)+P(b(A)),1)]),_:1}),y(w,{value:b(S).sub_path,"onUpdate:value":t[8]||(t[8]=e=>b(S).sub_path=e),placeholder:e.$t("WP.Add.import_5")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["label"]),y(m,{label:e.$t("Site.Lable.index_22"),path:"php_version"},{default:k(()=>[E("div",ke,[y(ne,{value:b(S).php_version,"onUpdate:value":t[9]||(t[9]=e=>b(S).php_version=e)},null,8,["value"])])]),_:1},8,["label"]),y(m,{label:e.$t("Site.Lable.index_31"),"show-feedback":!1},{default:k(()=>[y(V,{checked:b(S).enable_cache,"onUpdate:checked":t[10]||(t[10]=e=>b(S).enable_cache=e),disabled:"nginx"!==b(n).type},{default:k(()=>[j(P(e.$t("WP.Add.index_10")),1)]),_:1},8,["checked","disabled"])]),_:1},8,["label"])]),_:1},8,["modelValue"]),3===b(S).method?(v(),c(M,{key:0},{default:k(()=>t[13]||(t[13]=[E("li",null," Manual backup deployment relies on the wp-config.php file, please ensure that it exists and is configured correctly. ",-1)])),_:1,__:[13]})):U("",!0)]),_:1},8,["install"])}}}),Se={class:"p-20px h-full"},je=u({__name:"index",props:{done:{type:Function}},setup(a,{expose:l}){const{t:t}=g(),i=a,r=m("single"),n=m(),o=[{key:"single",label:t("WP.Add.index_1"),isLazy:!0,component:fe,data:{getList:i.done}},{key:"import",label:t("WP.Add.index_2"),isLazy:!0,component:ye,data:{getList:i.done}}];return l({onConfirm:async()=>{var e;await(null==(e=n.value)?void 0:e.onConfirm())}}),(a,l)=>{const t=e;return v(),c(re,{title:a.$t("WP.Add.index_7"),params:"backup_deploy"},{default:k(()=>[E("div",Se,[y(t,{ref_key:"tabsRef",ref:n,value:b(r),"onUpdate:value":l[0]||(l[0]=e=>$(r)?r.value=e:null),options:o},null,8,["value"])])]),_:1},8,["title"])}}});export{je as default};
